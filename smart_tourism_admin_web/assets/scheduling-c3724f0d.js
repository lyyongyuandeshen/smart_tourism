import{b6 as he,d as Se,a2 as ze,n as C,r as u,a4 as ve,o as d,Q as ke,ab as v,R as n,b as o,ac as z,a5 as A,a as s,c,aa as M,N as Z,aS as pe,ah as I,a1 as De,X as $,ad as Ge,b7 as Ce,$ as Je,b8 as ce,a6 as h,ai as ue,a8 as Ze,b9 as et,w as R}from"./index-5805bd08.js";import{N as tt}from"./Space-a5c105a8.js";import{N as at}from"./Form-9e4f5768.js";import{N as J}from"./DatePicker-8deac17c.js";import{N as be}from"./DataTable-f0affd58.js";import{N as xe}from"./Pagination-78bedb34.js";import"./Forward-dbe0c59b.js";function st(){return he({url:"/v1/schedules/employees",method:"get"})}function lt(){return he({url:"/v1/schedules/shifts",method:"get"})}function nt(ee){return he({url:"/v1/schedules/calendar",method:"get",params:ee})}const ot={class:"form-table"},it={class:"form-table-cell"},rt={class:"form-table-cell"},dt={class:"form-table-cell"},ct={class:"form-table-cell"},ut={class:"form-table-cell",style:{width:"60px"}},vt={class:"add-row-btn"},pt=Se({__name:"ScheduleModal",props:{show:{type:Boolean},schedule:{default:null}},emits:["update:show","save"],setup(ee,{emit:D}){const K=ee,P=D,q=ze(),H=C({get:()=>K.show,set:p=>P("update:show",p)}),m=u([{shiftName:"班次1",workContent:"",shiftTime:"",personnel:["人员1"]},{shiftName:"班次2",workContent:"",shiftTime:"",personnel:["人员1"]},{shiftName:"班次3",workContent:"",shiftTime:"",personnel:["人员1"]}]),b=u([{label:"人员1",value:"人员1"},{label:"人员2",value:"人员2"},{label:"人员3",value:"人员3"},{label:"人员4",value:"人员4"},{label:"人员5",value:"人员5"}]),oe=()=>{m.value.push({shiftName:`班次${m.value.length+1}`,workContent:"",shiftTime:"",personnel:[]})},Y=p=>{m.value.length>1?m.value.splice(p,1):q.warning("至少保留一行")},j=(p,r)=>{m.value[r].personnel=p},V=p=>{if(!p)return null;const r=new Date(p);return isNaN(r.getTime())?null:r.getTime()},Q=(p,r)=>{if(p){const g=new Date(p),F=g.getFullYear(),x=String(g.getMonth()+1).padStart(2,"0"),W=String(g.getDate()).padStart(2,"0"),G=String(g.getHours()).padStart(2,"0"),ie=String(g.getMinutes()).padStart(2,"0");m.value[r].shiftTime=`${F}-${x}-${W} ${G}:${ie}`}else m.value[r].shiftTime=""},X=()=>{for(let p=0;p<m.value.length;p++){const r=m.value[p];if(!r.shiftName||!r.workContent||!r.shiftTime){q.warning(`请完善第${p+1}行的信息`);return}}P("save",{shifts:m.value}),P("update:show",!1)},O=()=>{P("update:show",!1)};return ve(()=>K.show,p=>{p&&(K.schedule||(m.value=[{shiftName:"班次1",workContent:"",shiftTime:"",personnel:["人员1"]},{shiftName:"班次2",workContent:"",shiftTime:"",personnel:["人员1"]},{shiftName:"班次3",workContent:"",shiftTime:"",personnel:["人员1"]}]))}),(p,r)=>(d(),ke(n(Ge),{show:H.value,"onUpdate:show":r[0]||(r[0]=g=>H.value=g),preset:"card",title:"新增/编辑排班",class:"schedule-modal",style:{width:"900px","max-width":"90vw"},onClose:O},{footer:v(()=>[o(n(tt),{justify:"end"},{default:v(()=>[o(n(z),{onClick:O},{default:v(()=>[...r[3]||(r[3]=[A("取消",-1)])]),_:1}),o(n(z),{type:"primary",onClick:X},{default:v(()=>[...r[4]||(r[4]=[A("提交",-1)])]),_:1})]),_:1})]),default:v(()=>[o(n(at),{"label-placement":"left","label-width":"100px"},{default:v(()=>[s("div",ot,[r[1]||(r[1]=s("div",{class:"form-table-header"},[s("div",{class:"form-table-cell"},"班次名称"),s("div",{class:"form-table-cell"},"工作内容"),s("div",{class:"form-table-cell"},"班次时间"),s("div",{class:"form-table-cell"},"相关人员"),s("div",{class:"form-table-cell",style:{width:"60px"}},"操作")],-1)),(d(!0),c($,null,M(m.value,(g,F)=>(d(),c("div",{key:F,class:"form-table-row"},[s("div",it,[o(n(Z),{value:g.shiftName,"onUpdate:value":x=>g.shiftName=x,placeholder:"班次名称",size:"small"},null,8,["value","onUpdate:value"])]),s("div",rt,[o(n(Z),{value:g.workContent,"onUpdate:value":x=>g.workContent=x,placeholder:"工作内容",size:"small"},null,8,["value","onUpdate:value"])]),s("div",dt,[o(n(J),{value:V(g.shiftTime),type:"datetime",placeholder:"选择日期时间",size:"small",style:{width:"100%"},"onUpdate:value":x=>Q(x,F)},null,8,["value","onUpdate:value"])]),s("div",ct,[o(n(pe),{value:g.personnel,"onUpdate:value":[x=>g.personnel=x,x=>j(x,F)],multiple:"",tag:"",placeholder:"选择人员",options:b.value,size:"small"},null,8,["value","onUpdate:value","options"])]),s("div",ut,[m.value.length>1?(d(),ke(n(z),{key:0,quaternary:"",type:"error",size:"small",onClick:x=>Y(F)},{icon:v(()=>[o(n(I),{icon:"ri:close-line"})]),_:1},8,["onClick"])):De("",!0)])]))),128))]),s("div",vt,[o(n(z),{dashed:"",onClick:oe},{icon:v(()=>[o(n(I),{icon:"ri:add-line"})]),default:v(()=>[r[2]||(r[2]=A(" 添加一行 ",-1))]),_:1})])]),_:1})]),_:1},8,["show"]))}});const ht=Ce(pt,[["__scopeId","data-v-b3b48295"]]),ft={class:"scheduling-container"},gt={key:0,class:"statistics-content"},mt={class:"statistics-header"},yt={class:"metrics-row"},_t={class:"metric-label"},wt={class:"metric-value"},kt={class:"value-number"},bt={key:0,class:"value-unit"},xt={class:"trend-indicator"},St={class:"charts-grid"},zt={class:"chart-card"},Dt={class:"chart-container"},Ct={class:"line-chart",viewBox:"0 0 600 300",preserveAspectRatio:"xMidYMid meet"},Mt=["y"],$t=["x"],Nt=["points"],Tt=["points"],Ut={transform:"translate(450, 30)"},At={x:"10",y:"4",fill:"#333","font-size":"12"},Pt={x:"10",y:"24",fill:"#333","font-size":"12"},Ft={class:"chart-card"},Lt={class:"chart-container"},Bt={class:"line-chart",viewBox:"0 0 600 300",preserveAspectRatio:"xMidYMid meet"},Rt=["y"],It=["x"],Yt=["points"],jt=["points"],Vt={transform:"translate(450, 30)"},Et={x:"10",y:"4",fill:"#333","font-size":"12"},Kt={x:"10",y:"24",fill:"#333","font-size":"12"},Ot={class:"chart-card"},Wt={class:"chart-container donut-chart"},qt={viewBox:"0 0 200 200",class:"donut-svg"},Ht={transform:"translate(100, 100)"},Qt={x:"0",y:"15","text-anchor":"middle",fill:"#1890ff","font-size":"18","font-weight":"600"},Xt={class:"donut-legend"},Gt={class:"legend-text"},Jt={class:"chart-card"},Zt={class:"word-cloud"},ea={key:1,class:"schedule-content"},ta={class:"action-bar"},aa={class:"action-left"},sa={class:"date-range"},la={class:"action-right"},na={class:"calendar-nav"},oa={class:"current-month"},ia={class:"calendar-wrapper"},ra={class:"custom-calendar"},da={class:"calendar-weekdays"},ca={class:"calendar-grid"},ua={class:"day-number"},va={class:"schedule-items"},pa={class:"attendance-content"},ha={class:"attendance-filters"},fa={class:"attendance-table"},ga={class:"attendance-pagination"},ma={class:"pagination-info"},ya={class:"personnel-content"},_a={class:"personnel-filters"},wa={class:"personnel-table"},ka={class:"personnel-pagination"},ba={class:"pagination-info"},xa=Se({__name:"scheduling",setup(ee){const D=ze(),K=u("schedule"),P=u(!1),q=u(""),H=u(null),m=u(null),b=u(new Date),oe=[{label:"全部",value:""},{label:"正常",value:"正常"},{label:"缺勤",value:"缺勤"},{label:"早退",value:"早退"},{label:"迟到",value:"迟到"}],Y=u(""),j=u(""),V=u(null),Q=u(""),X=u(""),O=u(null),p=[{label:"全部",value:""},{label:"在岗",value:"在岗"},{label:"休息",value:"休息"}],r=u([]),g=u(!1),F=e=>({id:String(e.shift_id),shiftName:e.shift_name||"-",personnel:e.position_name||"未分配岗位",status:"正常",recordTime:e.created_at?new Date(e.created_at).toLocaleString("zh-CN"):"-"}),x=async()=>{try{g.value=!0;const e=await lt();console.log("班次列表返回:",e),e!=null&&e.success&&Array.isArray(e.data)?(r.value=e.data.map(F),w.value.itemCount=r.value.length):(D.error((e==null?void 0:e.message)||"获取班次列表失败"),r.value=[],w.value.itemCount=0)}catch(e){console.error("获取班次列表失败:",e),D.error((e==null?void 0:e.message)||"获取班次列表失败"),r.value=[],w.value.itemCount=0}finally{g.value=!1}},W=u([]),G=u(!1),ie=e=>({id:String(e.employee_id??""),name:e.name??"-",employeeCode:e.employee_code??"-",phone:e.phone??"-",createdAt:e.created_at?e.created_at.replace("T"," "):"-",workStatus:"在岗"}),Me=async()=>{try{G.value=!0;const e=await st();e!=null&&e.success&&Array.isArray(e.data)?(W.value=e.data.map(ie),k.value.itemCount=W.value.length):D.error((e==null?void 0:e.message)||"获取人员列表失败")}catch(e){D.error((e==null?void 0:e.message)||"获取人员列表失败")}finally{G.value=!1}},w=u({page:1,pageSize:10,itemCount:0,showSizePicker:!0,pageSizes:[10,20,30,50],onChange:e=>{w.value.page=e},onUpdatePageSize:e=>{w.value.pageSize=e,w.value.page=1}}),k=u({page:1,pageSize:10,itemCount:0,showSizePicker:!0,pageSizes:[10,20,30,50],onChange:e=>{k.value.page=e},onUpdatePageSize:e=>{k.value.pageSize=e,k.value.page=1}}),$e={正常:"#52c41a",缺勤:"#ff4d4f",早退:"#fa8c16",迟到:"#fa8c16"},Ne=e=>{D.info(`处理 ${e.personnel} 的考勤记录`)},Te=e=>{D.info(`调整 ${e.name} 的排班`)},Ue=[{title:"班次名称",key:"shiftName",width:150},{title:"相关人员",key:"personnel",width:150},{title:"考勤状态",key:"status",width:150,render:e=>{const t=$e[e.status]||"#666";return R("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},[R("span",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:t,display:"inline-block"}}),R("span",e.status)])}},{title:"记录时间",key:"recordTime",width:200},{title:"操作",key:"actions",width:120,render:e=>R(z,{type:"primary",size:"small",onClick:()=>Ne(e)},{default:()=>"处理"})}],Ae=[{title:"姓名",key:"name",width:160},{title:"员工编码",key:"employeeCode",width:180},{title:"电话",key:"phone",width:160},{title:"今天工作状态",key:"workStatus",width:160,render:e=>{const t=e.workStatus==="在岗"?"#52c41a":"#ff4d4f";return R("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},[R("span",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:t,display:"inline-block"}}),R("span",e.workStatus)])}},{title:"创建时间",key:"createdAt",width:200},{title:"操作",key:"actions",width:140,render:e=>R(z,{type:"primary",size:"small",tertiary:!0,onClick:()=>Te(e)},{default:()=>"排班调整"})}],L=u([]),fe=u(!1),te=u(!1),ge=u(null),ae={岗位1:"#1890ff",岗位2:"#ff4d4f",岗位3:"#52c41a",岗位4:"#722ed1",岗位5:"#fa8c16"},me=["#1890ff","#ff4d4f","#52c41a","#722ed1","#fa8c16","#13c2c2","#eb2f96","#fa541c"];let ye=0;const Pe=e=>(ae[e]||(ae[e]=me[ye%me.length],ye+=1),ae[e]),se=e=>L.value.find(t=>t.date===e),N=e=>{const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return`${t}-${a}-${l}`},Fe=()=>{const e=new Date(b.value);e.setMonth(e.getMonth()-1),b.value=e},Le=()=>{const e=new Date(b.value);e.setMonth(e.getMonth()+1),b.value=e},Be=()=>{b.value=new Date},Re=()=>{ge.value=null,te.value=!0},Ie=()=>{D.info("导入排班功能")},Ye=()=>{P.value=!0},je=()=>{P.value=!1},_e=async()=>{try{fe.value=!0;const e=b.value.getFullYear(),t=b.value.getMonth(),a=N(new Date(e,t,1)),l=N(new Date(e,t+1,0)),i=await nt({start_date:a,end_date:l});i!=null&&i.success&&Array.isArray(i.data)?L.value=i.data.map(S=>({date:S.schedule_date,positions:S.schedules.map(y=>y.position_name||y.shift_name||"班次"),colors:S.schedules.map(y=>Pe(y.position_name||y.shift_name||"班次"))})):(D.error((i==null?void 0:i.message)||"获取排班日历失败"),L.value=[])}catch(e){console.error("获取排班日历失败:",e),D.error((e==null?void 0:e.message)||"获取排班日历失败"),L.value=[]}finally{fe.value=!1}},re=C(()=>{let e=r.value;if(Y.value.trim()){const t=Y.value.trim().toLowerCase();e=e.filter(a=>a.shiftName.toLowerCase().includes(t)||a.personnel.toLowerCase().includes(t))}if(j.value&&(e=e.filter(t=>t.status===j.value)),V.value){const t=N(new Date(V.value));e=e.filter(a=>a.recordTime.includes(t))}return e}),Ve=C(()=>{const{page:e,pageSize:t}=w.value,a=re.value,l=(e-1)*t,i=l+t;return a.slice(l,i)});ve([Y,j,V],()=>{w.value.page=1}),Je(()=>{Me(),x(),_e()}),ve(b,()=>{_e()});const Ee=C(()=>{const e=L.value.length,t=W.value.length,a=r.value.length>0?(r.value.filter(l=>l.status==="正常").length/r.value.length*100).toFixed(1):"0.0";return[{label:"班次1排班量",value:`${e*2}+`,trend:"up",unit:""},{label:"班次2排班量",value:`${e}`,trend:"up",unit:"个"},{label:"班次3排班量",value:`${t}`,trend:"up",unit:"个"},{label:"出勤率",value:`${a}%`,trend:"up",unit:""}]}),B=C(()=>{const e=[],t=[],a=[];for(let l=6;l>=0;l--){const i=new Date;i.setDate(i.getDate()-l);const S=N(i);e.push(S);const y=se(S);t.push(Math.floor(y?Math.random()*5e4+1e4:Math.random()*3e4)),a.push(Math.floor(y?Math.random()*3e4+5e3:Math.random()*2e4))}return{dates:e,shift1Data:t,shift2Data:a}}),E=C(()=>{const e=B.value.dates,t=[],a=[];return e.forEach(()=>{t.push(Math.floor(Math.random()*50+20)),a.push(Math.floor(Math.random()*30+10))}),{dates:e,shift1Attendance:t,shift2Attendance:a}}),we=C(()=>{const e=L.value.filter(i=>i.positions.includes("岗位1")).length*2,t=L.value.filter(i=>i.positions.includes("岗位2")).length*2,a=L.value.length*3,l=e+t+a;return[{name:"班次1",value:e,color:"#1890ff",percentage:(e/l*100).toFixed(1)},{name:"班次2",value:t,color:"#52c41a",percentage:(t/l*100).toFixed(1)},{name:"班次3",value:a,color:"#722ed1",percentage:(a/l*100).toFixed(1)}]}),Ke=u([{text:"排班调整",size:32,color:"#1890ff"},{text:"考勤异常",size:28,color:"#ff4d4f"},{text:"人员调配",size:26,color:"#52c41a"},{text:"班次安排",size:24,color:"#fa8c16"},{text:"岗位分配",size:22,color:"#722ed1"},{text:"请假申请",size:20,color:"#13c2c2"},{text:"加班统计",size:18,color:"#eb2f96"},{text:"出勤率",size:16,color:"#f5222d"},{text:"工作状态",size:14,color:"#2f54eb"},{text:"任务分配",size:12,color:"#faad14"}]),Oe=e=>{D.success("保存成功"),te.value=!1},We=C(()=>{const e=b.value.getFullYear(),t=b.value.getMonth()+1;return`${e}年${t}月`}),qe=C(()=>{const e=b.value.getFullYear(),t=b.value.getMonth(),a=new Date(e,t,1),l=new Date(e,t+1,0),i=a.getDay(),S=l.getDate(),y=[],de=new Date(e,t,0).getDate();for(let _=i-1;_>=0;_--){const T=new Date(e,t-1,de-_),U=N(T),f=se(U);y.push({day:T.getDate(),date:T,dateStr:U,otherMonth:!0,isToday:!1,schedules:(f==null?void 0:f.positions)||[],colors:(f==null?void 0:f.colors)||[]})}const le=new Date;for(let _=1;_<=S;_++){const T=new Date(e,t,_),U=N(T),f=se(U),Xe=U===N(le);y.push({day:_,date:T,dateStr:U,otherMonth:!1,isToday:Xe,schedules:(f==null?void 0:f.positions)||[],colors:(f==null?void 0:f.colors)||[]})}const ne=42-y.length;for(let _=1;_<=ne;_++){const T=new Date(e,t+1,_),U=N(T),f=se(U);y.push({day:_,date:T,dateStr:U,otherMonth:!0,isToday:!1,schedules:(f==null?void 0:f.positions)||[],colors:(f==null?void 0:f.colors)||[]})}return y}),He=C(()=>{const e=Q.value.trim(),t=X.value,a=O.value,l=a?N(new Date(a)):"";return W.value.filter(i=>{var le,ne,_;const S=!e||((le=i.name)==null?void 0:le.includes(e))||((ne=i.employeeCode)==null?void 0:ne.includes(e))||((_=i.phone)==null?void 0:_.includes(e)),y=!t||i.workStatus===t,de=!l||i.createdAt&&i.createdAt.includes(l);return S&&y&&de})}),Qe=C(()=>{const{page:e,pageSize:t}=k.value,a=He.value;k.value.itemCount=a.length;const l=(e-1)*t,i=l+t;return a.slice(l,i)});return(e,t)=>(d(),c("div",ft,[t[38]||(t[38]=s("div",{class:"page-title"},"排班调度",-1)),o(n(et),{value:K.value,"onUpdate:value":t[13]||(t[13]=a=>K.value=a),type:"line",class:"scheduling-tabs"},{default:v(()=>[o(n(ce),{name:"schedule",tab:"排班表"},{default:v(()=>[P.value?(d(),c("div",gt,[s("div",mt,[o(n(z),{text:"",onClick:je,class:"back-btn"},{icon:v(()=>[o(n(I),{icon:"ri:arrow-left-line"})]),default:v(()=>[t[15]||(t[15]=s("span",null,"统计分析",-1))]),_:1})]),s("div",yt,[(d(!0),c($,null,M(Ee.value,(a,l)=>(d(),c("div",{key:l,class:"metric-card"},[s("div",_t,h(a.label),1),s("div",wt,[s("span",kt,h(a.value),1),a.unit?(d(),c("span",bt,h(a.unit),1)):De("",!0),s("span",xt,[o(n(I),{icon:"ri:arrow-up-line",class:"trend-up"})])])]))),128))]),s("div",St,[s("div",zt,[t[20]||(t[20]=s("div",{class:"chart-title"},"工作量分布 (近7日)",-1)),s("div",Dt,[(d(),c("svg",Ct,[t[18]||(t[18]=s("line",{x1:"50",y1:"20",x2:"50",y2:"280",stroke:"#e0e0e0","stroke-width":"1"},null,-1)),t[19]||(t[19]=s("line",{x1:"50",y1:"280",x2:"550",y2:"280",stroke:"#e0e0e0","stroke-width":"1"},null,-1)),(d(),c($,null,M([0,10,20,30,40,50,60],(a,l)=>s("text",{key:l,x:45,y:280-l*43,"text-anchor":"end",fill:"#666","font-size":"12"},h(a)+"k ",9,Mt)),64)),(d(!0),c($,null,M(B.value.dates,(a,l)=>(d(),c("text",{key:l,x:50+l*71.4+35,y:"295","text-anchor":"middle",fill:"#666","font-size":"11"},h(a.slice(5)),9,$t))),128)),s("polyline",{points:B.value.dates.map((a,l)=>`${50+l*71.4+35},${280-B.value.shift1Data[l]/1e3*4.3}`).join(" "),fill:"none",stroke:"#52c41a","stroke-width":"2"},null,8,Nt),s("polyline",{points:B.value.dates.map((a,l)=>`${50+l*71.4+35},${280-B.value.shift2Data[l]/1e3*4.3}`).join(" "),fill:"none",stroke:"#1890ff","stroke-width":"2"},null,8,Tt),s("g",Ut,[t[16]||(t[16]=s("circle",{cx:"0",cy:"0",r:"4",fill:"#52c41a"},null,-1)),s("text",At,"班次1 "+h(B.value.shift1Data.reduce((a,l)=>a+l,0).toLocaleString()),1),t[17]||(t[17]=s("circle",{cx:"0",cy:"20",r:"4",fill:"#1890ff"},null,-1)),s("text",Pt,"班次2 "+h(B.value.shift2Data.reduce((a,l)=>a+l,0).toLocaleString()),1)])]))])]),s("div",Ft,[t[25]||(t[25]=s("div",{class:"chart-title"},"出勤情况 (近7日)",-1)),s("div",Lt,[(d(),c("svg",Bt,[t[23]||(t[23]=s("line",{x1:"50",y1:"20",x2:"50",y2:"280",stroke:"#e0e0e0","stroke-width":"1"},null,-1)),t[24]||(t[24]=s("line",{x1:"50",y1:"280",x2:"550",y2:"280",stroke:"#e0e0e0","stroke-width":"1"},null,-1)),(d(),c($,null,M([0,10,20,30,40,50,60],(a,l)=>s("text",{key:l,x:45,y:280-l*43,"text-anchor":"end",fill:"#666","font-size":"12"},h(a)+"k ",9,Rt)),64)),(d(!0),c($,null,M(E.value.dates,(a,l)=>(d(),c("text",{key:l,x:50+l*71.4+35,y:"295","text-anchor":"middle",fill:"#666","font-size":"11"},h(a.slice(5)),9,It))),128)),s("polyline",{points:E.value.dates.map((a,l)=>`${50+l*71.4+35},${280-E.value.shift1Attendance[l]*4.3}`).join(" "),fill:"none",stroke:"#52c41a","stroke-width":"2"},null,8,Yt),s("polyline",{points:E.value.dates.map((a,l)=>`${50+l*71.4+35},${280-E.value.shift2Attendance[l]*4.3}`).join(" "),fill:"none",stroke:"#1890ff","stroke-width":"2"},null,8,jt),s("g",Vt,[t[21]||(t[21]=s("circle",{cx:"0",cy:"0",r:"4",fill:"#52c41a"},null,-1)),s("text",Et,"班次1 "+h(E.value.shift1Attendance.reduce((a,l)=>a+l,0)),1),t[22]||(t[22]=s("circle",{cx:"0",cy:"20",r:"4",fill:"#1890ff"},null,-1)),s("text",Kt,"班次2 "+h(E.value.shift2Attendance.reduce((a,l)=>a+l,0)),1)])]))])]),s("div",Ot,[t[29]||(t[29]=s("div",{class:"chart-title"},"班次分布",-1)),s("div",Wt,[(d(),c("svg",qt,[t[28]||(t[28]=s("defs",null,[s("filter",{id:"shadow"},[s("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3","flood-opacity":"0.1"})])],-1)),s("g",Ht,[t[26]||(t[26]=s("circle",{cx:"0",cy:"0",r:"60",fill:"#f5f5f5"},null,-1)),t[27]||(t[27]=s("text",{x:"0",y:"-5","text-anchor":"middle",fill:"#333","font-size":"14","font-weight":"500"},"总数据",-1)),s("text",Qt,h(we.value.reduce((a,l)=>a+l.value,0).toLocaleString()),1)])])),s("div",Xt,[(d(!0),c($,null,M(we.value,(a,l)=>(d(),c("div",{key:l,class:"legend-item"},[s("span",{class:"legend-dot",style:ue({backgroundColor:a.color})},null,4),s("span",Gt,h(a.name)+" "+h(a.value),1)]))),128))])])]),s("div",Jt,[t[30]||(t[30]=s("div",{class:"chart-title"},"热点问题",-1)),s("div",Zt,[(d(!0),c($,null,M(Ke.value,(a,l)=>(d(),c("span",{key:l,class:"word-item",style:ue({fontSize:`${a.size}px`,color:a.color,fontWeight:a.size>24?600:400})},h(a.text),5))),128))])])])])):(d(),c("div",ea,[s("div",ta,[s("div",aa,[o(n(Z),{value:q.value,"onUpdate:value":t[0]||(t[0]=a=>q.value=a),placeholder:"搜索排班",clearable:"",class:"search-input"},{prefix:v(()=>[o(n(I),{icon:"ri:search-line"})]),_:1},8,["value"]),s("div",sa,[o(n(J),{value:H.value,"onUpdate:value":t[1]||(t[1]=a=>H.value=a),type:"date",placeholder:"开始日期",clearable:"",class:"date-picker"},null,8,["value"]),t[31]||(t[31]=s("span",{class:"date-separator"},"-",-1)),o(n(J),{value:m.value,"onUpdate:value":t[2]||(t[2]=a=>m.value=a),type:"date",placeholder:"结束日期",clearable:"",class:"date-picker"},null,8,["value"])])]),s("div",la,[o(n(z),{onClick:Ie,class:"action-btn"},{default:v(()=>[...t[32]||(t[32]=[A(" 导入排班 ",-1)])]),_:1}),o(n(z),{type:"primary",onClick:Re,class:"action-btn"},{icon:v(()=>[o(n(I),{icon:"ri:add-line"})]),default:v(()=>[t[33]||(t[33]=A(" 新增排班 ",-1))]),_:1}),o(n(z),{onClick:Ye,class:"action-btn"},{default:v(()=>[...t[34]||(t[34]=[A(" 统计分析 ",-1)])]),_:1})])]),s("div",na,[o(n(z),{size:"small",onClick:Fe},{default:v(()=>[...t[35]||(t[35]=[A("上个月",-1)])]),_:1}),o(n(z),{size:"small",onClick:Be},{default:v(()=>[...t[36]||(t[36]=[A("今天",-1)])]),_:1}),o(n(z),{size:"small",onClick:Le},{default:v(()=>[...t[37]||(t[37]=[A("下个月",-1)])]),_:1}),s("div",oa,h(We.value),1)]),s("div",ia,[s("div",ra,[s("div",da,[(d(),c($,null,M(["日","一","二","三","四","五","六"],a=>s("div",{class:"weekday",key:a},h(a),1)),64))]),s("div",ca,[(d(!0),c($,null,M(qe.value,(a,l)=>(d(),c("div",{key:l,class:Ze(["calendar-day",{"other-month":a.otherMonth,today:a.isToday}])},[s("div",ua,h(a.day),1),s("div",va,[(d(!0),c($,null,M(a.schedules,(i,S)=>(d(),c("div",{key:S,class:"schedule-item",style:ue({"--item-color":a.colors[S]||ae[i]||"#1890ff"})},h(i),5))),128))])],2))),128))])])])]))]),_:1}),o(n(ce),{name:"attendance",tab:"考勤统计"},{default:v(()=>[s("div",pa,[s("div",ha,[o(n(Z),{value:Y.value,"onUpdate:value":t[3]||(t[3]=a=>Y.value=a),placeholder:"搜索排班",clearable:"",class:"filter-input"},{prefix:v(()=>[o(n(I),{icon:"ri:search-line"})]),_:1},8,["value"]),o(n(pe),{value:j.value,"onUpdate:value":t[4]||(t[4]=a=>j.value=a),options:oe,placeholder:"考勤状态",clearable:"",class:"filter-select"},null,8,["value"]),o(n(J),{value:V.value,"onUpdate:value":t[5]||(t[5]=a=>V.value=a),type:"date",placeholder:"请选择日期",clearable:"",class:"filter-date"},null,8,["value"])]),s("div",fa,[o(n(be),{columns:Ue,data:Ve.value,pagination:!1,bordered:!0,loading:g.value,striped:""},null,8,["data","loading"])]),s("div",ga,[s("div",ma,"共"+h(re.value.length)+"条",1),o(n(xe),{page:w.value.page,"onUpdate:page":[t[6]||(t[6]=a=>w.value.page=a),w.value.onChange],"page-size":w.value.pageSize,"onUpdate:pageSize":[t[7]||(t[7]=a=>w.value.pageSize=a),w.value.onUpdatePageSize],"item-count":re.value.length,"page-sizes":w.value.pageSizes,"show-size-picker":""},null,8,["page","page-size","item-count","page-sizes","onUpdate:page","onUpdate:pageSize"])])])]),_:1}),o(n(ce),{name:"personnel",tab:"人员管理"},{default:v(()=>[s("div",ya,[s("div",_a,[o(n(Z),{value:Q.value,"onUpdate:value":t[8]||(t[8]=a=>Q.value=a),placeholder:"搜索人员",clearable:"",class:"filter-input"},{prefix:v(()=>[o(n(I),{icon:"ri:search-line"})]),_:1},8,["value"]),o(n(pe),{value:X.value,"onUpdate:value":t[9]||(t[9]=a=>X.value=a),options:p,placeholder:"工作状态",clearable:"",class:"filter-select"},null,8,["value"]),o(n(J),{value:O.value,"onUpdate:value":t[10]||(t[10]=a=>O.value=a),type:"date",placeholder:"请选择创建日期",clearable:"",class:"filter-date"},null,8,["value"])]),s("div",wa,[o(n(be),{columns:Ae,data:Qe.value,pagination:!1,bordered:!0,loading:G.value,striped:""},null,8,["data","loading"])]),s("div",ka,[s("div",ba,"共"+h(k.value.itemCount)+"条",1),o(n(xe),{page:k.value.page,"onUpdate:page":[t[11]||(t[11]=a=>k.value.page=a),k.value.onChange],"page-size":k.value.pageSize,"onUpdate:pageSize":[t[12]||(t[12]=a=>k.value.pageSize=a),k.value.onUpdatePageSize],"item-count":k.value.itemCount,"page-sizes":k.value.pageSizes,"show-size-picker":""},null,8,["page","page-size","item-count","page-sizes","onUpdate:page","onUpdate:pageSize"])])])]),_:1})]),_:1},8,["value"]),o(ht,{show:te.value,"onUpdate:show":t[14]||(t[14]=a=>te.value=a),schedule:ge.value,onSave:Oe},null,8,["show","schedule"])]))}});const Ta=Ce(xa,[["__scopeId","data-v-83ef76bd"]]);export{Ta as default};
