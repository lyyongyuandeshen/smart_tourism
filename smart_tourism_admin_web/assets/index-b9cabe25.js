import{a as Nn,b as Rn,c as Cn,d as Dn,e as Kn}from"./model-3178221e.js";import{bn as Tn,n as z,r as $,bj as Ln,bo as Ut,d as fe,w as K,bp as gt,bq as xe,br as _n,bs as me,h as zt,bt as H,$ as bt,K as Mt,t as A,bu as jt,bv as Nt,bw as En,bx as $n,by as Pn,bz as Rt,bA as dt,bB as An,bC as Bn,bD as Fn,bE as In,bF as He,bG as On,f as O,e as ce,H as G,bH as Ct,I as we,G as _e,bI as Un,L as zn,k as Gt,bJ as Mn,p as Dt,bK as Ie,j as Xe,a4 as We,bL as jn,bM as st,bN as Oe,q as Gn,bk as Kt,bO as qn,bP as Tt,as as Qe,bQ as Lt,F as te,bc as _t,b6 as Vn,bR as Hn,a2 as Xn,bS as Et,o as ct,c as $t,a as ie,b as x,ab as D,R as k,X as Pt,bT as Wn,ac as Ee,a5 as ve,bU as Qn,aa as Yn,Q as Jn,bV as Zn,a6 as $e,bW as el,aM as tl,N as Ye,bX as ut,aS as ft,aO as nl,b7 as ll}from"./index-5805bd08.js";import{a as al,N as ol}from"./Pagination-78bedb34.js";import{g as il}from"./Forward-dbe0c59b.js";import{N as ue}from"./FormItem-8b481c62.js";import{N as At}from"./Space-a5c105a8.js";import{N as rl}from"./Form-9e4f5768.js";import{N as dl}from"./Switch-1df89df0.js";function sl(e){if(typeof e=="number")return{"":e.toString()};const n={};return e.split(/ +/).forEach(i=>{if(i==="")return;const[l,o]=i.split(":");o===void 0?n[""]=l:n[l]=o}),n}function Pe(e,n){var i;if(e==null)return;const l=sl(e);if(n===void 0)return l[""];if(typeof n=="string")return(i=l[n])!==null&&i!==void 0?i:l[""];if(Array.isArray(n)){for(let o=n.length-1;o>=0;--o){const r=n[o];if(r in l)return l[r]}return l[""]}else{let o,r=-1;return Object.keys(l).forEach(u=>{const f=Number(u);!Number.isNaN(f)&&n>=f&&f>=r&&(r=f,o=l[u])}),o}}const cl={xs:0,s:640,m:1024,l:1280,xl:1536,"2xl":1920};function ul(e){return`(min-width: ${e}px)`}const Ue={};function fl(e=cl){if(!Tn)return z(()=>[]);if(typeof window.matchMedia!="function")return z(()=>[]);const n=$({}),i=Object.keys(e),l=(o,r)=>{o.matches?n.value[r]=!0:n.value[r]=!1};return i.forEach(o=>{const r=e[o];let u,f;Ue[r]===void 0?(u=window.matchMedia(ul(r)),u.addEventListener?u.addEventListener("change",m=>{f.forEach(h=>{h(m,o)})}):u.addListener&&u.addListener(m=>{f.forEach(h=>{h(m,o)})}),f=new Set,Ue[r]={mql:u,cbs:f}):(u=Ue[r].mql,f=Ue[r].cbs),f.add(l),u.matches&&f.forEach(m=>{m(u,o)})}),Ln(()=>{i.forEach(o=>{const{cbs:r}=Ue[e[o]];r.has(l)&&r.delete(l)})}),z(()=>{const{value:o}=n;return i.filter(r=>o[r])})}function qt(e){return typeof e=="string"?`s-${e}`:`n-${e}`}function hl(e){var n;const i=(n=e.dirs)===null||n===void 0?void 0:n.find(({dir:l})=>l===Ut);return!!(i&&i.value===!1)}const vl=fe({name:"Switcher",render(){return K("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},K("path",{d:"M12 8l10 8l-10 8z"}))}}),Bt=1,Vt=gt("n-grid"),Ht=1,gl={span:{type:[Number,String],default:Ht},offset:{type:[Number,String],default:0},suffix:Boolean,privateOffset:Number,privateSpan:Number,privateColStart:Number,privateShow:{type:Boolean,default:!0}},re=fe({__GRID_ITEM__:!0,name:"GridItem",alias:["Gi"],props:gl,setup(){const{isSsrRef:e,xGapRef:n,itemStyleRef:i,overflowRef:l,layoutShiftDisabledRef:o}=xe(Vt),r=_n();return{overflow:l,itemStyle:i,layoutShiftDisabled:o,mergedXGap:z(()=>me(n.value||0)),deriveStyle:()=>{e.value;const{privateSpan:u=Ht,privateShow:f=!0,privateColStart:m=void 0,privateOffset:h=0}=r.vnode.props,{value:C}=n,E=me(C||0);return{display:f?"":"none",gridColumn:`${m??`span ${u}`} / span ${u}`,marginLeft:h?`calc((100% - (${u} - 1) * ${E}) / ${u} * ${h} + ${E} * ${h})`:""}}}},render(){var e,n;if(this.layoutShiftDisabled){const{span:i,offset:l,mergedXGap:o}=this;return K("div",{style:{gridColumn:`span ${i} / span ${i}`,marginLeft:l?`calc((100% - (${i} - 1) * ${o}) / ${i} * ${l} + ${o} * ${l})`:""}},this.$slots)}return K("div",{style:[this.itemStyle,this.deriveStyle()]},(n=(e=this.$slots).default)===null||n===void 0?void 0:n.call(e,{overflow:this.overflow}))}}),bl={xs:0,s:640,m:1024,l:1280,xl:1536,xxl:1920},Xt=24,ht="__ssr__",pl={layoutShiftDisabled:Boolean,responsive:{type:[String,Boolean],default:"self"},cols:{type:[Number,String],default:Xt},itemResponsive:Boolean,collapsed:Boolean,collapsedRows:{type:Number,default:1},itemStyle:[Object,String],xGap:{type:[Number,String],default:0},yGap:{type:[Number,String],default:0}},Ft=fe({name:"Grid",inheritAttrs:!1,props:pl,setup(e){const{mergedClsPrefixRef:n,mergedBreakpointsRef:i}=zt(e),l=/^\d+$/,o=$(void 0),r=fl((i==null?void 0:i.value)||bl),u=H(()=>!!(e.itemResponsive||!l.test(e.cols.toString())||!l.test(e.xGap.toString())||!l.test(e.yGap.toString()))),f=z(()=>{if(u.value)return e.responsive==="self"?o.value:r.value}),m=H(()=>{var c;return(c=Number(Pe(e.cols.toString(),f.value)))!==null&&c!==void 0?c:Xt}),h=H(()=>Pe(e.xGap.toString(),f.value)),C=H(()=>Pe(e.yGap.toString(),f.value)),E=c=>{o.value=c.contentRect.width},T=c=>{$n(E,c)},L=$(!1),_=z(()=>{if(e.responsive==="self")return T}),S=$(!1),w=$();return bt(()=>{const{value:c}=w;c&&c.hasAttribute(ht)&&(c.removeAttribute(ht),S.value=!0)}),Mt(Vt,{layoutShiftDisabledRef:A(e,"layoutShiftDisabled"),isSsrRef:S,itemStyleRef:A(e,"itemStyle"),xGapRef:h,overflowRef:L}),{isSsr:!jt,contentEl:w,mergedClsPrefix:n,style:z(()=>e.layoutShiftDisabled?{width:"100%",display:"grid",gridTemplateColumns:`repeat(${e.cols}, minmax(0, 1fr))`,columnGap:me(e.xGap),rowGap:me(e.yGap)}:{width:"100%",display:"grid",gridTemplateColumns:`repeat(${m.value}, minmax(0, 1fr))`,columnGap:me(h.value),rowGap:me(C.value)}),isResponsive:u,responsiveQuery:f,responsiveCols:m,handleResize:_,overflow:L}},render(){if(this.layoutShiftDisabled)return K("div",Nt({ref:"contentEl",class:`${this.mergedClsPrefix}-grid`,style:this.style},this.$attrs),this.$slots);const e=()=>{var n,i,l,o,r,u,f;this.overflow=!1;const m=Pn(il(this)),h=[],{collapsed:C,collapsedRows:E,responsiveCols:T,responsiveQuery:L}=this;m.forEach(p=>{var I,N,M,q,Y;if(((I=p==null?void 0:p.type)===null||I===void 0?void 0:I.__GRID_ITEM__)!==!0)return;if(hl(p)){const s=Rt(p);s.props?s.props.privateShow=!1:s.props={privateShow:!1},h.push({child:s,rawChildSpan:0});return}p.dirs=((N=p.dirs)===null||N===void 0?void 0:N.filter(({dir:s})=>s!==Ut))||null,((M=p.dirs)===null||M===void 0?void 0:M.length)===0&&(p.dirs=null);const J=Rt(p),R=Number((Y=Pe((q=J.props)===null||q===void 0?void 0:q.span,L))!==null&&Y!==void 0?Y:Bt);R!==0&&h.push({child:J,rawChildSpan:R})});let _=0;const S=(n=h[h.length-1])===null||n===void 0?void 0:n.child;if(S!=null&&S.props){const p=(i=S.props)===null||i===void 0?void 0:i.suffix;p!==void 0&&p!==!1&&(_=Number((o=Pe((l=S.props)===null||l===void 0?void 0:l.span,L))!==null&&o!==void 0?o:Bt),S.props.privateSpan=_,S.props.privateColStart=T+1-_,S.props.privateShow=(r=S.props.privateShow)!==null&&r!==void 0?r:!0)}let w=0,c=!1;for(const{child:p,rawChildSpan:I}of h){if(c&&(this.overflow=!0),!c){const N=Number((f=Pe((u=p.props)===null||u===void 0?void 0:u.offset,L))!==null&&f!==void 0?f:0),M=Math.min(I+N,T);if(p.props?(p.props.privateSpan=M,p.props.privateOffset=N):p.props={privateSpan:M,privateOffset:N},C){const q=w%T;M+q>T&&(w+=T-q),M+w+_>E*T?c=!0:w+=M}}c&&(p.props?p.props.privateShow!==!0&&(p.props.privateShow=!1):p.props={privateShow:!1})}return K("div",Nt({ref:"contentEl",class:`${this.mergedClsPrefix}-grid`,style:this.style,[ht]:this.isSsr||void 0},this.$attrs),h.map(({child:p})=>p))};return this.isResponsive&&this.responsive==="self"?K(En,{onResize:this.handleResize},{default:e}):e()}}),Wt=gt("n-tree-select");function It({position:e,offsetLevel:n,indent:i,el:l}){const o={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")o.left=0,o.top=0,o.bottom=0,o.borderRadius="inherit",o.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const r=e==="before"?"top":"bottom";o[r]=0,o.left=`${l.offsetLeft+6-n*i}px`,o.height="2px",o.backgroundColor="var(--n-drop-mark-color)",o.transformOrigin=r,o.borderRadius="1px",o.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return K("div",{style:o})}function yl({dropPosition:e,node:n}){return n.isLeaf===!1||n.children?!0:e!=="inside"}const ze=gt("n-tree");function ml({props:e,fNodesRef:n,mergedExpandedKeysRef:i,mergedSelectedKeysRef:l,mergedCheckedKeysRef:o,handleCheck:r,handleSelect:u,handleSwitcherClick:f}){const{value:m}=l,h=xe(Wt,null),C=h?h.pendingNodeKeyRef:$(m.length?m[m.length-1]:null);function E(T){var L;if(!e.keyboard)return{enterBehavior:null};const{value:_}=C;let S=null;if(_===null){if((T.key==="ArrowDown"||T.key==="ArrowUp")&&T.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(T.key)&&_===null){const{value:w}=n;let c=0;for(;c<w.length;){if(!w[c].disabled){C.value=w[c].key;break}c+=1}}}else{const{value:w}=n;let c=w.findIndex(p=>p.key===_);if(!~c)return{enterBehavior:null};if(T.key==="Enter"){const p=w[c];switch(S=((L=e.overrideDefaultNodeClickBehavior)===null||L===void 0?void 0:L.call(e,{option:p.rawNode}))||null,S){case"toggleCheck":r(p,!o.value.includes(p.key));break;case"toggleSelect":u(p);break;case"toggleExpand":f(p);break;case"none":break;case"default":default:S="default",u(p)}}else if(T.key==="ArrowDown")for(T.preventDefault(),c+=1;c<w.length;){if(!w[c].disabled){C.value=w[c].key;break}c+=1}else if(T.key==="ArrowUp")for(T.preventDefault(),c-=1;c>=0;){if(!w[c].disabled){C.value=w[c].key;break}c-=1}else if(T.key==="ArrowLeft"){const p=w[c];if(p.isLeaf||!i.value.includes(_)){const I=p.getParent();I&&(C.value=I.key)}else f(p)}else if(T.key==="ArrowRight"){const p=w[c];if(p.isLeaf)return{enterBehavior:null};if(!i.value.includes(_))f(p);else for(c+=1;c<w.length;){if(!w[c].disabled){C.value=w[c].key;break}c+=1}}}return{enterBehavior:S}}return{pendingNodeKeyRef:C,handleKeydown:E}}const kl=fe({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const n=xe(ze);function i(o){const{onCheck:r}=e;r&&r(o)}function l(o){i(o)}return{handleUpdateValue:l,mergedTheme:n.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:n,checked:i,indeterminate:l,disabled:o,focusable:r,indent:u,handleUpdateValue:f}=this;return K("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],style:{width:`${u}px`},"data-checkbox":!0},K(al,{focusable:r,disabled:o,theme:n.peers.Checkbox,themeOverrides:n.peerOverrides.Checkbox,checked:i,indeterminate:l,onUpdateChecked:f}))}}),wl=fe({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:n,renderPrefixRef:i,renderSuffixRef:l,labelFieldRef:o}=xe(ze),r=$(null);function u(m){const{onClick:h}=e;h&&h(m)}function f(m){u(m)}return{selfRef:r,renderLabel:n,renderPrefix:i,renderSuffix:l,labelField:o,handleClick:f}},render(){const{clsPrefix:e,labelField:n,nodeProps:i,checked:l=!1,selected:o=!1,renderLabel:r,renderPrefix:u,renderSuffix:f,handleClick:m,onDragstart:h,tmNode:{rawNode:C,rawNode:{prefix:E,suffix:T,[n]:L}}}=this;return K("span",Object.assign({},i,{ref:"selfRef",class:[`${e}-tree-node-content`,i==null?void 0:i.class],onClick:m,draggable:h===void 0?void 0:!0,onDragstart:h}),u||E?K("div",{class:`${e}-tree-node-content__prefix`},u?u({option:C,selected:o,checked:l}):dt(E)):null,K("div",{class:`${e}-tree-node-content__text`},r?r({option:C,selected:o,checked:l}):dt(L)),f||T?K("div",{class:`${e}-tree-node-content__suffix`},f?f({option:C,selected:o,checked:l}):dt(T)):null)}}),xl=fe({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function,tmNode:{type:Object,required:!0}},setup(e){const{renderSwitcherIconRef:n}=xe(ze,null);return()=>{const{clsPrefix:i,expanded:l,hide:o,indent:r,onClick:u}=e;return K("span",{"data-switcher":!0,class:[`${i}-tree-node-switcher`,l&&`${i}-tree-node-switcher--expanded`,o&&`${i}-tree-node-switcher--hide`],style:{width:`${r}px`},onClick:u},K("div",{class:`${i}-tree-node-switcher__icon`},K(An,null,{default:()=>{if(e.loading)return K(Bn,{clsPrefix:i,key:"loading",radius:85,strokeWidth:20});const{value:f}=n;return f?f({expanded:e.expanded,selected:e.selected,option:e.tmNode.rawNode}):K(Fn,{clsPrefix:i,key:"switcher"},{default:()=>K(vl,null)})}})))}}});function Sl(e){return z(()=>e.leafOnly?"child":e.checkStrategy)}function ye(e,n){return!!e.rawNode[n]}function Qt(e,n,i,l){e==null||e.forEach(o=>{i(o),Qt(o[n],n,i,l),l(o)})}function Nl(e,n,i,l,o){const r=new Set,u=new Set,f=[];return Qt(e,l,m=>{if(f.push(m),o(n,m)){u.add(m[i]);for(let h=f.length-2;h>=0;--h)if(!r.has(f[h][i]))r.add(f[h][i]);else return}},()=>{f.pop()}),{expandedKeys:Array.from(r),highlightKeySet:u}}if(jt&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function Rl(e,n,i,l,o){const r=new Set,u=new Set,f=new Set,m=[],h=[],C=[];function E(L){L.forEach(_=>{if(C.push(_),n(i,_)){r.add(_[l]),f.add(_[l]);for(let w=C.length-2;w>=0;--w){const c=C[w][l];if(!u.has(c))u.add(c),r.has(c)&&r.delete(c);else break}}const S=_[o];S&&E(S),C.pop()})}E(e);function T(L,_){L.forEach(S=>{const w=S[l],c=r.has(w),p=u.has(w);if(!c&&!p)return;const I=S[o];if(I)if(c)_.push(S);else{m.push(w);const N=Object.assign(Object.assign({},S),{[o]:[]});_.push(N),T(I,N[o])}else _.push(S)})}return T(e,h),{filteredTree:h,highlightKeySet:f,expandedKeys:m}}const Cl=fe({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const n=xe(ze),{droppingNodeParentRef:i,droppingMouseNodeRef:l,draggingNodeRef:o,droppingPositionRef:r,droppingOffsetLevelRef:u,nodePropsRef:f,indentRef:m,blockLineRef:h,checkboxPlacementRef:C,checkOnClickRef:E,disabledFieldRef:T,showLineRef:L,renderSwitcherIconRef:_,overrideDefaultNodeClickBehaviorRef:S}=n,w=H(()=>!!e.tmNode.rawNode.checkboxDisabled),c=H(()=>ye(e.tmNode,T.value)),p=H(()=>n.disabledRef.value||c.value),I=z(()=>{const{value:g}=f;if(g)return g({option:e.tmNode.rawNode})}),N=$(null),M={value:null};bt(()=>{M.value=N.value.$el});function q(){const g=()=>{const{tmNode:P}=e;if(!P.isLeaf&&!P.shallowLoaded){if(!n.loadingKeysRef.value.has(P.key))n.loadingKeysRef.value.add(P.key);else return;const{onLoadRef:{value:U}}=n;U&&U(P.rawNode).then(V=>{V!==!1&&n.handleSwitcherClick(P)}).finally(()=>{n.loadingKeysRef.value.delete(P.key)})}else n.handleSwitcherClick(P)};_.value?setTimeout(g,0):g()}const Y=H(()=>!c.value&&n.selectableRef.value&&(n.internalTreeSelect?n.mergedCheckStrategyRef.value!=="child"||n.multipleRef.value&&n.cascadeRef.value||e.tmNode.isLeaf:!0)),J=H(()=>n.checkableRef.value&&(n.cascadeRef.value||n.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),R=H(()=>n.displayedCheckedKeysRef.value.includes(e.tmNode.key)),s=H(()=>{const{value:g}=J;if(!g)return!1;const{value:P}=E,{tmNode:U}=e;return typeof P=="boolean"?!U.disabled&&P:P(e.tmNode.rawNode)});function v(g){const{value:P}=n.expandOnClickRef,{value:U}=Y,{value:V}=s;if(!U&&!P&&!V||He(g,"checkbox")||He(g,"switcher"))return;const{tmNode:Q}=e;U&&n.handleSelect(Q),P&&!Q.isLeaf&&q(),V&&X(!R.value)}function he(g){var P,U;if(!(He(g,"checkbox")||He(g,"switcher"))){if(!p.value){const V=S.value;let Q=!1;if(V)switch(V({option:e.tmNode.rawNode})){case"toggleCheck":Q=!0,X(!R.value);break;case"toggleSelect":Q=!0,n.handleSelect(e.tmNode);break;case"toggleExpand":Q=!0,q(),Q=!0;break;case"none":Q=!0,Q=!0;return}Q||v(g)}(U=(P=I.value)===null||P===void 0?void 0:P.onClick)===null||U===void 0||U.call(P,g)}}function Se(g){h.value||he(g)}function Z(g){h.value&&he(g)}function X(g){n.handleCheck(e.tmNode,g)}function ge(g){n.handleDragStart({event:g,node:e.tmNode})}function Je(g){g.currentTarget===g.target&&n.handleDragEnter({event:g,node:e.tmNode})}function de(g){g.preventDefault(),n.handleDragOver({event:g,node:e.tmNode})}function be(g){n.handleDragEnd({event:g,node:e.tmNode})}function Ae(g){g.currentTarget===g.target&&n.handleDragLeave({event:g,node:e.tmNode})}function Ze(g){g.preventDefault(),r.value!==null&&n.handleDrop({event:g,node:e.tmNode,dropPosition:r.value})}const et=z(()=>{const{clsPrefix:g}=e,{value:P}=m;if(L.value){const U=[];let V=e.tmNode.parent;for(;V;)V.isLastChild?U.push(K("div",{class:`${g}-tree-node-indent`},K("div",{style:{width:`${P}px`}}))):U.push(K("div",{class:[`${g}-tree-node-indent`,`${g}-tree-node-indent--show-line`]},K("div",{style:{width:`${P}px`}}))),V=V.parent;return U.reverse()}else return In(e.tmNode.level,K("div",{class:`${e.clsPrefix}-tree-node-indent`},K("div",{style:{width:`${P}px`}})))});return{showDropMark:H(()=>{const{value:g}=o;if(!g)return;const{value:P}=r;if(!P)return;const{value:U}=l;if(!U)return;const{tmNode:V}=e;return V.key===U.key}),showDropMarkAsParent:H(()=>{const{value:g}=i;if(!g)return!1;const{tmNode:P}=e,{value:U}=r;return U==="before"||U==="after"?g.key===P.key:!1}),pending:H(()=>n.pendingNodeKeyRef.value===e.tmNode.key),loading:H(()=>n.loadingKeysRef.value.has(e.tmNode.key)),highlight:H(()=>{var g;return(g=n.highlightKeySetRef.value)===null||g===void 0?void 0:g.has(e.tmNode.key)}),checked:R,indeterminate:H(()=>n.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:H(()=>n.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:H(()=>n.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:p,checkable:J,mergedCheckOnClick:s,checkboxDisabled:w,selectable:Y,expandOnClick:n.expandOnClickRef,internalScrollable:n.internalScrollableRef,draggable:n.draggableRef,blockLine:h,nodeProps:I,checkboxFocusable:n.internalCheckboxFocusableRef,droppingPosition:r,droppingOffsetLevel:u,indent:m,checkboxPlacement:C,showLine:L,contentInstRef:N,contentElRef:M,indentNodes:et,handleCheck:X,handleDrop:Ze,handleDragStart:ge,handleDragEnter:Je,handleDragOver:de,handleDragEnd:be,handleDragLeave:Ae,handleLineClick:Z,handleContentClick:Se,handleSwitcherClick:q}},render(){const{tmNode:e,clsPrefix:n,checkable:i,expandOnClick:l,selectable:o,selected:r,checked:u,highlight:f,draggable:m,blockLine:h,indent:C,indentNodes:E,disabled:T,pending:L,internalScrollable:_,nodeProps:S,checkboxPlacement:w}=this,c=m&&!T?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,p=_?qt(e.key):void 0,I=w==="right",N=i?K(kl,{indent:C,right:I,focusable:this.checkboxFocusable,disabled:T||this.checkboxDisabled,clsPrefix:n,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return K("div",Object.assign({class:`${n}-tree-node-wrapper`},c),K("div",Object.assign({},h?S:void 0,{class:[`${n}-tree-node`,{[`${n}-tree-node--selected`]:r,[`${n}-tree-node--checkable`]:i,[`${n}-tree-node--highlight`]:f,[`${n}-tree-node--pending`]:L,[`${n}-tree-node--disabled`]:T,[`${n}-tree-node--selectable`]:o,[`${n}-tree-node--clickable`]:o||l||this.mergedCheckOnClick},S==null?void 0:S.class],"data-key":p,draggable:m&&h,onClick:this.handleLineClick,onDragstart:m&&h&&!T?this.handleDragStart:void 0}),E,e.isLeaf&&this.showLine?K("div",{class:[`${n}-tree-node-indent`,`${n}-tree-node-indent--show-line`,e.isLeaf&&`${n}-tree-node-indent--is-leaf`,e.isLastChild&&`${n}-tree-node-indent--last-child`]},K("div",{style:{width:`${C}px`}})):K(xl,{clsPrefix:n,expanded:this.expanded,selected:r,loading:this.loading,hide:e.isLeaf,tmNode:this.tmNode,indent:C,onClick:this.handleSwitcherClick}),I?null:N,K(wl,{ref:"contentInstRef",clsPrefix:n,checked:u,selected:r,onClick:this.handleContentClick,nodeProps:h?void 0:S,onDragstart:m&&!h&&!T?this.handleDragStart:void 0,tmNode:e}),m?this.showDropMark?It({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:C}):this.showDropMarkAsParent?It({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:C}):null:null,I?N:null))}}),Yt=Cl,Dl=fe({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return K(On,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>K("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:me(this.height)}},this.nodes.map(n=>K(Yt,{clsPrefix:e,tmNode:n})))})}}),vt=Un(),Kl=O("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[ce("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),ce(">",[O("tree-node",[ce("&:first-child","margin-top: 0;")])]),O("tree-motion-wrapper",[G("expand",[Ct({duration:"0.2s"})]),G("collapse",[Ct({duration:"0.2s",reverse:!0})])]),O("tree-node-wrapper",`
 box-sizing: border-box;
 padding: var(--n-node-wrapper-padding);
 `),O("tree-node",`
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[G("highlight",[O("tree-node-content",[we("text","border-bottom-color: var(--n-node-text-color-disabled);")])]),G("disabled",[O("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),_e("disabled",[G("clickable",[O("tree-node-content",`
 cursor: pointer;
 `)])])]),G("block-node",[O("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),_e("block-line",[O("tree-node",[_e("disabled",[O("tree-node-content",[ce("&:hover","background: var(--n-node-color-hover);")]),G("selectable",[O("tree-node-content",[ce("&:active","background: var(--n-node-color-pressed);")])]),G("pending",[O("tree-node-content",`
 background: var(--n-node-color-hover);
 `)]),G("selected",[O("tree-node-content","background: var(--n-node-color-active);")])]),G("selected",[O("tree-node-content","background: var(--n-node-color-active);")])])]),G("block-line",[O("tree-node",[_e("disabled",[ce("&:hover","background: var(--n-node-color-hover);"),G("pending",`
 background: var(--n-node-color-hover);
 `),G("selectable",[_e("selected",[ce("&:active","background: var(--n-node-color-pressed);")])]),G("selected","background: var(--n-node-color-active);")]),G("selected","background: var(--n-node-color-active);"),G("disabled",`
 cursor: not-allowed;
 `)])]),G("ellipsis",[O("tree-node",[O("tree-node-content",`
 overflow: hidden;
 `,[we("text",`
 text-overflow: ellipsis;
 white-space: nowrap;
 overflow: hidden;
 `)])])]),O("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 `,[G("show-line","position: relative",[ce("&::before",`
 position: absolute;
 left: 50%;
 border-left: 1px solid var(--n-line-color);
 transition: border-color .3s var(--n-bezier);
 transform: translate(-50%);
 content: "";
 top: var(--n-line-offset-top);
 bottom: var(--n-line-offset-bottom);
 `),G("last-child",[ce("&::before",`
 bottom: 50%;
 `)]),G("is-leaf",[ce("&::after",`
 position: absolute;
 content: "";
 left: calc(50% + 0.5px);
 right: 0;
 bottom: 50%;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-line-color);
 `)])]),_e("show-line","height: 0;")]),O("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: var(--n-node-content-height);
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[we("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[O("icon",[vt]),O("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[vt]),O("base-icon",[vt])]),G("hide","visibility: hidden;"),G("expanded","transform: rotate(90deg);")]),O("tree-node-checkbox",`
 display: inline-flex;
 height: var(--n-node-content-height);
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 `),O("tree-node-content",`
 user-select: none;
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: var(--n-node-content-height);
 box-sizing: border-box;
 line-height: var(--n-line-height);
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[ce("&:last-child","margin-bottom: 0;"),we("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),we("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),we("suffix",`
 display: inline-flex;
 `)]),we("empty","margin: auto;")]);var Tl=globalThis&&globalThis.__awaiter||function(e,n,i,l){function o(r){return r instanceof i?r:new i(function(u){u(r)})}return new(i||(i=Promise))(function(r,u){function f(C){try{h(l.next(C))}catch(E){u(E)}}function m(C){try{h(l.throw(C))}catch(E){u(E)}}function h(C){C.done?r(C.value):o(C.value).then(f,m)}h((l=l.apply(e,n||[])).next())})};function Ot(e,n,i,l){return{getIsGroup(){return!1},getKey(r){return r[e]},getChildren:l||(r=>r[n]),getDisabled(r){return!!(r[i]||r.checkboxDisabled)}}}const Ll={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indent:{type:Number,default:24},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array],overrideDefaultNodeClickBehavior:Function},_l=Object.assign(Object.assign(Object.assign(Object.assign({},Gt.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,showLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},scrollbarProps:Object,allowDrop:{type:Function,default:yl},animated:{type:Boolean,default:!0},ellipsis:Boolean,checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),Ll),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),El=fe({name:"Tree",props:_l,slots:Object,setup(e){const{mergedClsPrefixRef:n,inlineThemeDisabled:i,mergedRtlRef:l}=zt(e),o=zn("Tree",l,n),r=Gt("Tree","-tree",Kl,Mn,e,n),u=$(null),f=$(null),m=$(null);function h(){var t;return(t=m.value)===null||t===void 0?void 0:t.listElRef}function C(){var t;return(t=m.value)===null||t===void 0?void 0:t.itemsElRef}const E=z(()=>{const{filter:t}=e;if(t)return t;const{labelField:a}=e;return(d,b)=>{if(!d.length)return!0;const y=b[a];return typeof y=="string"?y.toLowerCase().includes(d.toLowerCase()):!1}}),T=z(()=>{const{pattern:t}=e;return t?!t.length||!E.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:Rl(e.data,E.value,t,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),L=z(()=>Dt(e.showIrrelevantNodes?e.data:T.value.filteredTree,Ot(e.keyField,e.childrenField,e.disabledField,e.getChildren))),_=xe(Wt,null),S=e.internalTreeSelect?_.dataTreeMate:z(()=>e.showIrrelevantNodes?L.value:Dt(e.data,Ot(e.keyField,e.childrenField,e.disabledField,e.getChildren))),{watchProps:w}=e,c=$([]);w!=null&&w.includes("defaultCheckedKeys")?Ie(()=>{c.value=e.defaultCheckedKeys}):c.value=e.defaultCheckedKeys;const p=A(e,"checkedKeys"),I=Xe(p,c),N=z(()=>S.value.getCheckedKeys(I.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),M=Sl(e),q=z(()=>N.value.checkedKeys),Y=z(()=>{const{indeterminateKeys:t}=e;return t!==void 0?t:N.value.indeterminateKeys}),J=$([]);w!=null&&w.includes("defaultSelectedKeys")?Ie(()=>{J.value=e.defaultSelectedKeys}):J.value=e.defaultSelectedKeys;const R=A(e,"selectedKeys"),s=Xe(R,J),v=$([]),he=t=>{v.value=e.defaultExpandAll?S.value.getNonLeafKeys():t===void 0?e.defaultExpandedKeys:t};w!=null&&w.includes("defaultExpandedKeys")?Ie(()=>{he(void 0)}):Ie(()=>{he(e.defaultExpandedKeys)});const Se=A(e,"expandedKeys"),Z=Xe(Se,v),X=z(()=>L.value.getFlattenedNodes(Z.value)),{pendingNodeKeyRef:ge,handleKeydown:Je}=ml({props:e,mergedCheckedKeysRef:I,mergedSelectedKeysRef:s,fNodesRef:X,mergedExpandedKeysRef:Z,handleCheck:ot,handleSelect:it,handleSwitcherClick:mt});let de=null,be=null;const Ae=$(new Set),Ze=z(()=>e.internalHighlightKeySet||T.value.highlightKeySet),et=Xe(Ze,Ae),g=$(new Set),P=z(()=>Z.value.filter(t=>!g.value.has(t)));let U=0;const V=$(null),Q=$(null),Me=$(null),je=$(null),Ge=$(0),Jt=z(()=>{const{value:t}=Q;return t?t.parent:null});let tt=!1;We(A(e,"data"),()=>{tt=!0,Qe(()=>{tt=!1}),g.value.clear(),ge.value=null,Fe()},{deep:!1});let nt=!1;const lt=()=>{nt=!0,Qe(()=>{nt=!1})};let Be;We(A(e,"pattern"),(t,a)=>{if(e.showIrrelevantNodes)if(Be=void 0,t){const{expandedKeys:d,highlightKeySet:b}=Nl(e.data,e.pattern,e.keyField,e.childrenField,E.value);Ae.value=b,lt(),Re(d,ne(d),{node:null,action:"filter"})}else Ae.value=new Set;else if(!t.length)Be!==void 0&&(lt(),Re(Be,ne(Be),{node:null,action:"filter"}));else{a.length||(Be=Z.value);const{expandedKeys:d}=T.value;d!==void 0&&(lt(),Re(d,ne(d),{node:null,action:"filter"}))}});function pt(t){return Tl(this,void 0,void 0,function*(){const{onLoad:a}=e;if(!a){yield Promise.resolve();return}const{value:d}=g;if(!d.has(t.key)){d.add(t.key);try{(yield a(t.rawNode))===!1&&Ce()}catch(b){console.error(b),Ce()}d.delete(t.key)}})}Ie(()=>{var t;const{value:a}=L;if(!a)return;const{getNode:d}=a;(t=Z.value)===null||t===void 0||t.forEach(b=>{const y=d(b);y&&!y.shallowLoaded&&pt(y)})});const Ne=$(!1),pe=$([]);We(P,(t,a)=>{if(!e.animated||nt){Qe(qe);return}if(tt)return;const d=Oe(r.value.self.nodeHeight),b=new Set(a);let y=null,j=null;for(const F of t)if(!b.has(F)){if(y!==null)return;y=F}const ee=new Set(t);for(const F of a)if(!ee.has(F)){if(j!==null)return;j=F}if(y===null&&j===null)return;const{virtualScroll:le}=e,Ke=(le?m.value.listElRef:u.value).offsetHeight,Te=Math.ceil(Ke/d)+1;let ae;if(y!==null&&(ae=a),j!==null&&(ae===void 0?ae=t:ae=ae.filter(F=>F!==j)),Ne.value=!0,pe.value=L.value.getFlattenedNodes(ae),y!==null){const F=pe.value.findIndex(oe=>oe.key===y);if(~F){const oe=pe.value[F].children;if(oe){const se=Lt(oe,t);pe.value.splice(F+1,0,{__motion:!0,mode:"expand",height:le?se.length*d:void 0,nodes:le?se.slice(0,Te):se})}}}if(j!==null){const F=pe.value.findIndex(oe=>oe.key===j);if(~F){const oe=pe.value[F].children;if(!oe)return;Ne.value=!0;const se=Lt(oe,t);pe.value.splice(F+1,0,{__motion:!0,mode:"collapse",height:le?se.length*d:void 0,nodes:le?se.slice(0,Te):se})}}});const Zt=z(()=>jn(X.value)),en=z(()=>Ne.value?pe.value:X.value);function qe(){const{value:t}=f;t&&t.sync()}function tn(){Ne.value=!1,e.virtualScroll&&Qe(qe)}function ne(t){const{getNode:a}=S.value;return t.map(d=>{var b;return((b=a(d))===null||b===void 0?void 0:b.rawNode)||null})}function Re(t,a,d){const{"onUpdate:expandedKeys":b,onUpdateExpandedKeys:y}=e;v.value=t,b&&te(b,t,a,d),y&&te(y,t,a,d)}function yt(t,a,d){const{"onUpdate:checkedKeys":b,onUpdateCheckedKeys:y}=e;c.value=t,y&&te(y,t,a,d),b&&te(b,t,a,d)}function nn(t,a){const{"onUpdate:indeterminateKeys":d,onUpdateIndeterminateKeys:b}=e;d&&te(d,t,a),b&&te(b,t,a)}function at(t,a,d){const{"onUpdate:selectedKeys":b,onUpdateSelectedKeys:y}=e;J.value=t,y&&te(y,t,a,d),b&&te(b,t,a,d)}function ln(t){const{onDragenter:a}=e;a&&te(a,t)}function an(t){const{onDragleave:a}=e;a&&te(a,t)}function on(t){const{onDragend:a}=e;a&&te(a,t)}function rn(t){const{onDragstart:a}=e;a&&te(a,t)}function dn(t){const{onDragover:a}=e;a&&te(a,t)}function sn(t){const{onDrop:a}=e;a&&te(a,t)}function Fe(){cn(),ke()}function cn(){V.value=null}function ke(){Ge.value=0,Q.value=null,Me.value=null,je.value=null,Ce()}function Ce(){de&&(window.clearTimeout(de),de=null),be=null}function ot(t,a){if(e.disabled||ye(t,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple){it(t);return}const d=a?"check":"uncheck",{checkedKeys:b,indeterminateKeys:y}=S.value[d](t.key,q.value,{cascade:e.cascade,checkStrategy:M.value,allowNotLoaded:e.allowCheckingNotLoaded});yt(b,ne(b),{node:t.rawNode,action:d}),nn(y,ne(y))}function un(t){if(e.disabled)return;const{key:a}=t,{value:d}=Z,b=d.findIndex(y=>y===a);if(~b){const y=Array.from(d);y.splice(b,1),Re(y,ne(y),{node:t.rawNode,action:"collapse"})}else{const y=L.value.getNode(a);if(!y||y.isLeaf)return;let j;if(e.accordion){const ee=new Set(t.siblings.map(({key:le})=>le));j=d.filter(le=>!ee.has(le)),j.push(a)}else j=d.concat(a);Re(j,ne(j),{node:t.rawNode,action:"expand"})}}function mt(t){e.disabled||Ne.value||un(t)}function it(t){if(!(e.disabled||!e.selectable)){if(ge.value=t.key,e.internalUnifySelectCheck){const{value:{checkedKeys:a,indeterminateKeys:d}}=N;e.multiple?ot(t,!(a.includes(t.key)||d.includes(t.key))):yt([t.key],ne([t.key]),{node:t.rawNode,action:"check"})}if(e.multiple){const a=Array.from(s.value),d=a.findIndex(b=>b===t.key);~d?e.cancelable&&a.splice(d,1):~d||a.push(t.key),at(a,ne(a),{node:t.rawNode,action:~d?"unselect":"select"})}else s.value.includes(t.key)?e.cancelable&&at([],[],{node:t.rawNode,action:"unselect"}):at([t.key],ne([t.key]),{node:t.rawNode,action:"select"})}}function fn(t){if(de&&(window.clearTimeout(de),de=null),t.isLeaf)return;be=t.key;const a=()=>{if(be!==t.key)return;const{value:d}=Me;if(d&&d.key===t.key&&!Z.value.includes(t.key)){const b=Z.value.concat(t.key);Re(b,ne(b),{node:t.rawNode,action:"expand"})}de=null,be=null};t.shallowLoaded?de=window.setTimeout(()=>{a()},1e3):de=window.setTimeout(()=>{pt(t).then(()=>{a()})},1e3)}function hn({event:t,node:a}){!e.draggable||e.disabled||ye(a,e.disabledField)||(kt({event:t,node:a},!1),ln({event:t,node:a.rawNode}))}function vn({event:t,node:a}){!e.draggable||e.disabled||ye(a,e.disabledField)||an({event:t,node:a.rawNode})}function gn(t){t.target===t.currentTarget&&ke()}function bn({event:t,node:a}){Fe(),!(!e.draggable||e.disabled||ye(a,e.disabledField))&&on({event:t,node:a.rawNode})}function pn({event:t,node:a}){!e.draggable||e.disabled||ye(a,e.disabledField)||(U=t.clientX,V.value=a,rn({event:t,node:a.rawNode}))}function kt({event:t,node:a},d=!0){var b;if(!e.draggable||e.disabled||ye(a,e.disabledField))return;const{value:y}=V;if(!y)return;const{allowDrop:j,indent:ee}=e;d&&dn({event:t,node:a.rawNode});const le=t.currentTarget,{height:Ke,top:Te}=le.getBoundingClientRect(),ae=t.clientY-Te;let F;j({node:a.rawNode,dropPosition:"inside",phase:"drag"})?ae<=8?F="before":ae>=Ke-8?F="after":F="inside":ae<=Ke/2?F="before":F="after";const{value:se}=Zt;let B,W;const Le=se(a.key);if(Le===null){ke();return}let Ve=!1;F==="inside"?(B=a,W="inside"):F==="before"?a.isFirstChild?(B=a,W="before"):(B=X.value[Le-1],W="after"):(B=a,W="after"),!B.isLeaf&&Z.value.includes(B.key)&&(Ve=!0,W==="after"&&(B=X.value[Le+1],B?W="before":(B=a,W="inside")));const xt=B;if(Me.value=xt,!Ve&&y.isLastChild&&y.key===B.key&&(W="after"),W==="after"){let St=U-t.clientX,rt=0;for(;St>=ee/2&&B.parent!==null&&B.isLastChild&&rt<1;)St-=ee,rt+=1,B=B.parent;Ge.value=rt}else Ge.value=0;if((y.contains(B)||W==="inside"&&((b=y.parent)===null||b===void 0?void 0:b.key)===B.key)&&!(y.key===xt.key&&y.key===B.key)){ke();return}if(!j({node:B.rawNode,dropPosition:W,phase:"drag"})){ke();return}if(y.key===B.key)Ce();else if(be!==B.key)if(W==="inside"){if(e.expandOnDragenter){if(fn(B),!B.shallowLoaded&&be!==B.key){Fe();return}}else if(!B.shallowLoaded){Fe();return}}else Ce();else W!=="inside"&&Ce();je.value=W,Q.value=B}function yn({event:t,node:a,dropPosition:d}){if(!e.draggable||e.disabled||ye(a,e.disabledField))return;const{value:b}=V,{value:y}=Q,{value:j}=je;if(!(!b||!y||!j)&&e.allowDrop({node:y.rawNode,dropPosition:j,phase:"drag"})&&b.key!==y.key){if(j==="before"){const ee=b.getNext({includeDisabled:!0});if(ee&&ee.key===y.key){ke();return}}if(j==="after"){const ee=b.getPrev({includeDisabled:!0});if(ee&&ee.key===y.key){ke();return}}sn({event:t,node:y.rawNode,dragNode:b.rawNode,dropPosition:d}),Fe()}}function mn(){qe()}function kn(){qe()}function wn(t){var a;if(e.virtualScroll||e.internalScrollable){const{value:d}=f;if(!((a=d==null?void 0:d.containerRef)===null||a===void 0)&&a.contains(t.relatedTarget))return;ge.value=null}else{const{value:d}=u;if(d!=null&&d.contains(t.relatedTarget))return;ge.value=null}}We(ge,t=>{var a,d;if(t!==null){if(e.virtualScroll)(a=m.value)===null||a===void 0||a.scrollTo({key:t});else if(e.internalScrollable){const{value:b}=f;if(b===null)return;const y=(d=b.contentRef)===null||d===void 0?void 0:d.querySelector(`[data-key="${qt(t)}"]`);if(!y)return;b.scrollTo({el:y})}}}),Mt(ze,{loadingKeysRef:g,highlightKeySetRef:et,displayedCheckedKeysRef:q,displayedIndeterminateKeysRef:Y,mergedSelectedKeysRef:s,mergedExpandedKeysRef:Z,mergedThemeRef:r,mergedCheckStrategyRef:M,nodePropsRef:A(e,"nodeProps"),disabledRef:A(e,"disabled"),checkableRef:A(e,"checkable"),selectableRef:A(e,"selectable"),expandOnClickRef:A(e,"expandOnClick"),onLoadRef:A(e,"onLoad"),draggableRef:A(e,"draggable"),blockLineRef:A(e,"blockLine"),indentRef:A(e,"indent"),cascadeRef:A(e,"cascade"),checkOnClickRef:A(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:Me,droppingNodeParentRef:Jt,draggingNodeRef:V,droppingPositionRef:je,droppingOffsetLevelRef:Ge,fNodesRef:X,pendingNodeKeyRef:ge,showLineRef:A(e,"showLine"),disabledFieldRef:A(e,"disabledField"),internalScrollableRef:A(e,"internalScrollable"),internalCheckboxFocusableRef:A(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:A(e,"renderLabel"),renderPrefixRef:A(e,"renderPrefix"),renderSuffixRef:A(e,"renderSuffix"),renderSwitcherIconRef:A(e,"renderSwitcherIcon"),labelFieldRef:A(e,"labelField"),multipleRef:A(e,"multiple"),overrideDefaultNodeClickBehaviorRef:A(e,"overrideDefaultNodeClickBehavior"),handleSwitcherClick:mt,handleDragEnd:bn,handleDragEnter:hn,handleDragLeave:vn,handleDragStart:pn,handleDrop:yn,handleDragOver:kt,handleSelect:it,handleCheck:ot});function xn(t,a){var d,b;typeof t=="number"?(d=m.value)===null||d===void 0||d.scrollTo(t,a||0):(b=m.value)===null||b===void 0||b.scrollTo(t)}const Sn={handleKeydown:Je,scrollTo:xn,getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:t}=N.value;return{keys:t,options:ne(t)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:t}=N.value;return{keys:t,options:ne(t)}}},wt=z(()=>{const{common:{cubicBezierEaseInOut:t},self:{fontSize:a,nodeBorderRadius:d,nodeColorHover:b,nodeColorPressed:y,nodeColorActive:j,arrowColor:ee,loadingColor:le,nodeTextColor:Ke,nodeTextColorDisabled:Te,dropMarkColor:ae,nodeWrapperPadding:F,nodeHeight:oe,lineHeight:se,lineColor:B}}=r.value,W=st(F,"top"),Le=st(F,"bottom"),Ve=me(Oe(oe)-Oe(W)-Oe(Le));return{"--n-arrow-color":ee,"--n-loading-color":le,"--n-bezier":t,"--n-font-size":a,"--n-node-border-radius":d,"--n-node-color-active":j,"--n-node-color-hover":b,"--n-node-color-pressed":y,"--n-node-text-color":Ke,"--n-node-text-color-disabled":Te,"--n-drop-mark-color":ae,"--n-node-wrapper-padding":F,"--n-line-offset-top":`-${W}`,"--n-line-offset-bottom":`-${Le}`,"--n-node-content-height":Ve,"--n-line-height":se,"--n-line-color":B}}),De=i?Gn("tree",void 0,wt,e):void 0;return Object.assign(Object.assign({},Sn),{mergedClsPrefix:n,mergedTheme:r,rtlEnabled:o,fNodes:en,aip:Ne,selfElRef:u,virtualListInstRef:m,scrollbarInstRef:f,handleFocusout:wn,handleDragLeaveTree:gn,handleScroll:mn,getScrollContainer:h,getScrollContent:C,handleAfterEnter:tn,handleResize:kn,cssVars:i?void 0:wt,themeClass:De==null?void 0:De.themeClass,onRender:De==null?void 0:De.onRender})},render(){var e;const{fNodes:n,internalRenderEmpty:i}=this;if(!n.length&&i)return i();const{mergedClsPrefix:l,blockNode:o,blockLine:r,draggable:u,disabled:f,ellipsis:m,internalFocusable:h,checkable:C,handleKeydown:E,rtlEnabled:T,handleFocusout:L,scrollbarProps:_}=this,S=h&&!f,w=S?"0":void 0,c=[`${l}-tree`,T&&`${l}-tree--rtl`,C&&`${l}-tree--checkable`,(r||o)&&`${l}-tree--block-node`,r&&`${l}-tree--block-line`,m&&`${l}-tree--ellipsis`],p=N=>"__motion"in N?K(Dl,{height:N.height,nodes:N.nodes,clsPrefix:l,mode:N.mode,onAfterEnter:this.handleAfterEnter}):K(Yt,{key:N.key,tmNode:N,clsPrefix:l});if(this.virtualScroll){const{mergedTheme:N,internalScrollablePadding:M}=this,q=st(M||"0");return K(Tt,Object.assign({},_,{ref:"scrollbarInstRef",onDragleave:u?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:c,theme:N.peers.Scrollbar,themeOverrides:N.peerOverrides.Scrollbar,tabindex:w,onKeydown:S?E:void 0,onFocusout:S?L:void 0}),{default:()=>{var Y;return(Y=this.onRender)===null||Y===void 0||Y.call(this),n.length?K(qn,{ref:"virtualListInstRef",items:this.fNodes,itemSize:Oe(N.self.nodeHeight),ignoreItemResize:this.aip,paddingTop:q.top,paddingBottom:q.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:q.left,paddingRight:q.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:J})=>p(J)}):Kt(this.$slots.empty,()=>[K(_t,{class:`${l}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})])}})}const{internalScrollable:I}=this;return c.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),I?K(Tt,Object.assign({},_,{class:c,tabindex:w,onKeydown:S?E:void 0,onFocusout:S?L:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}}),{default:()=>K("div",{onDragleave:u?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(p))}):K("div",{class:c,tabindex:w,ref:"selfElRef",style:this.cssVars,onKeydown:S?E:void 0,onFocusout:S?L:void 0,onDragleave:u?this.handleDragLeaveTree:void 0},n.length?n.map(p):Kt(this.$slots.empty,()=>[K(_t,{class:`${l}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}});function $l(e){return Vn({url:"/system/promptTemplate/list",method:"get",params:{category:e}})}const Pl={class:"page-container"},Al={class:"directory-header"},Bl={class:"create-app-panel"},Fl={class:"content-panel"},Il={class:"knowledge-card-list"},Ol={class:"card-meta"},Ul={class:"card-author"},zl={class:"card-date"},Ml={class:"card-description"},jl={class:"pagination-wrapper"},Gl=fe({__name:"index",setup(e){bt(()=>{M(),c(),p(),Y()});const n=Hn(),i=Xn(),l=$({id:"",kid:"",uid:"",kname:"",share:"0",description:"",knowledgeSeparator:"",questionSeparator:"",overlapChar:50,retrieveLimit:3,textBlockSize:500,vectorModelName:"weaviate",embeddingModelId:"",embeddingModelName:"",promptTemplateId:""});async function o(){h.value=!1,console.log(l.value),(await Dn(l.value)).code==200&&(i.success("添加成功"),await M())}async function r(R){const v=await Kn({kid:R});v.code==200?i.success("删除成功!"):i.error("删除失败!"+v.data.msg),await M()}function u(R,s){n.push({path:"/annex/t",query:{kid:R.id}})}function f(R){l.value.share=R}const m=R=>{h.value=!0,C.value=R},h=$(!1),C=$("right"),E=Et([{label:"weaviate",value:"weaviate"},{label:"milvus",value:"milvus"}]),T=$([]),L=$([]),_=$([]),S=$(null),w=$(!1);async function c(){try{const R=await Nn("vector");T.value=R.rows||[]}catch{i.error("获取模型列表失败")}}async function p(){try{const R=await $l("vector");L.value=R.rows||[]}catch{i.error("获取提示词模板列表失败")}}const I=$([]),N=Et({page:1,pageSize:12,itemCount:0,pageSizes:[12,24,36,48],onUpdatePage:R=>{N.page=R,M()},onUpdatePageSize:R=>{N.pageSize=R,N.page=1,M()}}),M=async()=>{const R=await Rn({WorkspaceID:"personal-d44n9lvrine71nio27bg"});R.code==200&&(I.value=R.rows||[],console.log("Knowledge data:",R),N.itemCount=R.total||0)},q=R=>{const s=T.value.find(v=>v.id===R);l.value.embeddingModelName=s?s.modelName:""};async function Y(){var R,s;try{const v=await Cn({WorkspaceID:"personal-d44n9lvrine71nio27bg"}),he=((R=v==null?void 0:v.Result)==null?void 0:R.Directories)||((s=v==null?void 0:v.data)==null?void 0:s.Directories)||(v==null?void 0:v.Directories)||[],Se=Z=>Z.map(X=>({key:X.ID,label:X.Name||X.EnglishName||X.ID,data:X,children:X.Children?Se(X.Children):[]}));_.value=Se(he)}catch{i.error("获取目录树失败")}}function J(R){S.value=R[0]||null}return(R,s)=>(ct(),$t(Pt,null,[ie("div",Pl,[x(k(el),{"has-sider":"",class:"knowledge-layout"},{default:D(()=>[x(k(Wn),{collapsed:w.value,"collapsed-width":0,width:240,"collapse-mode":"width",bordered:"","show-trigger":"",class:"directory-sider"},{default:D(()=>[ie("div",Al,[s[17]||(s[17]=ie("span",null,"目录",-1)),x(k(Ee),{quaternary:"",size:"small",onClick:s[0]||(s[0]=()=>k(i).info("创建目录功能待实现"))},{default:D(()=>[...s[16]||(s[16]=[ve("+",-1)])]),_:1})]),x(k(El),{data:_.value,"selected-keys":S.value?[S.value]:[],"block-line":"",selectable:"","onUpdate:selectedKeys":J,class:"directory-tree"},null,8,["data","selected-keys"])]),_:1},8,["collapsed"]),x(k(Qn),{class:"content-layout"},{default:D(()=>[ie("div",Bl,[x(k(Ee),{type:"primary",onClick:s[1]||(s[1]=v=>m("right"))},{default:D(()=>[...s[18]||(s[18]=[ve(" 创建知识库 ",-1)])]),_:1})]),ie("div",Fl,[ie("div",Il,[x(k(Ft),{"x-gap":8,"y-gap":8,cols:4,"item-responsive":"",responsive:"screen"},{default:D(()=>[(ct(!0),$t(Pt,null,Yn(I.value,v=>(ct(),Jn(k(re),{key:v.id},{default:D(()=>[x(k(Zn),{title:v.kname,hoverable:"",class:"knowledge-card"},{cover:D(()=>[...s[19]||(s[19]=[])]),action:D(()=>[x(k(At),{justify:"end"},{default:D(()=>[x(k(Ee),{size:"small",onClick:he=>u(v,"action3"),type:"primary",ghost:""},{default:D(()=>[ve($e(R.$t("knowledge.attachment")),1)]),_:1},8,["onClick"]),x(k(Ee),{size:"small",onClick:he=>r(v.kid),type:"error",ghost:""},{default:D(()=>[ve($e(R.$t("knowledge.delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),default:D(()=>[ie("div",Ol,[ie("span",Ul,$e(v.id||"N/A2"),1),s[20]||(s[20]=ve(" - ",-1)),ie("span",zl,$e(v.createTime||"N/A1"),1)]),ie("p",Ml,$e(v.description),1)]),_:2},1032,["title"])]),_:2},1024))),128))]),_:1})]),ie("div",jl,[x(k(ol),{page:N.page,"onUpdate:page":[s[2]||(s[2]=v=>N.page=v),N.onUpdatePage],"item-count":N.itemCount,"page-size":N.pageSize,"onUpdate:pageSize":[s[3]||(s[3]=v=>N.pageSize=v),N.onUpdatePageSize],"page-sizes":N.pageSizes,"show-size-picker":""},null,8,["page","item-count","page-size","page-sizes","onUpdate:page","onUpdate:pageSize"])])])]),_:1})]),_:1})]),x(k(nl),{class:"knowledge-drawer",show:h.value,"onUpdate:show":s[15]||(s[15]=v=>h.value=v),width:800,placement:C.value,"display-directive":"show","mask-closable":!1},{default:D(()=>[x(k(tl),{title:R.$t("knowledge.createKnowledgeBase"),class:"drawer-content",closable:""},{footer:D(()=>[ie("div",null,[x(k(Ee),{onClick:s[14]||(s[14]=v=>h.value=!1),bordered:!0,style:{"margin-right":"10px"}},{default:D(()=>[...s[23]||(s[23]=[ve(" 取消 ",-1)])]),_:1}),x(k(Ee),{onClick:o,bordered:!1,type:"primary"},{default:D(()=>[ve($e(R.$t("knowledge.add")),1)]),_:1})])]),default:D(()=>[x(k(At),{vertical:""},{default:D(()=>[x(k(rl),{ref:"formRef","label-width":100,model:l.value,class:"knowledge-form","label-placement":"left"},{default:D(()=>[x(k(Ft),{cols:24,"x-gap":24,"y-gap":16},{default:D(()=>[x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"知识库名称",required:""},{default:D(()=>[x(k(Ye),{value:l.value.kname,"onUpdate:value":s[4]||(s[4]=v=>l.value.kname=v),placeholder:"请输入知识库名称",clearable:""},null,8,["value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"分隔符"},{default:D(()=>[x(k(Ye),{value:l.value.knowledgeSeparator,"onUpdate:value":s[5]||(s[5]=v=>l.value.knowledgeSeparator=v),placeholder:"请输入知识分隔符",clearable:""},null,8,["value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"检索条数",required:""},{default:D(()=>[x(k(ut),{value:l.value.retrieveLimit,"onUpdate:value":s[6]||(s[6]=v=>l.value.retrieveLimit=v),placeholder:"请输入检索条数",min:1,max:10,class:"full-width"},null,8,["value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"文本块大小",required:""},{default:D(()=>[x(k(ut),{value:l.value.textBlockSize,"onUpdate:value":s[7]||(s[7]=v=>l.value.textBlockSize=v),placeholder:"请输入文本块大小",min:100,max:2e3,class:"full-width"},null,8,["value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"重叠字符"},{default:D(()=>[x(k(ut),{value:l.value.overlapChar,"onUpdate:value":s[8]||(s[8]=v=>l.value.overlapChar=v),placeholder:"请输入重叠字符数",min:0,max:200,class:"full-width"},null,8,["value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"向量库",required:""},{default:D(()=>[x(k(ft),{options:E,value:l.value.vectorModelName,"onUpdate:value":s[9]||(s[9]=v=>l.value.vectorModelName=v),placeholder:"请选择向量库",clearable:""},null,8,["options","value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"提问分割符"},{default:D(()=>[x(k(Ye),{value:l.value.questionSeparator,"onUpdate:value":s[10]||(s[10]=v=>l.value.questionSeparator=v),placeholder:"请输入提问分割符",clearable:""},null,8,["value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"向量模型",required:""},{default:D(()=>[x(k(ft),{options:T.value,value:l.value.embeddingModelId,"onUpdate:value":[s[11]||(s[11]=v=>l.value.embeddingModelId=v),q],"value-field":"id","label-field":"modelName",placeholder:"请选择向量模型",clearable:""},null,8,["options","value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"提示词模板"},{default:D(()=>[x(k(ft),{options:L.value,value:l.value.promptTemplateId,"onUpdate:value":s[12]||(s[12]=v=>l.value.promptTemplateId=v),"value-field":"id","label-field":"templateContent",placeholder:"请选择提示词模板",clearable:""},null,8,["options","value"])]),_:1})]),_:1}),x(k(re),{span:24},{default:D(()=>[x(k(ue),{label:R.$t("knowledge.knowledgeDescription")},{default:D(()=>[x(k(Ye),{maxlength:"1000",type:"textarea",value:l.value.description,"onUpdate:value":s[13]||(s[13]=v=>l.value.description=v),placeholder:R.$t("knowledge.enterKnowledgeDescription"),autosize:{minRows:3,maxRows:5},"show-count":""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),x(k(re),{span:24},{default:D(()=>[x(k(ue),{label:"是否公开","label-placement":"left"},{default:D(()=>[x(k(dl),{size:"large","checked-value":"1","unchecked-value":"0","onUpdate:value":f},{checked:D(()=>[...s[21]||(s[21]=[ve("是",-1)])]),unchecked:D(()=>[...s[22]||(s[22]=[ve("否",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["title"])]),_:1},8,["show","placement"])],64))}});const Zl=ll(Gl,[["__scopeId","data-v-2738c935"]]);export{Zl as default};
