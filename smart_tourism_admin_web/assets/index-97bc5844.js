import{a as Nn,b as Rn,c as Cn,d as Dn,e as Kn}from"./model-a49bb951.js";import{bn as Tn,n as z,r as $,bj as Ln,bo as Ut,d as fe,w as K,bp as gt,bq as we,br as _n,bs as me,h as zt,bt as H,$ as bt,K as Mt,t as B,bu as jt,bv as Nt,bw as En,bx as $n,by as Pn,bz as Rt,bA as dt,bB as An,bC as Bn,bD as Fn,bE as In,bF as He,bG as On,f as j,e as ce,H as G,bH as Ct,I as Le,G as _e,bI as Un,L as zn,k as Gt,bJ as Mn,p as Dt,bK as Ie,j as Xe,a4 as We,bL as jn,bM as st,bN as Oe,q as Gn,bk as Kt,bO as qn,bP as Tt,as as Qe,bQ as Lt,F as Z,bc as _t,b9 as Vn,bR as Hn,a2 as Xn,bS as Et,o as ct,c as $t,a as ie,b as x,ab as D,R as k,X as Pt,bT as Wn,ac as Ee,a5 as ve,bU as Qn,aa as Yn,Q as Jn,bV as Zn,a6 as $e,bW as el,aM as tl,N as Ye,bX as ut,aS as ft,aO as nl,b6 as ll}from"./index-fc2ca07d.js";import{a as al,N as ol}from"./Pagination-078592c4.js";import{g as il}from"./Forward-86f34074.js";import{N as ue}from"./FormItem-9918da75.js";import{N as At}from"./Space-29132ab6.js";import{N as rl}from"./Form-97fa87e1.js";import{N as dl}from"./Switch-3c24006e.js";function sl(e){if(typeof e=="number")return{"":e.toString()};const n={};return e.split(/ +/).forEach(i=>{if(i==="")return;const[l,o]=i.split(":");o===void 0?n[""]=l:n[l]=o}),n}function Pe(e,n){var i;if(e==null)return;const l=sl(e);if(n===void 0)return l[""];if(typeof n=="string")return(i=l[n])!==null&&i!==void 0?i:l[""];if(Array.isArray(n)){for(let o=n.length-1;o>=0;--o){const r=n[o];if(r in l)return l[r]}return l[""]}else{let o,r=-1;return Object.keys(l).forEach(u=>{const f=Number(u);!Number.isNaN(f)&&n>=f&&f>=r&&(r=f,o=l[u])}),o}}const cl={xs:0,s:640,m:1024,l:1280,xl:1536,"2xl":1920};function ul(e){return`(min-width: ${e}px)`}const Ue={};function fl(e=cl){if(!Tn)return z(()=>[]);if(typeof window.matchMedia!="function")return z(()=>[]);const n=$({}),i=Object.keys(e),l=(o,r)=>{o.matches?n.value[r]=!0:n.value[r]=!1};return i.forEach(o=>{const r=e[o];let u,f;Ue[r]===void 0?(u=window.matchMedia(ul(r)),u.addEventListener?u.addEventListener("change",y=>{f.forEach(h=>{h(y,o)})}):u.addListener&&u.addListener(y=>{f.forEach(h=>{h(y,o)})}),f=new Set,Ue[r]={mql:u,cbs:f}):(u=Ue[r].mql,f=Ue[r].cbs),f.add(l),u.matches&&f.forEach(y=>{y(u,o)})}),Ln(()=>{i.forEach(o=>{const{cbs:r}=Ue[e[o]];r.has(l)&&r.delete(l)})}),z(()=>{const{value:o}=n;return i.filter(r=>o[r])})}function qt(e){return typeof e=="string"?`s-${e}`:`n-${e}`}function hl(e){var n;const i=(n=e.dirs)===null||n===void 0?void 0:n.find(({dir:l})=>l===Ut);return!!(i&&i.value===!1)}const vl=fe({name:"Switcher",render(){return K("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},K("path",{d:"M12 8l10 8l-10 8z"}))}}),Bt=1,Vt=gt("n-grid"),Ht=1,gl={span:{type:[Number,String],default:Ht},offset:{type:[Number,String],default:0},suffix:Boolean,privateOffset:Number,privateSpan:Number,privateColStart:Number,privateShow:{type:Boolean,default:!0}},re=fe({__GRID_ITEM__:!0,name:"GridItem",alias:["Gi"],props:gl,setup(){const{isSsrRef:e,xGapRef:n,itemStyleRef:i,overflowRef:l,layoutShiftDisabledRef:o}=we(Vt),r=_n();return{overflow:l,itemStyle:i,layoutShiftDisabled:o,mergedXGap:z(()=>me(n.value||0)),deriveStyle:()=>{e.value;const{privateSpan:u=Ht,privateShow:f=!0,privateColStart:y=void 0,privateOffset:h=0}=r.vnode.props,{value:S}=n,P=me(S||0);return{display:f?"":"none",gridColumn:`${y??`span ${u}`} / span ${u}`,marginLeft:h?`calc((100% - (${u} - 1) * ${P}) / ${u} * ${h} + ${P} * ${h})`:""}}}},render(){var e,n;if(this.layoutShiftDisabled){const{span:i,offset:l,mergedXGap:o}=this;return K("div",{style:{gridColumn:`span ${i} / span ${i}`,marginLeft:l?`calc((100% - (${i} - 1) * ${o}) / ${i} * ${l} + ${o} * ${l})`:""}},this.$slots)}return K("div",{style:[this.itemStyle,this.deriveStyle()]},(n=(e=this.$slots).default)===null||n===void 0?void 0:n.call(e,{overflow:this.overflow}))}}),bl={xs:0,s:640,m:1024,l:1280,xl:1536,xxl:1920},Xt=24,ht="__ssr__",pl={layoutShiftDisabled:Boolean,responsive:{type:[String,Boolean],default:"self"},cols:{type:[Number,String],default:Xt},itemResponsive:Boolean,collapsed:Boolean,collapsedRows:{type:Number,default:1},itemStyle:[Object,String],xGap:{type:[Number,String],default:0},yGap:{type:[Number,String],default:0}},Ft=fe({name:"Grid",inheritAttrs:!1,props:pl,setup(e){const{mergedClsPrefixRef:n,mergedBreakpointsRef:i}=zt(e),l=/^\d+$/,o=$(void 0),r=fl((i==null?void 0:i.value)||bl),u=H(()=>!!(e.itemResponsive||!l.test(e.cols.toString())||!l.test(e.xGap.toString())||!l.test(e.yGap.toString()))),f=z(()=>{if(u.value)return e.responsive==="self"?o.value:r.value}),y=H(()=>{var c;return(c=Number(Pe(e.cols.toString(),f.value)))!==null&&c!==void 0?c:Xt}),h=H(()=>Pe(e.xGap.toString(),f.value)),S=H(()=>Pe(e.yGap.toString(),f.value)),P=c=>{o.value=c.contentRect.width},R=c=>{$n(P,c)},E=$(!1),T=z(()=>{if(e.responsive==="self")return R}),N=$(!1),w=$();return bt(()=>{const{value:c}=w;c&&c.hasAttribute(ht)&&(c.removeAttribute(ht),N.value=!0)}),Mt(Vt,{layoutShiftDisabledRef:B(e,"layoutShiftDisabled"),isSsrRef:N,itemStyleRef:B(e,"itemStyle"),xGapRef:h,overflowRef:E}),{isSsr:!jt,contentEl:w,mergedClsPrefix:n,style:z(()=>e.layoutShiftDisabled?{width:"100%",display:"grid",gridTemplateColumns:`repeat(${e.cols}, minmax(0, 1fr))`,columnGap:me(e.xGap),rowGap:me(e.yGap)}:{width:"100%",display:"grid",gridTemplateColumns:`repeat(${y.value}, minmax(0, 1fr))`,columnGap:me(h.value),rowGap:me(S.value)}),isResponsive:u,responsiveQuery:f,responsiveCols:y,handleResize:T,overflow:E}},render(){if(this.layoutShiftDisabled)return K("div",Nt({ref:"contentEl",class:`${this.mergedClsPrefix}-grid`,style:this.style},this.$attrs),this.$slots);const e=()=>{var n,i,l,o,r,u,f;this.overflow=!1;const y=Pn(il(this)),h=[],{collapsed:S,collapsedRows:P,responsiveCols:R,responsiveQuery:E}=this;y.forEach(m=>{var _,L,O,V,ne;if(((_=m==null?void 0:m.type)===null||_===void 0?void 0:_.__GRID_ITEM__)!==!0)return;if(hl(m)){const s=Rt(m);s.props?s.props.privateShow=!1:s.props={privateShow:!1},h.push({child:s,rawChildSpan:0});return}m.dirs=((L=m.dirs)===null||L===void 0?void 0:L.filter(({dir:s})=>s!==Ut))||null,((O=m.dirs)===null||O===void 0?void 0:O.length)===0&&(m.dirs=null);const le=Rt(m),C=Number((ne=Pe((V=le.props)===null||V===void 0?void 0:V.span,E))!==null&&ne!==void 0?ne:Bt);C!==0&&h.push({child:le,rawChildSpan:C})});let T=0;const N=(n=h[h.length-1])===null||n===void 0?void 0:n.child;if(N!=null&&N.props){const m=(i=N.props)===null||i===void 0?void 0:i.suffix;m!==void 0&&m!==!1&&(T=Number((o=Pe((l=N.props)===null||l===void 0?void 0:l.span,E))!==null&&o!==void 0?o:Bt),N.props.privateSpan=T,N.props.privateColStart=R+1-T,N.props.privateShow=(r=N.props.privateShow)!==null&&r!==void 0?r:!0)}let w=0,c=!1;for(const{child:m,rawChildSpan:_}of h){if(c&&(this.overflow=!0),!c){const L=Number((f=Pe((u=m.props)===null||u===void 0?void 0:u.offset,E))!==null&&f!==void 0?f:0),O=Math.min(_+L,R);if(m.props?(m.props.privateSpan=O,m.props.privateOffset=L):m.props={privateSpan:O,privateOffset:L},S){const V=w%R;O+V>R&&(w+=R-V),O+w+T>P*R?c=!0:w+=O}}c&&(m.props?m.props.privateShow!==!0&&(m.props.privateShow=!1):m.props={privateShow:!1})}return K("div",Nt({ref:"contentEl",class:`${this.mergedClsPrefix}-grid`,style:this.style,[ht]:this.isSsr||void 0},this.$attrs),h.map(({child:m})=>m))};return this.isResponsive&&this.responsive==="self"?K(En,{onResize:this.handleResize},{default:e}):e()}}),Wt=gt("n-tree-select");function It({position:e,offsetLevel:n,indent:i,el:l}){const o={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")o.left=0,o.top=0,o.bottom=0,o.borderRadius="inherit",o.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const r=e==="before"?"top":"bottom";o[r]=0,o.left=`${l.offsetLeft+6-n*i}px`,o.height="2px",o.backgroundColor="var(--n-drop-mark-color)",o.transformOrigin=r,o.borderRadius="1px",o.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return K("div",{style:o})}function yl({dropPosition:e,node:n}){return n.isLeaf===!1||n.children?!0:e!=="inside"}const ze=gt("n-tree");function ml({props:e,fNodesRef:n,mergedExpandedKeysRef:i,mergedSelectedKeysRef:l,mergedCheckedKeysRef:o,handleCheck:r,handleSelect:u,handleSwitcherClick:f}){const{value:y}=l,h=we(Wt,null),S=h?h.pendingNodeKeyRef:$(y.length?y[y.length-1]:null);function P(R){var E;if(!e.keyboard)return{enterBehavior:null};const{value:T}=S;let N=null;if(T===null){if((R.key==="ArrowDown"||R.key==="ArrowUp")&&R.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(R.key)&&T===null){const{value:w}=n;let c=0;for(;c<w.length;){if(!w[c].disabled){S.value=w[c].key;break}c+=1}}}else{const{value:w}=n;let c=w.findIndex(m=>m.key===T);if(!~c)return{enterBehavior:null};if(R.key==="Enter"){const m=w[c];switch(N=((E=e.overrideDefaultNodeClickBehavior)===null||E===void 0?void 0:E.call(e,{option:m.rawNode}))||null,N){case"toggleCheck":r(m,!o.value.includes(m.key));break;case"toggleSelect":u(m);break;case"toggleExpand":f(m);break;case"none":break;case"default":default:N="default",u(m)}}else if(R.key==="ArrowDown")for(R.preventDefault(),c+=1;c<w.length;){if(!w[c].disabled){S.value=w[c].key;break}c+=1}else if(R.key==="ArrowUp")for(R.preventDefault(),c-=1;c>=0;){if(!w[c].disabled){S.value=w[c].key;break}c-=1}else if(R.key==="ArrowLeft"){const m=w[c];if(m.isLeaf||!i.value.includes(T)){const _=m.getParent();_&&(S.value=_.key)}else f(m)}else if(R.key==="ArrowRight"){const m=w[c];if(m.isLeaf)return{enterBehavior:null};if(!i.value.includes(T))f(m);else for(c+=1;c<w.length;){if(!w[c].disabled){S.value=w[c].key;break}c+=1}}}return{enterBehavior:N}}return{pendingNodeKeyRef:S,handleKeydown:P}}const kl=fe({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const n=we(ze);function i(o){const{onCheck:r}=e;r&&r(o)}function l(o){i(o)}return{handleUpdateValue:l,mergedTheme:n.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:n,checked:i,indeterminate:l,disabled:o,focusable:r,indent:u,handleUpdateValue:f}=this;return K("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],style:{width:`${u}px`},"data-checkbox":!0},K(al,{focusable:r,disabled:o,theme:n.peers.Checkbox,themeOverrides:n.peerOverrides.Checkbox,checked:i,indeterminate:l,onUpdateChecked:f}))}}),wl=fe({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:n,renderPrefixRef:i,renderSuffixRef:l,labelFieldRef:o}=we(ze),r=$(null);function u(y){const{onClick:h}=e;h&&h(y)}function f(y){u(y)}return{selfRef:r,renderLabel:n,renderPrefix:i,renderSuffix:l,labelField:o,handleClick:f}},render(){const{clsPrefix:e,labelField:n,nodeProps:i,checked:l=!1,selected:o=!1,renderLabel:r,renderPrefix:u,renderSuffix:f,handleClick:y,onDragstart:h,tmNode:{rawNode:S,rawNode:{prefix:P,suffix:R,[n]:E}}}=this;return K("span",Object.assign({},i,{ref:"selfRef",class:[`${e}-tree-node-content`,i==null?void 0:i.class],onClick:y,draggable:h===void 0?void 0:!0,onDragstart:h}),u||P?K("div",{class:`${e}-tree-node-content__prefix`},u?u({option:S,selected:o,checked:l}):dt(P)):null,K("div",{class:`${e}-tree-node-content__text`},r?r({option:S,selected:o,checked:l}):dt(E)),f||R?K("div",{class:`${e}-tree-node-content__suffix`},f?f({option:S,selected:o,checked:l}):dt(R)):null)}}),xl=fe({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function,tmNode:{type:Object,required:!0}},setup(e){const{renderSwitcherIconRef:n}=we(ze,null);return()=>{const{clsPrefix:i,expanded:l,hide:o,indent:r,onClick:u}=e;return K("span",{"data-switcher":!0,class:[`${i}-tree-node-switcher`,l&&`${i}-tree-node-switcher--expanded`,o&&`${i}-tree-node-switcher--hide`],style:{width:`${r}px`},onClick:u},K("div",{class:`${i}-tree-node-switcher__icon`},K(An,null,{default:()=>{if(e.loading)return K(Bn,{clsPrefix:i,key:"loading",radius:85,strokeWidth:20});const{value:f}=n;return f?f({expanded:e.expanded,selected:e.selected,option:e.tmNode.rawNode}):K(Fn,{clsPrefix:i,key:"switcher"},{default:()=>K(vl,null)})}})))}}});function Sl(e){return z(()=>e.leafOnly?"child":e.checkStrategy)}function ye(e,n){return!!e.rawNode[n]}function Qt(e,n,i,l){e==null||e.forEach(o=>{i(o),Qt(o[n],n,i,l),l(o)})}function Nl(e,n,i,l,o){const r=new Set,u=new Set,f=[];return Qt(e,l,y=>{if(f.push(y),o(n,y)){u.add(y[i]);for(let h=f.length-2;h>=0;--h)if(!r.has(f[h][i]))r.add(f[h][i]);else return}},()=>{f.pop()}),{expandedKeys:Array.from(r),highlightKeySet:u}}if(jt&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function Rl(e,n,i,l,o){const r=new Set,u=new Set,f=new Set,y=[],h=[],S=[];function P(E){E.forEach(T=>{if(S.push(T),n(i,T)){r.add(T[l]),f.add(T[l]);for(let w=S.length-2;w>=0;--w){const c=S[w][l];if(!u.has(c))u.add(c),r.has(c)&&r.delete(c);else break}}const N=T[o];N&&P(N),S.pop()})}P(e);function R(E,T){E.forEach(N=>{const w=N[l],c=r.has(w),m=u.has(w);if(!c&&!m)return;const _=N[o];if(_)if(c)T.push(N);else{y.push(w);const L=Object.assign(Object.assign({},N),{[o]:[]});T.push(L),R(_,L[o])}else T.push(N)})}return R(e,h),{filteredTree:h,highlightKeySet:f,expandedKeys:y}}const Cl=fe({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const n=we(ze),{droppingNodeParentRef:i,droppingMouseNodeRef:l,draggingNodeRef:o,droppingPositionRef:r,droppingOffsetLevelRef:u,nodePropsRef:f,indentRef:y,blockLineRef:h,checkboxPlacementRef:S,checkOnClickRef:P,disabledFieldRef:R,showLineRef:E,renderSwitcherIconRef:T,overrideDefaultNodeClickBehaviorRef:N}=n,w=H(()=>!!e.tmNode.rawNode.checkboxDisabled),c=H(()=>ye(e.tmNode,R.value)),m=H(()=>n.disabledRef.value||c.value),_=z(()=>{const{value:g}=f;if(g)return g({option:e.tmNode.rawNode})}),L=$(null),O={value:null};bt(()=>{O.value=L.value.$el});function V(){const g=()=>{const{tmNode:A}=e;if(!A.isLeaf&&!A.shallowLoaded){if(!n.loadingKeysRef.value.has(A.key))n.loadingKeysRef.value.add(A.key);else return;const{onLoadRef:{value:U}}=n;U&&U(A.rawNode).then(q=>{q!==!1&&n.handleSwitcherClick(A)}).finally(()=>{n.loadingKeysRef.value.delete(A.key)})}else n.handleSwitcherClick(A)};T.value?setTimeout(g,0):g()}const ne=H(()=>!c.value&&n.selectableRef.value&&(n.internalTreeSelect?n.mergedCheckStrategyRef.value!=="child"||n.multipleRef.value&&n.cascadeRef.value||e.tmNode.isLeaf:!0)),le=H(()=>n.checkableRef.value&&(n.cascadeRef.value||n.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),C=H(()=>n.displayedCheckedKeysRef.value.includes(e.tmNode.key)),s=H(()=>{const{value:g}=le;if(!g)return!1;const{value:A}=P,{tmNode:U}=e;return typeof A=="boolean"?!U.disabled&&A:A(e.tmNode.rawNode)});function v(g){const{value:A}=n.expandOnClickRef,{value:U}=ne,{value:q}=s;if(!U&&!A&&!q||He(g,"checkbox")||He(g,"switcher"))return;const{tmNode:Q}=e;U&&n.handleSelect(Q),A&&!Q.isLeaf&&V(),q&&X(!C.value)}function he(g){var A,U;if(!(He(g,"checkbox")||He(g,"switcher"))){if(!m.value){const q=N.value;let Q=!1;if(q)switch(q({option:e.tmNode.rawNode})){case"toggleCheck":Q=!0,X(!C.value);break;case"toggleSelect":Q=!0,n.handleSelect(e.tmNode);break;case"toggleExpand":Q=!0,V(),Q=!0;break;case"none":Q=!0,Q=!0;return}Q||v(g)}(U=(A=_.value)===null||A===void 0?void 0:A.onClick)===null||U===void 0||U.call(A,g)}}function xe(g){h.value||he(g)}function Y(g){h.value&&he(g)}function X(g){n.handleCheck(e.tmNode,g)}function ge(g){n.handleDragStart({event:g,node:e.tmNode})}function Je(g){g.currentTarget===g.target&&n.handleDragEnter({event:g,node:e.tmNode})}function de(g){g.preventDefault(),n.handleDragOver({event:g,node:e.tmNode})}function be(g){n.handleDragEnd({event:g,node:e.tmNode})}function Ae(g){g.currentTarget===g.target&&n.handleDragLeave({event:g,node:e.tmNode})}function Ze(g){g.preventDefault(),r.value!==null&&n.handleDrop({event:g,node:e.tmNode,dropPosition:r.value})}const et=z(()=>{const{clsPrefix:g}=e,{value:A}=y;if(E.value){const U=[];let q=e.tmNode.parent;for(;q;)q.isLastChild?U.push(K("div",{class:`${g}-tree-node-indent`},K("div",{style:{width:`${A}px`}}))):U.push(K("div",{class:[`${g}-tree-node-indent`,`${g}-tree-node-indent--show-line`]},K("div",{style:{width:`${A}px`}}))),q=q.parent;return U.reverse()}else return In(e.tmNode.level,K("div",{class:`${e.clsPrefix}-tree-node-indent`},K("div",{style:{width:`${A}px`}})))});return{showDropMark:H(()=>{const{value:g}=o;if(!g)return;const{value:A}=r;if(!A)return;const{value:U}=l;if(!U)return;const{tmNode:q}=e;return q.key===U.key}),showDropMarkAsParent:H(()=>{const{value:g}=i;if(!g)return!1;const{tmNode:A}=e,{value:U}=r;return U==="before"||U==="after"?g.key===A.key:!1}),pending:H(()=>n.pendingNodeKeyRef.value===e.tmNode.key),loading:H(()=>n.loadingKeysRef.value.has(e.tmNode.key)),highlight:H(()=>{var g;return(g=n.highlightKeySetRef.value)===null||g===void 0?void 0:g.has(e.tmNode.key)}),checked:C,indeterminate:H(()=>n.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:H(()=>n.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:H(()=>n.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:m,checkable:le,mergedCheckOnClick:s,checkboxDisabled:w,selectable:ne,expandOnClick:n.expandOnClickRef,internalScrollable:n.internalScrollableRef,draggable:n.draggableRef,blockLine:h,nodeProps:_,checkboxFocusable:n.internalCheckboxFocusableRef,droppingPosition:r,droppingOffsetLevel:u,indent:y,checkboxPlacement:S,showLine:E,contentInstRef:L,contentElRef:O,indentNodes:et,handleCheck:X,handleDrop:Ze,handleDragStart:ge,handleDragEnter:Je,handleDragOver:de,handleDragEnd:be,handleDragLeave:Ae,handleLineClick:Y,handleContentClick:xe,handleSwitcherClick:V}},render(){const{tmNode:e,clsPrefix:n,checkable:i,expandOnClick:l,selectable:o,selected:r,checked:u,highlight:f,draggable:y,blockLine:h,indent:S,indentNodes:P,disabled:R,pending:E,internalScrollable:T,nodeProps:N,checkboxPlacement:w}=this,c=y&&!R?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,m=T?qt(e.key):void 0,_=w==="right",L=i?K(kl,{indent:S,right:_,focusable:this.checkboxFocusable,disabled:R||this.checkboxDisabled,clsPrefix:n,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return K("div",Object.assign({class:`${n}-tree-node-wrapper`},c),K("div",Object.assign({},h?N:void 0,{class:[`${n}-tree-node`,{[`${n}-tree-node--selected`]:r,[`${n}-tree-node--checkable`]:i,[`${n}-tree-node--highlight`]:f,[`${n}-tree-node--pending`]:E,[`${n}-tree-node--disabled`]:R,[`${n}-tree-node--selectable`]:o,[`${n}-tree-node--clickable`]:o||l||this.mergedCheckOnClick},N==null?void 0:N.class],"data-key":m,draggable:y&&h,onClick:this.handleLineClick,onDragstart:y&&h&&!R?this.handleDragStart:void 0}),P,e.isLeaf&&this.showLine?K("div",{class:[`${n}-tree-node-indent`,`${n}-tree-node-indent--show-line`,e.isLeaf&&`${n}-tree-node-indent--is-leaf`,e.isLastChild&&`${n}-tree-node-indent--last-child`]},K("div",{style:{width:`${S}px`}})):K(xl,{clsPrefix:n,expanded:this.expanded,selected:r,loading:this.loading,hide:e.isLeaf,tmNode:this.tmNode,indent:S,onClick:this.handleSwitcherClick}),_?null:L,K(wl,{ref:"contentInstRef",clsPrefix:n,checked:u,selected:r,onClick:this.handleContentClick,nodeProps:h?void 0:N,onDragstart:y&&!h&&!R?this.handleDragStart:void 0,tmNode:e}),y?this.showDropMark?It({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:S}):this.showDropMarkAsParent?It({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:S}):null:null,_?L:null))}}),Yt=Cl,Dl=fe({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return K(On,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>K("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:me(this.height)}},this.nodes.map(n=>K(Yt,{clsPrefix:e,tmNode:n})))})}}),vt=Un(),Kl=j("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[ce("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),ce(">",[j("tree-node",[ce("&:first-child","margin-top: 0;")])]),j("tree-motion-wrapper",[G("expand",[Ct({duration:"0.2s"})]),G("collapse",[Ct({duration:"0.2s",reverse:!0})])]),j("tree-node-wrapper",`
 box-sizing: border-box;
 padding: var(--n-node-wrapper-padding);
 `),j("tree-node",`
 transform: translate3d(0,0,0);
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[G("highlight",[j("tree-node-content",[Le("text","border-bottom-color: var(--n-node-text-color-disabled);")])]),G("disabled",[j("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),_e("disabled",[G("clickable",[j("tree-node-content",`
 cursor: pointer;
 `)])])]),G("block-node",[j("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),_e("block-line",[j("tree-node",[_e("disabled",[j("tree-node-content",[ce("&:hover","background: var(--n-node-color-hover);")]),G("selectable",[j("tree-node-content",[ce("&:active","background: var(--n-node-color-pressed);")])]),G("pending",[j("tree-node-content",`
 background: var(--n-node-color-hover);
 `)]),G("selected",[j("tree-node-content","background: var(--n-node-color-active);")])]),G("selected",[j("tree-node-content","background: var(--n-node-color-active);")])])]),G("block-line",[j("tree-node",[_e("disabled",[ce("&:hover","background: var(--n-node-color-hover);"),G("pending",`
 background: var(--n-node-color-hover);
 `),G("selectable",[_e("selected",[ce("&:active","background: var(--n-node-color-pressed);")])]),G("selected","background: var(--n-node-color-active);")]),G("selected","background: var(--n-node-color-active);"),G("disabled",`
 cursor: not-allowed;
 `)])]),j("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 `,[G("show-line","position: relative",[ce("&::before",`
 position: absolute;
 left: 50%;
 border-left: 1px solid var(--n-line-color);
 transition: border-color .3s var(--n-bezier);
 transform: translate(-50%);
 content: "";
 top: var(--n-line-offset-top);
 bottom: var(--n-line-offset-bottom);
 `),G("last-child",[ce("&::before",`
 bottom: 50%;
 `)]),G("is-leaf",[ce("&::after",`
 position: absolute;
 content: "";
 left: calc(50% + 0.5px);
 right: 0;
 bottom: 50%;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-line-color);
 `)])]),_e("show-line","height: 0;")]),j("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: var(--n-node-content-height);
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[Le("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[j("icon",[vt]),j("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[vt]),j("base-icon",[vt])]),G("hide","visibility: hidden;"),G("expanded","transform: rotate(90deg);")]),j("tree-node-checkbox",`
 display: inline-flex;
 height: var(--n-node-content-height);
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 `),j("tree-node-content",`
 user-select: none;
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: var(--n-node-content-height);
 box-sizing: border-box;
 line-height: var(--n-line-height);
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[ce("&:last-child","margin-bottom: 0;"),Le("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),Le("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),Le("suffix",`
 display: inline-flex;
 `)]),Le("empty","margin: auto;")]);var Tl=globalThis&&globalThis.__awaiter||function(e,n,i,l){function o(r){return r instanceof i?r:new i(function(u){u(r)})}return new(i||(i=Promise))(function(r,u){function f(S){try{h(l.next(S))}catch(P){u(P)}}function y(S){try{h(l.throw(S))}catch(P){u(P)}}function h(S){S.done?r(S.value):o(S.value).then(f,y)}h((l=l.apply(e,n||[])).next())})};function Ot(e,n,i,l){return{getIsGroup(){return!1},getKey(r){return r[e]},getChildren:l||(r=>r[n]),getDisabled(r){return!!(r[i]||r.checkboxDisabled)}}}const Ll={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array],overrideDefaultNodeClickBehavior:Function},_l=Object.assign(Object.assign(Object.assign(Object.assign({},Gt.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,showLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},scrollbarProps:Object,indent:{type:Number,default:24},allowDrop:{type:Function,default:yl},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),Ll),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),El=fe({name:"Tree",props:_l,slots:Object,setup(e){const{mergedClsPrefixRef:n,inlineThemeDisabled:i,mergedRtlRef:l}=zt(e),o=zn("Tree",l,n),r=Gt("Tree","-tree",Kl,Mn,e,n),u=$(null),f=$(null),y=$(null);function h(){var t;return(t=y.value)===null||t===void 0?void 0:t.listElRef}function S(){var t;return(t=y.value)===null||t===void 0?void 0:t.itemsElRef}const P=z(()=>{const{filter:t}=e;if(t)return t;const{labelField:a}=e;return(d,b)=>{if(!d.length)return!0;const p=b[a];return typeof p=="string"?p.toLowerCase().includes(d.toLowerCase()):!1}}),R=z(()=>{const{pattern:t}=e;return t?!t.length||!P.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:Rl(e.data,P.value,t,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),E=z(()=>Dt(e.showIrrelevantNodes?e.data:R.value.filteredTree,Ot(e.keyField,e.childrenField,e.disabledField,e.getChildren))),T=we(Wt,null),N=e.internalTreeSelect?T.dataTreeMate:z(()=>e.showIrrelevantNodes?E.value:Dt(e.data,Ot(e.keyField,e.childrenField,e.disabledField,e.getChildren))),{watchProps:w}=e,c=$([]);w!=null&&w.includes("defaultCheckedKeys")?Ie(()=>{c.value=e.defaultCheckedKeys}):c.value=e.defaultCheckedKeys;const m=B(e,"checkedKeys"),_=Xe(m,c),L=z(()=>N.value.getCheckedKeys(_.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),O=Sl(e),V=z(()=>L.value.checkedKeys),ne=z(()=>{const{indeterminateKeys:t}=e;return t!==void 0?t:L.value.indeterminateKeys}),le=$([]);w!=null&&w.includes("defaultSelectedKeys")?Ie(()=>{le.value=e.defaultSelectedKeys}):le.value=e.defaultSelectedKeys;const C=B(e,"selectedKeys"),s=Xe(C,le),v=$([]),he=t=>{v.value=e.defaultExpandAll?N.value.getNonLeafKeys():t===void 0?e.defaultExpandedKeys:t};w!=null&&w.includes("defaultExpandedKeys")?Ie(()=>{he(void 0)}):Ie(()=>{he(e.defaultExpandedKeys)});const xe=B(e,"expandedKeys"),Y=Xe(xe,v),X=z(()=>E.value.getFlattenedNodes(Y.value)),{pendingNodeKeyRef:ge,handleKeydown:Je}=ml({props:e,mergedCheckedKeysRef:_,mergedSelectedKeysRef:s,fNodesRef:X,mergedExpandedKeysRef:Y,handleCheck:ot,handleSelect:it,handleSwitcherClick:mt});let de=null,be=null;const Ae=$(new Set),Ze=z(()=>e.internalHighlightKeySet||R.value.highlightKeySet),et=Xe(Ze,Ae),g=$(new Set),A=z(()=>Y.value.filter(t=>!g.value.has(t)));let U=0;const q=$(null),Q=$(null),Me=$(null),je=$(null),Ge=$(0),Jt=z(()=>{const{value:t}=Q;return t?t.parent:null});let tt=!1;We(B(e,"data"),()=>{tt=!0,Qe(()=>{tt=!1}),g.value.clear(),ge.value=null,Fe()},{deep:!1});let nt=!1;const lt=()=>{nt=!0,Qe(()=>{nt=!1})};let Be;We(B(e,"pattern"),(t,a)=>{if(e.showIrrelevantNodes)if(Be=void 0,t){const{expandedKeys:d,highlightKeySet:b}=Nl(e.data,e.pattern,e.keyField,e.childrenField,P.value);Ae.value=b,lt(),Ne(d,ee(d),{node:null,action:"filter"})}else Ae.value=new Set;else if(!t.length)Be!==void 0&&(lt(),Ne(Be,ee(Be),{node:null,action:"filter"}));else{a.length||(Be=Y.value);const{expandedKeys:d}=R.value;d!==void 0&&(lt(),Ne(d,ee(d),{node:null,action:"filter"}))}});function pt(t){return Tl(this,void 0,void 0,function*(){const{onLoad:a}=e;if(!a){yield Promise.resolve();return}const{value:d}=g;if(!d.has(t.key)){d.add(t.key);try{(yield a(t.rawNode))===!1&&Re()}catch(b){console.error(b),Re()}d.delete(t.key)}})}Ie(()=>{var t;const{value:a}=E;if(!a)return;const{getNode:d}=a;(t=Y.value)===null||t===void 0||t.forEach(b=>{const p=d(b);p&&!p.shallowLoaded&&pt(p)})});const Se=$(!1),pe=$([]);We(A,(t,a)=>{if(!e.animated||nt){Qe(qe);return}if(tt)return;const d=Oe(r.value.self.nodeHeight),b=new Set(a);let p=null,M=null;for(const I of t)if(!b.has(I)){if(p!==null)return;p=I}const J=new Set(t);for(const I of a)if(!J.has(I)){if(M!==null)return;M=I}if(p===null&&M===null)return;const{virtualScroll:te}=e,De=(te?y.value.listElRef:u.value).offsetHeight,Ke=Math.ceil(De/d)+1;let ae;if(p!==null&&(ae=a),M!==null&&(ae===void 0?ae=t:ae=ae.filter(I=>I!==M)),Se.value=!0,pe.value=E.value.getFlattenedNodes(ae),p!==null){const I=pe.value.findIndex(oe=>oe.key===p);if(~I){const oe=pe.value[I].children;if(oe){const se=Lt(oe,t);pe.value.splice(I+1,0,{__motion:!0,mode:"expand",height:te?se.length*d:void 0,nodes:te?se.slice(0,Ke):se})}}}if(M!==null){const I=pe.value.findIndex(oe=>oe.key===M);if(~I){const oe=pe.value[I].children;if(!oe)return;Se.value=!0;const se=Lt(oe,t);pe.value.splice(I+1,0,{__motion:!0,mode:"collapse",height:te?se.length*d:void 0,nodes:te?se.slice(0,Ke):se})}}});const Zt=z(()=>jn(X.value)),en=z(()=>Se.value?pe.value:X.value);function qe(){const{value:t}=f;t&&t.sync()}function tn(){Se.value=!1,e.virtualScroll&&Qe(qe)}function ee(t){const{getNode:a}=N.value;return t.map(d=>{var b;return((b=a(d))===null||b===void 0?void 0:b.rawNode)||null})}function Ne(t,a,d){const{"onUpdate:expandedKeys":b,onUpdateExpandedKeys:p}=e;v.value=t,b&&Z(b,t,a,d),p&&Z(p,t,a,d)}function yt(t,a,d){const{"onUpdate:checkedKeys":b,onUpdateCheckedKeys:p}=e;c.value=t,p&&Z(p,t,a,d),b&&Z(b,t,a,d)}function nn(t,a){const{"onUpdate:indeterminateKeys":d,onUpdateIndeterminateKeys:b}=e;d&&Z(d,t,a),b&&Z(b,t,a)}function at(t,a,d){const{"onUpdate:selectedKeys":b,onUpdateSelectedKeys:p}=e;le.value=t,p&&Z(p,t,a,d),b&&Z(b,t,a,d)}function ln(t){const{onDragenter:a}=e;a&&Z(a,t)}function an(t){const{onDragleave:a}=e;a&&Z(a,t)}function on(t){const{onDragend:a}=e;a&&Z(a,t)}function rn(t){const{onDragstart:a}=e;a&&Z(a,t)}function dn(t){const{onDragover:a}=e;a&&Z(a,t)}function sn(t){const{onDrop:a}=e;a&&Z(a,t)}function Fe(){cn(),ke()}function cn(){q.value=null}function ke(){Ge.value=0,Q.value=null,Me.value=null,je.value=null,Re()}function Re(){de&&(window.clearTimeout(de),de=null),be=null}function ot(t,a){if(e.disabled||ye(t,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple){it(t);return}const d=a?"check":"uncheck",{checkedKeys:b,indeterminateKeys:p}=N.value[d](t.key,V.value,{cascade:e.cascade,checkStrategy:O.value,allowNotLoaded:e.allowCheckingNotLoaded});yt(b,ee(b),{node:t.rawNode,action:d}),nn(p,ee(p))}function un(t){if(e.disabled)return;const{key:a}=t,{value:d}=Y,b=d.findIndex(p=>p===a);if(~b){const p=Array.from(d);p.splice(b,1),Ne(p,ee(p),{node:t.rawNode,action:"collapse"})}else{const p=E.value.getNode(a);if(!p||p.isLeaf)return;let M;if(e.accordion){const J=new Set(t.siblings.map(({key:te})=>te));M=d.filter(te=>!J.has(te)),M.push(a)}else M=d.concat(a);Ne(M,ee(M),{node:t.rawNode,action:"expand"})}}function mt(t){e.disabled||Se.value||un(t)}function it(t){if(!(e.disabled||!e.selectable)){if(ge.value=t.key,e.internalUnifySelectCheck){const{value:{checkedKeys:a,indeterminateKeys:d}}=L;e.multiple?ot(t,!(a.includes(t.key)||d.includes(t.key))):yt([t.key],ee([t.key]),{node:t.rawNode,action:"check"})}if(e.multiple){const a=Array.from(s.value),d=a.findIndex(b=>b===t.key);~d?e.cancelable&&a.splice(d,1):~d||a.push(t.key),at(a,ee(a),{node:t.rawNode,action:~d?"unselect":"select"})}else s.value.includes(t.key)?e.cancelable&&at([],[],{node:t.rawNode,action:"unselect"}):at([t.key],ee([t.key]),{node:t.rawNode,action:"select"})}}function fn(t){if(de&&(window.clearTimeout(de),de=null),t.isLeaf)return;be=t.key;const a=()=>{if(be!==t.key)return;const{value:d}=Me;if(d&&d.key===t.key&&!Y.value.includes(t.key)){const b=Y.value.concat(t.key);Ne(b,ee(b),{node:t.rawNode,action:"expand"})}de=null,be=null};t.shallowLoaded?de=window.setTimeout(()=>{a()},1e3):de=window.setTimeout(()=>{pt(t).then(()=>{a()})},1e3)}function hn({event:t,node:a}){!e.draggable||e.disabled||ye(a,e.disabledField)||(kt({event:t,node:a},!1),ln({event:t,node:a.rawNode}))}function vn({event:t,node:a}){!e.draggable||e.disabled||ye(a,e.disabledField)||an({event:t,node:a.rawNode})}function gn(t){t.target===t.currentTarget&&ke()}function bn({event:t,node:a}){Fe(),!(!e.draggable||e.disabled||ye(a,e.disabledField))&&on({event:t,node:a.rawNode})}function pn({event:t,node:a}){!e.draggable||e.disabled||ye(a,e.disabledField)||(U=t.clientX,q.value=a,rn({event:t,node:a.rawNode}))}function kt({event:t,node:a},d=!0){var b;if(!e.draggable||e.disabled||ye(a,e.disabledField))return;const{value:p}=q;if(!p)return;const{allowDrop:M,indent:J}=e;d&&dn({event:t,node:a.rawNode});const te=t.currentTarget,{height:De,top:Ke}=te.getBoundingClientRect(),ae=t.clientY-Ke;let I;M({node:a.rawNode,dropPosition:"inside",phase:"drag"})?ae<=8?I="before":ae>=De-8?I="after":I="inside":ae<=De/2?I="before":I="after";const{value:se}=Zt;let F,W;const Te=se(a.key);if(Te===null){ke();return}let Ve=!1;I==="inside"?(F=a,W="inside"):I==="before"?a.isFirstChild?(F=a,W="before"):(F=X.value[Te-1],W="after"):(F=a,W="after"),!F.isLeaf&&Y.value.includes(F.key)&&(Ve=!0,W==="after"&&(F=X.value[Te+1],F?W="before":(F=a,W="inside")));const xt=F;if(Me.value=xt,!Ve&&p.isLastChild&&p.key===F.key&&(W="after"),W==="after"){let St=U-t.clientX,rt=0;for(;St>=J/2&&F.parent!==null&&F.isLastChild&&rt<1;)St-=J,rt+=1,F=F.parent;Ge.value=rt}else Ge.value=0;if((p.contains(F)||W==="inside"&&((b=p.parent)===null||b===void 0?void 0:b.key)===F.key)&&!(p.key===xt.key&&p.key===F.key)){ke();return}if(!M({node:F.rawNode,dropPosition:W,phase:"drag"})){ke();return}if(p.key===F.key)Re();else if(be!==F.key)if(W==="inside"){if(e.expandOnDragenter){if(fn(F),!F.shallowLoaded&&be!==F.key){Fe();return}}else if(!F.shallowLoaded){Fe();return}}else Re();else W!=="inside"&&Re();je.value=W,Q.value=F}function yn({event:t,node:a,dropPosition:d}){if(!e.draggable||e.disabled||ye(a,e.disabledField))return;const{value:b}=q,{value:p}=Q,{value:M}=je;if(!(!b||!p||!M)&&e.allowDrop({node:p.rawNode,dropPosition:M,phase:"drag"})&&b.key!==p.key){if(M==="before"){const J=b.getNext({includeDisabled:!0});if(J&&J.key===p.key){ke();return}}if(M==="after"){const J=b.getPrev({includeDisabled:!0});if(J&&J.key===p.key){ke();return}}sn({event:t,node:p.rawNode,dragNode:b.rawNode,dropPosition:d}),Fe()}}function mn(){qe()}function kn(){qe()}function wn(t){var a;if(e.virtualScroll||e.internalScrollable){const{value:d}=f;if(!((a=d==null?void 0:d.containerRef)===null||a===void 0)&&a.contains(t.relatedTarget))return;ge.value=null}else{const{value:d}=u;if(d!=null&&d.contains(t.relatedTarget))return;ge.value=null}}We(ge,t=>{var a,d;if(t!==null){if(e.virtualScroll)(a=y.value)===null||a===void 0||a.scrollTo({key:t});else if(e.internalScrollable){const{value:b}=f;if(b===null)return;const p=(d=b.contentRef)===null||d===void 0?void 0:d.querySelector(`[data-key="${qt(t)}"]`);if(!p)return;b.scrollTo({el:p})}}}),Mt(ze,{loadingKeysRef:g,highlightKeySetRef:et,displayedCheckedKeysRef:V,displayedIndeterminateKeysRef:ne,mergedSelectedKeysRef:s,mergedExpandedKeysRef:Y,mergedThemeRef:r,mergedCheckStrategyRef:O,nodePropsRef:B(e,"nodeProps"),disabledRef:B(e,"disabled"),checkableRef:B(e,"checkable"),selectableRef:B(e,"selectable"),expandOnClickRef:B(e,"expandOnClick"),onLoadRef:B(e,"onLoad"),draggableRef:B(e,"draggable"),blockLineRef:B(e,"blockLine"),indentRef:B(e,"indent"),cascadeRef:B(e,"cascade"),checkOnClickRef:B(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:Me,droppingNodeParentRef:Jt,draggingNodeRef:q,droppingPositionRef:je,droppingOffsetLevelRef:Ge,fNodesRef:X,pendingNodeKeyRef:ge,showLineRef:B(e,"showLine"),disabledFieldRef:B(e,"disabledField"),internalScrollableRef:B(e,"internalScrollable"),internalCheckboxFocusableRef:B(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:B(e,"renderLabel"),renderPrefixRef:B(e,"renderPrefix"),renderSuffixRef:B(e,"renderSuffix"),renderSwitcherIconRef:B(e,"renderSwitcherIcon"),labelFieldRef:B(e,"labelField"),multipleRef:B(e,"multiple"),overrideDefaultNodeClickBehaviorRef:B(e,"overrideDefaultNodeClickBehavior"),handleSwitcherClick:mt,handleDragEnd:bn,handleDragEnter:hn,handleDragLeave:vn,handleDragStart:pn,handleDrop:yn,handleDragOver:kt,handleSelect:it,handleCheck:ot});function xn(t,a){var d,b;typeof t=="number"?(d=y.value)===null||d===void 0||d.scrollTo(t,a||0):(b=y.value)===null||b===void 0||b.scrollTo(t)}const Sn={handleKeydown:Je,scrollTo:xn,getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:t}=L.value;return{keys:t,options:ee(t)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:t}=L.value;return{keys:t,options:ee(t)}}},wt=z(()=>{const{common:{cubicBezierEaseInOut:t},self:{fontSize:a,nodeBorderRadius:d,nodeColorHover:b,nodeColorPressed:p,nodeColorActive:M,arrowColor:J,loadingColor:te,nodeTextColor:De,nodeTextColorDisabled:Ke,dropMarkColor:ae,nodeWrapperPadding:I,nodeHeight:oe,lineHeight:se,lineColor:F}}=r.value,W=st(I,"top"),Te=st(I,"bottom"),Ve=me(Oe(oe)-Oe(W)-Oe(Te));return{"--n-arrow-color":J,"--n-loading-color":te,"--n-bezier":t,"--n-font-size":a,"--n-node-border-radius":d,"--n-node-color-active":M,"--n-node-color-hover":b,"--n-node-color-pressed":p,"--n-node-text-color":De,"--n-node-text-color-disabled":Ke,"--n-drop-mark-color":ae,"--n-node-wrapper-padding":I,"--n-line-offset-top":`-${W}`,"--n-line-offset-bottom":`-${Te}`,"--n-node-content-height":Ve,"--n-line-height":se,"--n-line-color":F}}),Ce=i?Gn("tree",void 0,wt,e):void 0;return Object.assign(Object.assign({},Sn),{mergedClsPrefix:n,mergedTheme:r,rtlEnabled:o,fNodes:en,aip:Se,selfElRef:u,virtualListInstRef:y,scrollbarInstRef:f,handleFocusout:wn,handleDragLeaveTree:gn,handleScroll:mn,getScrollContainer:h,getScrollContent:S,handleAfterEnter:tn,handleResize:kn,cssVars:i?void 0:wt,themeClass:Ce==null?void 0:Ce.themeClass,onRender:Ce==null?void 0:Ce.onRender})},render(){var e;const{fNodes:n,internalRenderEmpty:i}=this;if(!n.length&&i)return i();const{mergedClsPrefix:l,blockNode:o,blockLine:r,draggable:u,disabled:f,internalFocusable:y,checkable:h,handleKeydown:S,rtlEnabled:P,handleFocusout:R,scrollbarProps:E}=this,T=y&&!f,N=T?"0":void 0,w=[`${l}-tree`,P&&`${l}-tree--rtl`,h&&`${l}-tree--checkable`,(r||o)&&`${l}-tree--block-node`,r&&`${l}-tree--block-line`],c=_=>"__motion"in _?K(Dl,{height:_.height,nodes:_.nodes,clsPrefix:l,mode:_.mode,onAfterEnter:this.handleAfterEnter}):K(Yt,{key:_.key,tmNode:_,clsPrefix:l});if(this.virtualScroll){const{mergedTheme:_,internalScrollablePadding:L}=this,O=st(L||"0");return K(Tt,Object.assign({},E,{ref:"scrollbarInstRef",onDragleave:u?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:w,theme:_.peers.Scrollbar,themeOverrides:_.peerOverrides.Scrollbar,tabindex:N,onKeydown:T?S:void 0,onFocusout:T?R:void 0}),{default:()=>{var V;return(V=this.onRender)===null||V===void 0||V.call(this),n.length?K(qn,{ref:"virtualListInstRef",items:this.fNodes,itemSize:Oe(_.self.nodeHeight),ignoreItemResize:this.aip,paddingTop:O.top,paddingBottom:O.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:O.left,paddingRight:O.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:ne})=>c(ne)}):Kt(this.$slots.empty,()=>[K(_t,{class:`${l}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})])}})}const{internalScrollable:m}=this;return w.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),m?K(Tt,Object.assign({},E,{class:w,tabindex:N,onKeydown:T?S:void 0,onFocusout:T?R:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}}),{default:()=>K("div",{onDragleave:u?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(c))}):K("div",{class:w,tabindex:N,ref:"selfElRef",style:this.cssVars,onKeydown:T?S:void 0,onFocusout:T?R:void 0,onDragleave:u?this.handleDragLeaveTree:void 0},n.length?n.map(c):Kt(this.$slots.empty,()=>[K(_t,{class:`${l}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}});function $l(e){return Vn({url:"/system/promptTemplate/list",method:"get",params:{category:e}})}const Pl={class:"page-container"},Al={class:"directory-header"},Bl={class:"create-app-panel"},Fl={class:"content-panel"},Il={class:"knowledge-card-list"},Ol={class:"card-meta"},Ul={class:"card-author"},zl={class:"card-date"},Ml={class:"card-description"},jl={class:"pagination-wrapper"},Gl=fe({__name:"index",setup(e){bt(()=>{O(),c(),m(),ne()});const n=Hn(),i=Xn(),l=$({id:"",kid:"",uid:"",kname:"",share:"0",description:"",knowledgeSeparator:"",questionSeparator:"",overlapChar:50,retrieveLimit:3,textBlockSize:500,vectorModelName:"weaviate",embeddingModelId:"",embeddingModelName:"",promptTemplateId:""});async function o(){h.value=!1,console.log(l.value),(await Dn(l.value)).code==200&&(i.success("添加成功"),await O())}async function r(C){const v=await Kn({kid:C});v.code==200?i.success("删除成功!"):i.error("删除失败!"+v.data.msg),await O()}function u(C,s){n.push({path:"/annex/t",query:{kid:C.id}})}function f(C){l.value.share=C}const y=C=>{h.value=!0,S.value=C},h=$(!1),S=$("right"),P=Et([{label:"weaviate",value:"weaviate"},{label:"milvus",value:"milvus"}]),R=$([]),E=$([]),T=$([]),N=$(null),w=$(!1);async function c(){try{const C=await Nn("vector");R.value=C.rows||[]}catch{i.error("获取模型列表失败")}}async function m(){try{const C=await $l("vector");E.value=C.rows||[]}catch{i.error("获取提示词模板列表失败")}}const _=$([]),L=Et({page:1,pageSize:12,itemCount:0,pageSizes:[12,24,36,48],onUpdatePage:C=>{L.page=C,O()},onUpdatePageSize:C=>{L.pageSize=C,L.page=1,O()}}),O=async()=>{const C=await Rn({WorkspaceID:"personal-d44n9lvrine71nio27bg"});C.code==200&&(_.value=C.rows||[],console.log("Knowledge data:",C),L.itemCount=C.total||0)},V=C=>{const s=R.value.find(v=>v.id===C);l.value.embeddingModelName=s?s.modelName:""};async function ne(){var C,s;try{const v=await Cn({WorkspaceID:"personal-d44n9lvrine71nio27bg"}),he=((C=v==null?void 0:v.Result)==null?void 0:C.Directories)||((s=v==null?void 0:v.data)==null?void 0:s.Directories)||(v==null?void 0:v.Directories)||[],xe=Y=>Y.map(X=>({key:X.ID,label:X.Name||X.EnglishName||X.ID,data:X,children:X.Children?xe(X.Children):[]}));T.value=xe(he)}catch{i.error("获取目录树失败")}}function le(C){N.value=C[0]||null}return(C,s)=>(ct(),$t(Pt,null,[ie("div",Pl,[x(k(el),{"has-sider":"",class:"knowledge-layout"},{default:D(()=>[x(k(Wn),{collapsed:w.value,"collapsed-width":0,width:240,"collapse-mode":"width",bordered:"","show-trigger":"",class:"directory-sider"},{default:D(()=>[ie("div",Al,[s[17]||(s[17]=ie("span",null,"目录",-1)),x(k(Ee),{quaternary:"",size:"small",onClick:s[0]||(s[0]=()=>k(i).info("创建目录功能待实现"))},{default:D(()=>s[16]||(s[16]=[ve("+")])),_:1})]),x(k(El),{data:T.value,"selected-keys":N.value?[N.value]:[],"block-line":"",selectable:"","onUpdate:selectedKeys":le,class:"directory-tree"},null,8,["data","selected-keys"])]),_:1},8,["collapsed"]),x(k(Qn),{class:"content-layout"},{default:D(()=>[ie("div",Bl,[x(k(Ee),{type:"primary",onClick:s[1]||(s[1]=v=>y("right"))},{default:D(()=>s[18]||(s[18]=[ve(" 创建知识库 ")])),_:1})]),ie("div",Fl,[ie("div",Il,[x(k(Ft),{"x-gap":8,"y-gap":8,cols:4,"item-responsive":"",responsive:"screen"},{default:D(()=>[(ct(!0),$t(Pt,null,Yn(_.value,v=>(ct(),Jn(k(re),{key:v.id},{default:D(()=>[x(k(Zn),{title:v.kname,hoverable:"",class:"knowledge-card"},{cover:D(()=>s[19]||(s[19]=[])),action:D(()=>[x(k(At),{justify:"end"},{default:D(()=>[x(k(Ee),{size:"small",onClick:he=>u(v,"action3"),type:"primary",ghost:""},{default:D(()=>[ve($e(C.$t("knowledge.attachment")),1)]),_:2},1032,["onClick"]),x(k(Ee),{size:"small",onClick:he=>r(v.kid),type:"error",ghost:""},{default:D(()=>[ve($e(C.$t("knowledge.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:D(()=>[ie("div",Ol,[ie("span",Ul,$e(v.id||"N/A2"),1),s[20]||(s[20]=ve(" - ")),ie("span",zl,$e(v.createTime||"N/A1"),1)]),ie("p",Ml,$e(v.description),1)]),_:2},1032,["title"])]),_:2},1024))),128))]),_:1})]),ie("div",jl,[x(k(ol),{page:L.page,"onUpdate:page":[s[2]||(s[2]=v=>L.page=v),L.onUpdatePage],"item-count":L.itemCount,"page-size":L.pageSize,"onUpdate:pageSize":[s[3]||(s[3]=v=>L.pageSize=v),L.onUpdatePageSize],"page-sizes":L.pageSizes,"show-size-picker":""},null,8,["page","item-count","page-size","page-sizes","onUpdate:page","onUpdate:pageSize"])])])]),_:1})]),_:1})]),x(k(nl),{class:"knowledge-drawer",show:h.value,"onUpdate:show":s[15]||(s[15]=v=>h.value=v),width:800,placement:S.value,"display-directive":"show","mask-closable":!1},{default:D(()=>[x(k(tl),{title:C.$t("knowledge.createKnowledgeBase"),class:"drawer-content",closable:""},{footer:D(()=>[ie("div",null,[x(k(Ee),{onClick:s[14]||(s[14]=v=>h.value=!1),bordered:!0,style:{"margin-right":"10px"}},{default:D(()=>s[23]||(s[23]=[ve(" 取消 ")])),_:1}),x(k(Ee),{onClick:o,bordered:!1,type:"primary"},{default:D(()=>[ve($e(C.$t("knowledge.add")),1)]),_:1})])]),default:D(()=>[x(k(At),{vertical:""},{default:D(()=>[x(k(rl),{ref:"formRef","label-width":100,model:l.value,class:"knowledge-form","label-placement":"left"},{default:D(()=>[x(k(Ft),{cols:24,"x-gap":24,"y-gap":16},{default:D(()=>[x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"知识库名称",required:""},{default:D(()=>[x(k(Ye),{value:l.value.kname,"onUpdate:value":s[4]||(s[4]=v=>l.value.kname=v),placeholder:"请输入知识库名称",clearable:""},null,8,["value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"分隔符"},{default:D(()=>[x(k(Ye),{value:l.value.knowledgeSeparator,"onUpdate:value":s[5]||(s[5]=v=>l.value.knowledgeSeparator=v),placeholder:"请输入知识分隔符",clearable:""},null,8,["value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"检索条数",required:""},{default:D(()=>[x(k(ut),{value:l.value.retrieveLimit,"onUpdate:value":s[6]||(s[6]=v=>l.value.retrieveLimit=v),placeholder:"请输入检索条数",min:1,max:10,class:"full-width"},null,8,["value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"文本块大小",required:""},{default:D(()=>[x(k(ut),{value:l.value.textBlockSize,"onUpdate:value":s[7]||(s[7]=v=>l.value.textBlockSize=v),placeholder:"请输入文本块大小",min:100,max:2e3,class:"full-width"},null,8,["value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"重叠字符"},{default:D(()=>[x(k(ut),{value:l.value.overlapChar,"onUpdate:value":s[8]||(s[8]=v=>l.value.overlapChar=v),placeholder:"请输入重叠字符数",min:0,max:200,class:"full-width"},null,8,["value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"向量库",required:""},{default:D(()=>[x(k(ft),{options:P,value:l.value.vectorModelName,"onUpdate:value":s[9]||(s[9]=v=>l.value.vectorModelName=v),placeholder:"请选择向量库",clearable:""},null,8,["options","value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"提问分割符"},{default:D(()=>[x(k(Ye),{value:l.value.questionSeparator,"onUpdate:value":s[10]||(s[10]=v=>l.value.questionSeparator=v),placeholder:"请输入提问分割符",clearable:""},null,8,["value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"向量模型",required:""},{default:D(()=>[x(k(ft),{options:R.value,value:l.value.embeddingModelId,"onUpdate:value":[s[11]||(s[11]=v=>l.value.embeddingModelId=v),V],"value-field":"id","label-field":"modelName",placeholder:"请选择向量模型",clearable:""},null,8,["options","value"])]),_:1})]),_:1}),x(k(re),{span:12},{default:D(()=>[x(k(ue),{label:"提示词模板"},{default:D(()=>[x(k(ft),{options:E.value,value:l.value.promptTemplateId,"onUpdate:value":s[12]||(s[12]=v=>l.value.promptTemplateId=v),"value-field":"id","label-field":"templateContent",placeholder:"请选择提示词模板",clearable:""},null,8,["options","value"])]),_:1})]),_:1}),x(k(re),{span:24},{default:D(()=>[x(k(ue),{label:C.$t("knowledge.knowledgeDescription")},{default:D(()=>[x(k(Ye),{maxlength:"1000",type:"textarea",value:l.value.description,"onUpdate:value":s[13]||(s[13]=v=>l.value.description=v),placeholder:C.$t("knowledge.enterKnowledgeDescription"),autosize:{minRows:3,maxRows:5},"show-count":""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),x(k(re),{span:24},{default:D(()=>[x(k(ue),{label:"是否公开","label-placement":"left"},{default:D(()=>[x(k(dl),{size:"large","checked-value":"1","unchecked-value":"0","onUpdate:value":f},{checked:D(()=>s[21]||(s[21]=[ve("是")])),unchecked:D(()=>s[22]||(s[22]=[ve("否")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["title"])]),_:1},8,["show","placement"])],64))}});const Zl=ll(Gl,[["__scopeId","data-v-2738c935"]]);export{Zl as default};
