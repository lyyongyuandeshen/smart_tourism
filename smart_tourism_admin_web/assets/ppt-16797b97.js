import{b6 as a,b7 as i,a2 as d,$ as u,o as f,c as _}from"./index-5805bd08.js";function y(){return a({url:"/system/model/getPPT",method:"get"})}function g(){return a({url:"/ppt/successCallback",method:"post"})}const b={id:"ppt-container"},k="/docmee-ui-sdk-iframe.min.js",P={__name:"ppt",setup(m){const s=d();let r="";async function l(){const t=await y();t.code==200?(r=t.data.apiKey,p()):s.error("获取API Token失败")}u(()=>{l()});function p(){const t=document.createElement("script");t.src=k,t.onload=()=>{if(window.DocmeeUI){const c=new window.DocmeeUI({pptId:null,token:r,container:document.querySelector("#ppt-container"),page:"creator",lang:"zh",mode:"light",isMobile:!1,background:"linear-gradient(-157deg,#f57bb0, #867dea)",padding:"40px 20px 0px",async onMessage(e){if(console.log("监听事件",e),e.type==="invalid-token")console.log("token 认证错误");else if(e.type==="beforeGenerate"){const{subtype:n,fields:o}=e.data;if(n==="outline")return console.log("即将生成ppt大纲",o),!0;if(n==="ppt")return console.log("即将生成ppt",o),(await g()).code==200?(c.sendMessage({type:"success",content:"继续生成PPT"}),!0):(e.error("生成PPT失败"),!1)}else if(e.type==="beforeCreateCustomTemplate"){const{file:n,totalPptCount:o}=e.data;return console.log("用户自定义完整模版，PPT文件：",n.name),o<2?(console.log("用户积分不足，不允许制作自定义完整模版"),!1):!0}else if(e.type=="pageChange")pageChange(e.data.page);else if(e.type==="beforeDownload"){const{id:n,subject:o}=e.data;return`PPT_${o}.pptx`}else e.type=="error"&&(e.data.code==88?alert("您的次数已用完"):alert("发生错误："+e.data.message))}})}else console.error("DocmeeUI SDK未加载")},document.body.appendChild(t)}return(t,c)=>(f(),_("div",b))}},w=i(P,[["__scopeId","data-v-34d10156"]]);export{w as default};
