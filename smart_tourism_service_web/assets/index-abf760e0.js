import{M as Mt}from"./MapContainer-44c1aed2.js";import{V as D,aQ as Nt,d as re,aR as Tt,a5 as U,r as p,n as _t,aa as v,af as Fe,aS as Pt,aT as Oe,c as k,aU as me,as as Ft,aV as We,aW as Ot,aX as Lt,aY as ze,ao as be,aZ as Kt,a_ as Bt,a$ as It,aI as tt,b0 as nt,ad as at,aq as Vt,b1 as zt,T as $t,b2 as lt,b3 as At,b4 as Et,U as ge,Y as Ze,X as Ne,W as X,a1 as jt,a2 as ot,b5 as Dt,b6 as Ut,a6 as Ge,a4 as Ht,a9 as Pe,b7 as qt,j as $e,b8 as Wt,a8 as Zt,b9 as Gt,a7 as Xt,ab as Yt,ac as Qt,ba as Jt,ae as Xe,bb as en,z as tn,bc as nn,bd as an,ag as oe,s as ln,l as on,o as Te,b as Ve,g as j,e as Y,a as Q,R as rn,w as sn,x as Ye,v as Qe,t as un,aw as Je,F as dn,q as cn,M as pe,D as fn}from"./index-1b86b595.js";import{C as vn}from"./index-ab3e4e84.js";import{N as hn}from"./Checkbox-ccfd1bf9.js";const mn=D("base-menu-mask",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 display: flex;
 align-items: center;
 justify-content: center;
 text-align: center;
 padding: 14px;
 overflow: hidden;
`,[Nt()]),gn=re({name:"BaseMenuMask",props:{clsPrefix:{type:String,required:!0}},setup(t){Tt("-base-menu-mask",mn,U(t,"clsPrefix"));const r=p(null);let l=null;const o=p(!1);return _t(()=>{l!==null&&window.clearTimeout(l)}),Object.assign({message:r,show:o},{showOnce(b,y=1500){l&&window.clearTimeout(l),o.value=!0,r.value=b,l=window.setTimeout(()=>{o.value=!1,r.value=null},y)}})},render(){return v(Fe,{name:"fade-in-transition"},{default:()=>this.show?v("div",{class:`${this.clsPrefix}-base-menu-mask`},this.message):null})}}),ye=Pt("n-cascader"),et=re({name:"NCascaderOption",props:{tmNode:{type:Object,required:!0}},setup(t){const{expandTriggerRef:r,remoteRef:l,multipleRef:o,mergedValueRef:f,checkedKeysRef:b,indeterminateKeysRef:y,hoverKeyPathRef:g,keyboardKeyRef:w,loadingKeySetRef:O,cascadeRef:C,mergedCheckStrategyRef:K,onLoadRef:z,mergedClsPrefixRef:P,mergedThemeRef:E,labelFieldRef:B,showCheckboxRef:W,renderPrefixRef:x,renderSuffixRef:S,updateHoverKey:F,updateKeyboardKey:_,addLoadingKey:I,deleteLoadingKey:H,closeMenu:J,doCheck:c,doUncheck:i,renderLabelRef:n}=Oe(ye),R=k(()=>t.tmNode.key),T=k(()=>{const{value:L}=r,{value:G}=l;return!G&&L==="hover"}),$=k(()=>{if(T.value)return de}),ee=k(()=>{if(T.value)return we}),q=me(()=>{const{value:L}=o;return L?b.value.includes(R.value):f.value===R.value}),ie=me(()=>o.value?y.value.includes(R.value):!1),Le=me(()=>g.value.includes(R.value)),Ke=me(()=>{const{value:L}=w;return L===null?!1:L===R.value}),te=me(()=>l.value?O.value.has(R.value):!1),se=k(()=>t.tmNode.isLeaf),ue=k(()=>t.tmNode.disabled),Z=k(()=>t.tmNode.rawNode[B.value]),ne=k(()=>t.tmNode.shallowLoaded);function ae(L){if(ue.value)return;const{value:G}=l,{value:A}=O,{value:xe}=z,{value:V}=R,{value:Re}=se,{value:Ce}=ne;ze(L,"checkbox")||(G&&!Ce&&!A.has(V)&&xe&&(I(V),xe(t.tmNode.rawNode).then(()=>{H(V)}).catch(()=>{H(V)})),F(V),_(V)),Re&&ke()}function de(){if(!T.value||ue.value)return;const{value:L}=R;F(L),_(L)}function we(){T.value&&de()}function ve(){const{value:L}=se;L||ke()}function ke(){const{value:L}=o,{value:G}=R;L?ie.value||q.value?i(G):c(G):(c(G),J(!0))}return{checkStrategy:K,multiple:o,cascade:C,checked:q,indeterminate:ie,hoverPending:Le,keyboardPending:Ke,isLoading:te,showCheckbox:W,isLeaf:se,disabled:ue,label:Z,mergedClsPrefix:P,mergedTheme:E,handleClick:ae,handleCheckboxUpdateValue:ve,mergedHandleMouseEnter:$,mergedHandleMouseMove:ee,renderLabel:n,renderPrefix:x,renderSuffix:S}},render(){const{mergedClsPrefix:t,showCheckbox:r,renderLabel:l,renderPrefix:o,renderSuffix:f}=this;let b=null;if(r||o){const w=this.showCheckbox?v(hn,{focusable:!1,"data-checkbox":!0,disabled:this.disabled,checked:this.checked,indeterminate:this.indeterminate,theme:this.mergedTheme.peers.Checkbox,themeOverrides:this.mergedTheme.peerOverrides.Checkbox,onUpdateChecked:this.handleCheckboxUpdateValue}):null;b=v("div",{class:`${t}-cascader-option__prefix`},o?o({option:this.tmNode.rawNode,checked:this.checked,node:w}):w)}let y=null;const g=v("div",{class:`${t}-cascader-option-icon-placeholder`},this.isLeaf?this.checkStrategy==="child"&&!(this.multiple&&this.cascade)?v(Fe,{name:"fade-in-scale-up-transition"},{default:()=>this.checked?v(We,{clsPrefix:t,class:`${t}-cascader-option-icon ${t}-cascader-option-icon--checkmark`},{default:()=>v(Lt,null)}):null}):null:v(Ft,{clsPrefix:t,scale:.85,strokeWidth:24,show:this.isLoading,class:`${t}-cascader-option-icon`},{default:()=>v(We,{clsPrefix:t,key:"arrow",class:`${t}-cascader-option-icon ${t}-cascader-option-icon--arrow`},{default:()=>v(Ot,null)})}));return y=v("div",{class:`${t}-cascader-option__suffix`},f?f({option:this.tmNode.rawNode,checked:this.checked,node:g}):g),v("div",{class:[`${t}-cascader-option`,this.keyboardPending||this.hoverPending&&`${t}-cascader-option--pending`,this.disabled&&`${t}-cascader-option--disabled`,this.showCheckbox&&`${t}-cascader-option--show-prefix`],onMouseenter:this.mergedHandleMouseEnter,onMousemove:this.mergedHandleMouseMove,onClick:this.handleClick},b,v("span",{class:`${t}-cascader-option__label`},l?l(this.tmNode.rawNode,this.checked):this.label),y)}}),pn=re({name:"CascaderSubmenu",props:{depth:{type:Number,required:!0},tmNodes:{type:Array,required:!0}},setup(){const{virtualScrollRef:t,mergedClsPrefixRef:r,mergedThemeRef:l,optionHeightRef:o}=Oe(ye),f=p(null),b=p(null),y={scroll(g,w){var O,C;t.value?(O=b.value)===null||O===void 0||O.scrollTo({index:g}):(C=f.value)===null||C===void 0||C.scrollTo({index:g,elSize:w})}};return Object.assign({mergedClsPrefix:r,mergedTheme:l,scrollbarInstRef:f,vlInstRef:b,virtualScroll:t,itemSize:k(()=>be(o.value)),handleVlScroll:()=>{var g;(g=f.value)===null||g===void 0||g.sync()},getVlContainer:()=>{var g;return(g=b.value)===null||g===void 0?void 0:g.listElRef},getVlContent:()=>{var g;return(g=b.value)===null||g===void 0?void 0:g.itemsElRef}},y)},render(){const{mergedClsPrefix:t,mergedTheme:r,virtualScroll:l}=this;return v("div",{class:[l&&`${t}-cascader-submenu--virtual`,`${t}-cascader-submenu`]},v(Kt,{ref:"scrollbarInstRef",theme:r.peers.Scrollbar,themeOverrides:r.peerOverrides.Scrollbar,container:l?this.getVlContainer:void 0,content:l?this.getVlContent:void 0},{default:()=>l?v(Bt,{items:this.tmNodes,itemSize:this.itemSize,onScroll:this.handleVlScroll,showScrollbar:!1,ref:"vlInstRef"},{default:({item:o})=>v(et,{key:o.key,tmNode:o})}):this.tmNodes.map(o=>v(et,{key:o.key,tmNode:o}))}))}}),bn=re({name:"NCascaderMenu",props:{value:[String,Number,Array],placement:{type:String,default:"bottom-start"},show:Boolean,menuModel:{type:Array,required:!0},loading:Boolean,onFocus:{type:Function,required:!0},onBlur:{type:Function,required:!0},onKeydown:{type:Function,required:!0},onMousedown:{type:Function,required:!0},onTabout:{type:Function,required:!0}},setup(t){const{localeRef:r,isMountedRef:l,mergedClsPrefixRef:o,syncCascaderMenuPosition:f,handleCascaderMenuClickOutside:b,mergedThemeRef:y,getColumnStyleRef:g}=Oe(ye),w=[],O=p(null),C=p(null);function K(){f()}It(C,K);function z(x){var S;const{value:{loadingRequiredMessage:F}}=r;(S=O.value)===null||S===void 0||S.showOnce(F(x))}function P(x){b(x)}function E(x){const{value:S}=C;S&&(S.contains(x.relatedTarget)||t.onFocus(x))}function B(x){const{value:S}=C;S&&(S.contains(x.relatedTarget)||t.onBlur(x))}return Object.assign({isMounted:l,mergedClsPrefix:o,selfElRef:C,submenuInstRefs:w,maskInstRef:O,mergedTheme:y,getColumnStyle:g,handleFocusin:E,handleFocusout:B,handleClickOutside:P},{scroll(x,S,F){const _=w[x];_&&_.scroll(S,F)},showErrorMessage:z})},render(){const{submenuInstRefs:t,mergedClsPrefix:r,mergedTheme:l}=this;return v(Fe,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>this.show?tt(v("div",{tabindex:"0",ref:"selfElRef",class:`${r}-cascader-menu`,onMousedown:this.onMousedown,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onKeydown:this.onKeydown},this.menuModel[0].length?v("div",{class:`${r}-cascader-submenu-wrapper`},this.menuModel.map((o,f)=>{var b;return v(pn,{style:(b=this.getColumnStyle)===null||b===void 0?void 0:b.call(this,{level:f}),ref:y=>{y&&(t[f]=y)},key:f,tmNodes:o,depth:f+1})}),v(gn,{clsPrefix:r,ref:"maskInstRef"})):v("div",{class:`${r}-cascader-menu__empty`},at(this.$slots.empty,()=>[v($t,{theme:l.peers.Empty,themeOverrides:l.peerOverrides.Empty})])),Vt(this.$slots.action,o=>o&&v("div",{class:`${r}-cascader-menu-action`,"data-action":!0},o)),v(zt,{onFocus:this.onTabout})),[[nt,this.handleClickOutside,void 0,{capture:!0}]]):null})}});function _e(t){return t?t.map(r=>r.rawNode):null}function yn(t,r,l,o){const f=[],b=[];function y(g){for(const w of g){if(w.disabled)continue;const{rawNode:O}=w;b.push(O),(w.isLeaf||!r)&&f.push({label:Ae(w,o,l),value:w.key,rawNode:w.rawNode,path:Array.from(b)}),!w.isLeaf&&w.children&&y(w.children),b.pop()}}return y(t),f}function Ae(t,r,l){const o=[];for(;t;)o.push(t.rawNode[l]),t=t.parent;return o.reverse().join(r)}const wn=re({name:"NCascaderSelectMenu",props:{value:{type:[String,Number,Array],default:null},show:Boolean,pattern:{type:String,default:""},multiple:Boolean,tmNodes:{type:Array,default:()=>[]},filter:Function,labelField:{type:String,required:!0},separator:{type:String,required:!0}},setup(t){const{isMountedRef:r,mergedValueRef:l,mergedClsPrefixRef:o,mergedThemeRef:f,mergedCheckStrategyRef:b,slots:y,syncSelectMenuPosition:g,closeMenu:w,handleSelectMenuClickOutside:O,doUncheck:C,doCheck:K,clearPattern:z}=Oe(ye),P=p(null),E=k(()=>yn(t.tmNodes,b.value==="child",t.labelField,t.separator)),B=k(()=>{const{filter:n}=t;if(n)return n;const{labelField:R}=t;return(T,$,ee)=>ee.some(q=>q[R]&&~q[R].toLowerCase().indexOf(T.toLowerCase()))}),W=k(()=>{const{pattern:n}=t,{value:R}=B;return(n?E.value.filter(T=>R(n,T.rawNode,T.path)):E.value).map(T=>({value:T.value,label:T.label}))}),x=k(()=>lt(W.value,Et("value","children")));function S(){g()}function F(n){_(n)}function _(n){if(t.multiple){const{value:R}=l;Array.isArray(R)?R.includes(n.key)?C(n.key):K(n.key):R===null&&K(n.key),z()}else K(n.key),w(!0)}function I(){var n;(n=P.value)===null||n===void 0||n.prev()}function H(){var n;(n=P.value)===null||n===void 0||n.next()}function J(){var n;if(P){const R=(n=P.value)===null||n===void 0?void 0:n.getPendingTmNode();return R&&_(R),!0}return!1}function c(n){O(n)}return Object.assign({isMounted:r,mergedTheme:f,mergedClsPrefix:o,menuInstRef:P,selectTreeMate:x,handleResize:S,handleToggle:F,handleClickOutside:c,cascaderSlots:y},{prev:I,next:H,enter:J})},render(){const{mergedClsPrefix:t,isMounted:r,mergedTheme:l,cascaderSlots:o}=this;return v(Fe,{name:"fade-in-scale-up-transition",appear:r},{default:()=>this.show?tt(v(At,{ref:"menuInstRef",onResize:this.handleResize,clsPrefix:t,class:`${t}-cascader-menu`,autoPending:!0,themeOverrides:l.peerOverrides.InternalSelectMenu,theme:l.peers.InternalSelectMenu,treeMate:this.selectTreeMate,multiple:this.multiple,value:this.value,onToggle:this.handleToggle},{empty:()=>at(o["not-found"],()=>[])}),[[nt,this.handleClickOutside,void 0,{capture:!0}]]):null})}}),kn=ge([D("cascader-menu",`
 outline: none;
 position: relative;
 margin: 4px 0;
 display: flex;
 flex-flow: column nowrap;
 border-radius: var(--n-menu-border-radius);
 overflow: hidden;
 box-shadow: var(--n-menu-box-shadow);
 color: var(--n-option-text-color);
 background-color: var(--n-menu-color);
 `,[Ze({transformOrigin:"inherit",duration:"0.2s"}),Ne("empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),D("scrollbar",`
 width: 100%;
 `),D("base-menu-mask",`
 background-color: var(--n-menu-mask-color);
 `),D("base-loading",`
 color: var(--n-loading-color);
 `),D("cascader-submenu-wrapper",`
 position: relative;
 display: flex;
 flex-wrap: nowrap;
 `),D("cascader-submenu",`
 height: var(--n-menu-height);
 min-width: var(--n-column-width);
 position: relative;
 `,[X("virtual",`
 width: var(--n-column-width);
 `),D("scrollbar-content",`
 position: relative;
 `),ge("&:first-child",`
 border-top-left-radius: var(--n-menu-border-radius);
 border-bottom-left-radius: var(--n-menu-border-radius);
 `),ge("&:last-child",`
 border-top-right-radius: var(--n-menu-border-radius);
 border-bottom-right-radius: var(--n-menu-border-radius);
 `),ge("&:not(:first-child)",`
 border-left: 1px solid var(--n-menu-divider-color);
 `)]),D("cascader-menu-action",`
 box-sizing: border-box;
 padding: 8px;
 border-top: 1px solid var(--n-menu-divider-color);
 `),D("cascader-option",`
 height: var(--n-option-height);
 line-height: var(--n-option-height);
 font-size: var(--n-option-font-size);
 padding: 0 0 0 18px;
 box-sizing: border-box;
 min-width: 182px;
 background-color: #0000;
 display: flex;
 align-items: center;
 white-space: nowrap;
 position: relative;
 cursor: pointer;
 transition:
 background-color .2s var(--n-bezier),
 color 0.2s var(--n-bezier);
 `,[X("show-prefix",`
 padding-left: 0;
 `),Ne("label",`
 flex: 1 0 0;
 overflow: hidden;
 text-overflow: ellipsis;
 `),Ne("prefix",`
 min-width: 32px;
 display: flex;
 align-items: center;
 justify-content: center;
 `),Ne("suffix",`
 min-width: 32px;
 display: flex;
 align-items: center;
 justify-content: center;
 `),D("cascader-option-icon-placeholder",`
 line-height: 0;
 position: relative;
 width: 16px;
 height: 16px;
 font-size: 16px;
 `,[D("cascader-option-icon",[X("checkmark",`
 color: var(--n-option-check-mark-color);
 `,[Ze({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})]),X("arrow",`
 color: var(--n-option-arrow-color);
 `)])]),X("selected",`
 color: var(--n-option-text-color-active);
 `),X("active",`
 color: var(--n-option-text-color-active);
 background-color: var(--n-option-color-hover);
 `),X("pending",`
 background-color: var(--n-option-color-hover);
 `),ge("&:hover",`
 background-color: var(--n-option-color-hover);
 `),X("disabled",`
 color: var(--n-option-text-color-disabled);
 background-color: #0000;
 cursor: not-allowed;
 `,[D("cascader-option-icon",[X("arrow",`
 color: var(--n-option-text-color-disabled);
 `)])])])]),D("cascader",`
 z-index: auto;
 position: relative;
 width: 100%;
 `)]),xn=Object.assign(Object.assign({},ot.props),{allowCheckingNotLoaded:Boolean,to:Pe.propTo,bordered:{type:Boolean,default:void 0},options:{type:Array,default:()=>[]},value:[String,Number,Array],defaultValue:{type:[String,Number,Array],default:null},placeholder:String,multiple:Boolean,size:String,filterable:Boolean,disabled:{type:Boolean,default:void 0},disabledField:{type:String,default:"disabled"},expandTrigger:{type:String,default:"click"},clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},remote:Boolean,onLoad:Function,separator:{type:String,default:" / "},filter:Function,placement:{type:String,default:"bottom-start"},cascade:{type:Boolean,default:!0},leafOnly:Boolean,showPath:{type:Boolean,default:!0},show:{type:Boolean,default:void 0},maxTagCount:[String,Number],ellipsisTagPopoverProps:Object,menuProps:Object,filterMenuProps:Object,virtualScroll:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},valueField:{type:String,default:"value"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},renderLabel:Function,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onBlur:Function,onFocus:Function,getColumnStyle:Function,renderPrefix:Function,renderSuffix:Function,onChange:[Function,Array]}),Rn=re({name:"Cascader",props:xn,slots:Object,setup(t,{slots:r}){const{mergedBorderedRef:l,mergedClsPrefixRef:o,namespaceRef:f,inlineThemeDisabled:b}=jt(t),y=ot("Cascader","-cascader",kn,Dt,t,o),{localeRef:g}=Ut("Cascader"),w=p(t.defaultValue),O=k(()=>t.value),C=Ge(O,w),K=k(()=>t.leafOnly?"child":t.checkStrategy),z=p(""),P=Ht(t),{mergedSizeRef:E,mergedDisabledRef:B,mergedStatusRef:W}=P,x=p(null),S=p(null),F=p(null),_=p(null),I=p(null),H=p(new Set),J=p(null),c=p(null),i=Pe(t),n=p(!1),R=e=>{H.value.add(e)},T=e=>{H.value.delete(e)},$=k(()=>{const{valueField:e,childrenField:a,disabledField:s}=t;return lt(t.options,{getDisabled(h){return h[s]},getKey(h){return h[e]},getChildren(h){return h[a]}})}),ee=k(()=>{const{cascade:e,multiple:a}=t;return a&&Array.isArray(C.value)?$.value.getCheckedKeys(C.value,{cascade:e,allowNotLoaded:t.allowCheckingNotLoaded}):{checkedKeys:[],indeterminateKeys:[]}}),q=k(()=>ee.value.checkedKeys),ie=k(()=>ee.value.indeterminateKeys),Le=k(()=>{const{treeNodePath:e,treeNode:a}=$.value.getPath(I.value);let s;return a===null?s=[$.value.treeNodes]:(s=e.map(h=>h.siblings),!a.isLeaf&&!H.value.has(a.key)&&a.children&&s.push(a.children)),s}),Ke=k(()=>{const{keyPath:e}=$.value.getPath(I.value);return e}),te=k(()=>y.value.self.optionHeight);qt(t.options)&&$e(t.options,(e,a)=>{e!==a&&(I.value=null,_.value=null)});const se=p(!1);function ue(e){const{onUpdateShow:a,"onUpdate:show":s}=t;a&&oe(a,e),s&&oe(s,e),se.value=e}function Z(e,a,s){const{onUpdateValue:h,"onUpdate:value":u,onChange:M}=t,{nTriggerFormInput:d,nTriggerFormChange:N}=P;h&&oe(h,e,a,s),u&&oe(u,e,a,s),M&&oe(M,e,a,s),w.value=e,d(),N()}function ne(e){_.value=e}function ae(e){I.value=e}function de(e){const{value:{getNode:a}}=$;return e.map(s=>{var h;return((h=a(s))===null||h===void 0?void 0:h.rawNode)||null})}function we(e){var a;const{cascade:s,multiple:h,filterable:u}=t,{value:{check:M,getNode:d,getPath:N}}=$;if(h)try{const{checkedKeys:m}=M(e,ee.value.checkedKeys,{cascade:s,checkStrategy:K.value,allowNotLoaded:t.allowCheckingNotLoaded});Z(m,de(m),m.map(fe=>{var he;return _e((he=N(fe))===null||he===void 0?void 0:he.treeNodePath)})),u&&Be(),_.value=e,I.value=e}catch(m){if(m instanceof en){if(x.value){const fe=d(e);fe!==null&&x.value.showErrorMessage(fe.rawNode[t.labelField])}}else throw m}else if(K.value==="child"){const m=d(e);if(m!=null&&m.isLeaf)Z(e,m.rawNode,_e(N(e).treeNodePath));else return!1}else{const m=d(e);Z(e,(m==null?void 0:m.rawNode)||null,_e((a=N(e))===null||a===void 0?void 0:a.treeNodePath))}return!0}function ve(e){const{cascade:a,multiple:s}=t;if(s){const{value:{uncheck:h,getNode:u,getPath:M}}=$,{checkedKeys:d}=h(e,ee.value.checkedKeys,{cascade:a,checkStrategy:K.value,allowNotLoaded:t.allowCheckingNotLoaded});Z(d,d.map(N=>{var m;return((m=u(N))===null||m===void 0?void 0:m.rawNode)||null}),d.map(N=>{var m;return _e((m=M(N))===null||m===void 0?void 0:m.treeNodePath)})),_.value=e,I.value=e}}const ke=k(()=>{if(t.multiple){const{showPath:e,separator:a,labelField:s,cascade:h}=t,{getCheckedKeys:u,getNode:M}=$.value;return u(q.value,{cascade:h,checkStrategy:K.value,allowNotLoaded:t.allowCheckingNotLoaded}).checkedKeys.map(N=>{const m=M(N);return m===null?{label:String(N),value:N}:{label:e?Ae(m,a,s):m.rawNode[s],value:m.key}})}else return[]}),L=k(()=>{const{multiple:e,showPath:a,separator:s,labelField:h}=t,{value:u}=C;if(!e&&!Array.isArray(u)){const{getNode:M}=$.value;if(u===null)return null;const d=M(u);return d===null?{label:String(u),value:u}:{label:a?Ae(d,s,h):d.rawNode[h],value:d.key}}else return null}),G=U(t,"show"),A=Ge(G,se),xe=k(()=>{const{placeholder:e}=t;return e!==void 0?e:g.value.placeholder}),V=k(()=>!!(t.filterable&&z.value));$e(A,e=>{if(!e||t.multiple)return;const{value:a}=C;!Array.isArray(a)&&a!==null?(_.value=a,I.value=a,tn(()=>{var s;if(!A.value)return;const{value:h}=I;if(C.value!==null){const u=$.value.getNode(h);u&&((s=x.value)===null||s===void 0||s.scroll(u.level,u.index,be(te.value)))}})):(_.value=null,I.value=null)},{immediate:!0});function Re(e){const{onBlur:a}=t,{nTriggerFormBlur:s}=P;a&&oe(a,e),s()}function Ce(e){const{onFocus:a}=t,{nTriggerFormFocus:s}=P;a&&oe(a,e),s()}function Be(){var e;(e=F.value)===null||e===void 0||e.focusInput()}function rt(){var e;(e=F.value)===null||e===void 0||e.focus()}function Se(){B.value||(z.value="",ue(!0),t.filterable&&Be())}function le(e=!1){e&&rt(),ue(!1),z.value=""}function Ee(e){var a;V.value||A.value&&(!((a=F.value)===null||a===void 0)&&a.$el.contains(nn(e))||le())}function it(e){V.value&&Ee(e)}function je(){t.clearFilterAfterSelect&&(z.value="")}function Me(e){var a,s,h;const{value:u}=_,{value:M}=$;switch(e){case"prev":if(u!==null){const d=M.getPrev(u,{loop:!0});d!==null&&(ne(d.key),(a=x.value)===null||a===void 0||a.scroll(d.level,d.index,be(te.value)))}break;case"next":if(u===null){const d=M.getFirstAvailableNode();d!==null&&(ne(d.key),(s=x.value)===null||s===void 0||s.scroll(d.level,d.index,be(te.value)))}else{const d=M.getNext(u,{loop:!0});d!==null&&(ne(d.key),(h=x.value)===null||h===void 0||h.scroll(d.level,d.index,be(te.value)))}break;case"child":if(u!==null){const d=M.getNode(u);if(d!==null)if(d.shallowLoaded){const N=M.getChild(u);N!==null&&(ae(u),ne(N.key))}else{const{value:N}=H;if(!N.has(u)){R(u),ae(u);const{onLoad:m}=t;m&&m(d.rawNode).then(()=>{T(u)}).catch(()=>{T(u)})}}}break;case"parent":if(u!==null){const d=M.getParent(u);if(d!==null){ne(d.key);const N=d.getParent();ae(N===null?null:N.key)}}break}}function De(e){var a,s;switch(e.key){case" ":case"ArrowDown":case"ArrowUp":if(t.filterable&&A.value)break;e.preventDefault();break}if(!ze(e,"action"))switch(e.key){case" ":if(t.filterable)return;case"Enter":if(!A.value)Se();else{const{value:h}=V,{value:u}=_;if(h)S.value&&S.value.enter()&&je();else if(u!==null)if(q.value.includes(u)||ie.value.includes(u))ve(u);else{const M=we(u);!t.multiple&&M&&le(!0)}}break;case"ArrowUp":e.preventDefault(),A.value&&(V.value?(a=S.value)===null||a===void 0||a.prev():Me("prev"));break;case"ArrowDown":e.preventDefault(),A.value?V.value?(s=S.value)===null||s===void 0||s.next():Me("next"):Se();break;case"ArrowLeft":e.preventDefault(),A.value&&!V.value&&Me("parent");break;case"ArrowRight":e.preventDefault(),A.value&&!V.value&&Me("child");break;case"Escape":A.value&&(an(e),le(!0))}}function st(e){De(e)}function ut(e){e.stopPropagation(),t.multiple?Z([],[],[]):Z(null,null,null)}function dt(e){var a;!((a=x.value)===null||a===void 0)&&a.$el.contains(e.relatedTarget)||(n.value=!0,Ce(e))}function ct(e){var a;!((a=x.value)===null||a===void 0)&&a.$el.contains(e.relatedTarget)||(n.value=!1,Re(e),le())}function ft(e){var a;!((a=F.value)===null||a===void 0)&&a.$el.contains(e.relatedTarget)||(n.value=!0,Ce(e))}function vt(e){var a;!((a=F.value)===null||a===void 0)&&a.$el.contains(e.relatedTarget)||(n.value=!1,Re(e))}function ht(e){ze(e,"action")||t.multiple&&t.filter&&(e.preventDefault(),Be())}function mt(){le(!0)}function gt(){t.filterable?Se():A.value?le(!0):Se()}function pt(e){z.value=e.target.value}function bt(e){const{multiple:a}=t,{value:s}=C;a&&Array.isArray(s)&&e.value!==void 0?ve(e.value):Z(null,null,null)}function Ue(){var e;(e=J.value)===null||e===void 0||e.syncPosition()}function He(){var e;(e=c.value)===null||e===void 0||e.syncPosition()}function yt(){A.value&&(V.value?Ue():He())}const Ie=k(()=>!!(t.multiple&&t.cascade||K.value!=="child"));Wt(ye,{slots:r,mergedClsPrefixRef:o,mergedThemeRef:y,mergedValueRef:C,checkedKeysRef:q,indeterminateKeysRef:ie,hoverKeyPathRef:Ke,mergedCheckStrategyRef:K,showCheckboxRef:Ie,cascadeRef:U(t,"cascade"),multipleRef:U(t,"multiple"),keyboardKeyRef:_,hoverKeyRef:I,remoteRef:U(t,"remote"),loadingKeySetRef:H,expandTriggerRef:U(t,"expandTrigger"),isMountedRef:Zt(),onLoadRef:U(t,"onLoad"),virtualScrollRef:U(t,"virtualScroll"),optionHeightRef:te,localeRef:g,labelFieldRef:U(t,"labelField"),renderLabelRef:U(t,"renderLabel"),getColumnStyleRef:U(t,"getColumnStyle"),renderPrefixRef:U(t,"renderPrefix"),renderSuffixRef:U(t,"renderSuffix"),syncCascaderMenuPosition:He,syncSelectMenuPosition:Ue,updateKeyboardKey:ne,updateHoverKey:ae,addLoadingKey:R,deleteLoadingKey:T,doCheck:we,doUncheck:ve,closeMenu:le,handleSelectMenuClickOutside:it,handleCascaderMenuClickOutside:Ee,clearPattern:je});const wt={focus:()=>{var e;(e=F.value)===null||e===void 0||e.focus()},blur:()=>{var e;(e=F.value)===null||e===void 0||e.blur()},getCheckedData:()=>{if(Ie.value){const e=q.value;return{keys:e,options:de(e)}}return{keys:[],options:[]}},getIndeterminateData:()=>{if(Ie.value){const e=ie.value;return{keys:e,options:de(e)}}return{keys:[],options:[]}}},qe=k(()=>{const{self:{optionArrowColor:e,optionTextColor:a,optionTextColorActive:s,optionTextColorDisabled:h,optionCheckMarkColor:u,menuColor:M,menuBoxShadow:d,menuDividerColor:N,menuBorderRadius:m,menuHeight:fe,optionColorHover:he,optionHeight:kt,optionFontSize:xt,loadingColor:Rt,columnWidth:Ct},common:{cubicBezierEaseInOut:St}}=y.value;return{"--n-bezier":St,"--n-menu-border-radius":m,"--n-menu-box-shadow":d,"--n-menu-height":fe,"--n-column-width":Ct,"--n-menu-color":M,"--n-menu-divider-color":N,"--n-option-height":kt,"--n-option-font-size":xt,"--n-option-text-color":a,"--n-option-text-color-disabled":h,"--n-option-text-color-active":s,"--n-option-color-hover":he,"--n-option-check-mark-color":u,"--n-option-arrow-color":e,"--n-menu-mask-color":Gt(M,{alpha:.75}),"--n-loading-color":Rt}}),ce=b?Xt("cascader",void 0,qe,t):void 0;return Object.assign(Object.assign({},wt),{handleTriggerResize:yt,mergedStatus:W,selectMenuFollowerRef:J,cascaderMenuFollowerRef:c,triggerInstRef:F,selectMenuInstRef:S,cascaderMenuInstRef:x,mergedBordered:l,mergedClsPrefix:o,namespace:f,mergedValue:C,mergedShow:A,showSelectMenu:V,pattern:z,treeMate:$,mergedSize:E,mergedDisabled:B,localizedPlaceholder:xe,selectedOption:L,selectedOptions:ke,adjustedTo:i,menuModel:Le,handleMenuTabout:mt,handleMenuFocus:ft,handleMenuBlur:vt,handleMenuKeydown:st,handleMenuMousedown:ht,handleTriggerFocus:dt,handleTriggerBlur:ct,handleTriggerClick:gt,handleClear:ut,handleDeleteOption:bt,handlePatternInput:pt,handleKeydown:De,focused:n,optionHeight:te,mergedTheme:y,cssVars:b?void 0:qe,themeClass:ce==null?void 0:ce.themeClass,onRender:ce==null?void 0:ce.onRender})},render(){const{mergedClsPrefix:t}=this;return v("div",{class:`${t}-cascader`},v(Yt,null,{default:()=>[v(Qt,null,{default:()=>v(Jt,{onResize:this.handleTriggerResize,ref:"triggerInstRef",status:this.mergedStatus,clsPrefix:t,maxTagCount:this.maxTagCount,ellipsisTagPopoverProps:this.ellipsisTagPopoverProps,bordered:this.mergedBordered,size:this.mergedSize,theme:this.mergedTheme.peers.InternalSelection,themeOverrides:this.mergedTheme.peerOverrides.InternalSelection,active:this.mergedShow,pattern:this.pattern,placeholder:this.localizedPlaceholder,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,multiple:this.multiple,filterable:this.filterable,clearable:this.clearable,disabled:this.mergedDisabled,focused:this.focused,onFocus:this.handleTriggerFocus,onBlur:this.handleTriggerBlur,onClick:this.handleTriggerClick,onClear:this.handleClear,onDeleteOption:this.handleDeleteOption,onPatternInput:this.handlePatternInput,onKeydown:this.handleKeydown},{arrow:()=>{var r,l;return(l=(r=this.$slots).arrow)===null||l===void 0?void 0:l.call(r)}})}),v(Xe,{key:"cascaderMenu",ref:"cascaderMenuFollowerRef",show:this.mergedShow&&!this.showSelectMenu,containerClass:this.namespace,placement:this.placement,width:this.options.length?void 0:"target",teleportDisabled:this.adjustedTo===Pe.tdkey,to:this.adjustedTo},{default:()=>{var r;(r=this.onRender)===null||r===void 0||r.call(this);const{menuProps:l}=this;return v(bn,Object.assign({},l,{ref:"cascaderMenuInstRef",class:[this.themeClass,l==null?void 0:l.class],value:this.mergedValue,show:this.mergedShow&&!this.showSelectMenu,menuModel:this.menuModel,style:[this.cssVars,l==null?void 0:l.style],onFocus:this.handleMenuFocus,onBlur:this.handleMenuBlur,onKeydown:this.handleMenuKeydown,onMousedown:this.handleMenuMousedown,onTabout:this.handleMenuTabout}),{action:()=>{var o,f;return(f=(o=this.$slots).action)===null||f===void 0?void 0:f.call(o)},empty:()=>{var o,f;return(f=(o=this.$slots).empty)===null||f===void 0?void 0:f.call(o)}})}}),v(Xe,{key:"selectMenu",ref:"selectMenuFollowerRef",show:this.mergedShow&&this.showSelectMenu,containerClass:this.namespace,width:"target",placement:this.placement,to:this.adjustedTo,teleportDisabled:this.adjustedTo===Pe.tdkey},{default:()=>{var r;(r=this.onRender)===null||r===void 0||r.call(this);const{filterMenuProps:l}=this;return v(wn,Object.assign({},l,{ref:"selectMenuInstRef",class:[this.themeClass,l==null?void 0:l.class],value:this.mergedValue,show:this.mergedShow&&this.showSelectMenu,pattern:this.pattern,multiple:this.multiple,tmNodes:this.treeMate.treeNodes,filter:this.filter,labelField:this.labelField,separator:this.separator,style:[this.cssVars,l==null?void 0:l.style]}))}})]}))}});function Cn(t){return ln({url:"/v1/facilities/list",method:"get",params:t})}const Sn={class:"navigation-container h-full flex flex-col"},Mn={class:"absolute top-6 left-6 z-10"},Nn={class:"absolute top-6 right-6 z-10"},Tn={class:"bg-white rounded-lg p-[0.875rem] w-[23.75rem]"},_n={class:"flex items-center mb-[1.125rem]"},Pn={class:"flex items-center"},Fn=["onClick"],On={key:1,class:"absolute bottom-[12rem] right-6 z-10 rounded border bg-white p-4 ai"},Ln={class:"ai-text"},Kn={class:"ai-document"},Bn={class:"flex-1 flex items-center gap-3"},In={class:"ai-other"},Vn={class:"flex gap-2 items-center"},zn=re({__name:"index",setup(t){const r={autoLocate:!1,initialZoom:17},l=p(""),o=p(!1),f=p([]),b=p([]),y=p([]),g=p(null),w=p(null),O=p(null),C=p(null),K=["景点讲解","定位导览","拍照建议"],z=p(""),P=p(!1),E=p(null),B=p(null),W=c=>{if(y.value=[],c)if(c.startsWith("category_")){B.value&&B.value.closeInfoWindow();const i=b.value.find(n=>n.value===c);i!=null&&i.children&&(y.value=i.children.map(n=>({lng:n.lng,lat:n.lat,name:n.label})))}else{const i=f.value.find(n=>n.value===c);if(i&&(E.value=i,y.value=[{lng:i.lng,lat:i.lat,name:i.label}],B.value)){const n=document.createElement("div");n.className="bg-white rounded w-[13rem]",n.innerHTML=`
            <div class="h-[7.25rem]">
              <img src="${E.value.icon}" class="h-full w-full rounded-tl-lg rounded-tr-lg" />
            </div>
            <div class="p-5">
              <div class="mb-4 text-[#1D2129] text-sm">${E.value.label}</div>
              <span class="text-xs px-2 bg-[#F2F3F5] text-[#4E5969]">${E.value.category}</span>
            </div>
          `,B.value.showInfoWindow([i.lng,i.lat],n)}}else E.value=null,B.value&&B.value.closeInfoWindow()},x=c=>{if(g.value=c,c){const i=f.value.find(n=>n.value===c);i&&(O.value=[i.lng,i.lat])}},S=c=>{if(w.value=c,c){const i=f.value.find(n=>n.value===c);i&&(C.value=[i.lng,i.lat])}},F=async()=>{const c=await Cn({page_size:100});if(c!=null&&c.data){const i={};c.data.forEach(n=>{i[n.category]||(i[n.category]=[]),i[n.category].push(n)}),b.value=Object.entries(i).map(([n,R])=>({label:n,value:`category_${n}`,children:R.map(T=>({label:T.facility_name,value:T.facility_id,lng:T.longitude,lat:T.latitude}))})),f.value=c.data.map(n=>({label:n.facility_name,value:n.facility_id,lng:n.longitude,lat:n.latitude,icon:n.icon,category:n.category}))}},_=c=>{l.value=c.address,z.value=c.address,o.value=!0},I=c=>{P.value=!0},H=c=>{P.value=!0,l.value=z.value+"的"+c},J=(c,i)=>{c&&c.value&&W(c.value)};return $e(()=>l.value,c=>{c||(P.value=!1)}),on(()=>{F()}),(c,i)=>(Te(),Ve("div",Sn,[j("div",Mn,[Y(Q(Rn),{options:b.value,placeholder:"选择标记点",clearable:"",class:"!w-64","onUpdate:value":W,"check-strategy":"parent","expand-trigger":"hover"},null,8,["options"])]),j("div",Nn,[j("div",Tn,[i[3]||(i[3]=j("div",{class:"text-[#1D2129] mb-4"},"路线规划",-1)),j("div",_n,[Y(Q(Je),{value:g.value,"onUpdate:value":[i[0]||(i[0]=n=>g.value=n),x],options:f.value,placeholder:"选择起点"},null,8,["value","options"])]),j("div",Pn,[Y(Q(Je),{value:w.value,"onUpdate:value":[i[1]||(i[1]=n=>w.value=n),S],options:f.value,placeholder:"选择终点"},null,8,["value","options"])])])]),o.value?(Te(),rn(Q(vn),{key:0,class:"absolute bottom-6 right-6 z-10 w-[32.75rem]",isCustomer:!1,isSos:!1,isAdd:!1,isMic:!1,modelValue:l.value,"onUpdate:modelValue":i[2]||(i[2]=n=>l.value=n),buttonGap:1,onSendMessage:I},{"extra-buttons":sn(()=>[(Te(),Ve(dn,null,cn(K,n=>j("div",{class:"text-sm px-4 py-1 border rounded-full cursor-pointer",key:n,onClick:R=>H(n)},Qe(n),9,Fn)),64))]),_:1},8,["modelValue"])):Ye("",!0),P.value?(Te(),Ve("div",On,[j("div",Ln,Qe(l.value),1),j("div",Kn,[j("div",Bn,[Y(Q(pe),{icon:"ri:file-text-line",class:"text-[#4E5969]"}),i[4]||(i[4]=un(" 知识引用6个文档 ",-1))]),Y(Q(pe),{icon:"ri:arrow-right-s-line",class:"w-4 h-4 text-[#4E5969]"})]),j("div",In,[j("div",Vn,[Y(Q(pe),{icon:"ri:volume-up-line",class:"text-[#86909C] cursor-pointer"}),Y(Q(pe),{icon:"ri:translate",class:"text-[#86909C] cursor-pointer"}),Y(Q(pe),{icon:"ri:refresh-line",class:"text-[#86909C] cursor-pointer"}),i[5]||(i[5]=j("div",{class:"text-xs text-[#165DFF] cursor-pointer"},"切换讲解音色",-1))]),i[6]||(i[6]=j("div",{class:"text-xs text-[#4E5969]"},"23s ｜ 1450Token",-1))])])):Ye("",!0),Y(Mt,{ref_key:"mapContainerRef",ref:B,"auto-locate":r.autoLocate,"initial-zoom":r.initialZoom,markers:y.value,"start-point":O.value,"end-point":C.value,onMarkerClick:J,onPoiClick:_,"transport-mode":"walking",class:"w-full h-full"},null,8,["auto-locate","initial-zoom","markers","start-point","end-point"])]))}});const Dn=fn(zn,[["__scopeId","data-v-5beb79b2"]]);export{Dn as default};
