import{d as b,r as c,o as r,b as d,F as R,q as N,g as e,v as p,x as $,t as y,e as s,a as n,M as f,w,O as M,D as k,K as I,aP as z,E as B,au as P,aM as T,z as K}from"./index-9ac666b4.js";import{M as V}from"./MapContainer-d7996777.js";const L={key:0,class:"flex"},H={class:"flex-1"},Z={class:"bg-white py-[1.625rem] px-4 rounded-[0.5rem] word-break break-all font-medium text-sm text-[#1D2129]"},q={key:0},U={key:1},W={class:"bg-white border border-[#F53F3F] rounded-[0.5rem] py-2 px-[0.875rem] mt-[1.125rem]"},G={class:"flex justify-between items-center mb-[1.125rem]"},J={class:"flex items-center gap-2"},Q={class:"rounded-[0.25rem] w-6 h-6 bg-[#F53F3F] flex items-center justify-center text-white"},X={class:"flex items-center gap-2"},Y={class:"mt-[1.125rem]"},ee={class:"flex-1"},te={class:"text-[0.75rem] text-[#86909C]"},se={class:"text-area text-area_warning mt-[1.125rem]"},ae={class:"flex-1"},oe={key:1,class:"flex items-start justify-end"},ne={class:"flex-1 flex justify-end"},le={class:"py-3 px-4 bg-[#E8F3FF] rounded-[0.5rem] word-break break-all font-medium text-sm text-[#303133]"},ie=b({__name:"SafetyChatArea",props:{messages:{},warning:{},routes:{},accidentReport:{}},emits:["sos-click"],setup(S,{expose:h,emit:v}){const l=v,i=()=>{l("sos-click")},_=c();return h({chatAreaRef:_}),(o,t)=>(r(),d("div",{class:"flex-1 overflow-y-auto pr-5",ref_key:"chatAreaRef",ref:_,style:{"margin-bottom":"90px"}},[(r(!0),d(R,null,N(o.messages,a=>(r(),d("div",{key:a.id,class:"mb-4"},[a.type==="warning"||a.type==="system"?(r(),d("div",L,[t[7]||(t[7]=e("div",{class:"w-10 h-10 rounded-full bg-blue-300 mr-2"},null,-1)),e("div",H,[e("div",Z,[a.type==="system"?(r(),d("div",q,p(a.content),1)):$("",!0),a.type==="warning"?(r(),d("div",U,[t[5]||(t[5]=y(" 根据您发的地理位置 ")),e("div",W,[e("div",G,[e("div",J,[e("div",Q,[s(n(f),{icon:"ri:error-warning-fill",class:"w-4 h-4"})]),y(" "+p(a.content.title),1)]),e("div",X,[t[0]||(t[0]=e("div",{class:"bg-[#FFECE8] bounded-[0.125rem] text-[#F53F3F] px-2 py-[1px]"}," 高风险 ",-1)),s(n(f),{icon:"ri:arrow-right-s-line",class:"w-5 h-5 text-[#4E5969]"})])]),e("div",null,p(a.content.message),1)]),e("div",Y,[t[1]||(t[1]=y(" 为您规划了以下疏散线路 ")),t[2]||(t[2]=e("div",{class:"my-[1.125rem]"}," 根据用户上传的文件及地图显示的地理位置，推荐以下疏散路线。 ",-1)),(r(!0),d(R,null,N(o.routes,m=>(r(),d("div",{key:m.id,class:"text-area text-area_warning mt-2"},[e("div",ee,[e("div",te,p(m.name),1),e("div",null,"起点："+p(m.start)+"→终点："+p(m.end),1)]),s(n(f),{icon:"ri:arrow-right-s-line",class:"w-4 h-4 text-[#4E5969]"})]))),128))]),t[6]||(t[6]=e("div",{class:"mt-[1.125rem]"}," 根据用户描述及地图显示的地理位置，请确认报警信息 ",-1)),e("div",se,[e("div",ae,[t[3]||(t[3]=e("div",{class:"text-[0.75rem] text-[#86909C]"},"一键报警",-1)),e("div",null,"地址："+p(o.accidentReport.address),1),e("div",null,"事故类型："+p(o.accidentReport.type),1)]),s(n(M),{color:"#F53F3F",onClick:i,class:"!leading-[1.375] !py-1 !px-4 !rounded-[0.5rem]"},{default:w(()=>t[4]||(t[4]=[y(" SOS  一键报警 ")])),_:1})])])):$("",!0)])])])):a.type==="user"?(r(),d("div",oe,[e("div",ne,[e("div",le,p(a.content),1)]),t[8]||(t[8]=e("div",{class:"w-10 h-10 rounded-full bg-gray-300 ml-2"},null,-1))])):$("",!0)]))),128))],512))}});const re=k(ie,[["__scopeId","data-v-ed3c59ae"]]),de={class:"safety-map-container"},ce=b({__name:"SafetyMap",emits:["poi-click"],setup(S,{emit:h}){const v=h,l={autoLocate:!0,initialZoom:13},i=c({start:[118.06702,24.444695],end:[118.058808,24.446161]}),_=o=>{console.log("点击的地点信息:",o),i.value.end=[o.longitude,o.latitude];const t=o.name||o.address||"未知地点";v("poi-click",t)};return(o,t)=>(r(),d("div",de,[s(V,{"auto-locate":l.autoLocate,"initial-zoom":l.initialZoom,onPoiClick:_,"start-point":i.value.start,"end-point":i.value.end,"transport-mode":"walking"},null,8,["auto-locate","initial-zoom","start-point","end-point"])]))}});const ue=k(ce,[["__scopeId","data-v-d44db3f5"]]),_e={class:"input-area"},me={class:"flex items-center justify-between"},pe={class:"flex items-center gap-4"},fe=b({__name:"SafetyInputArea",emits:["send-message","sos-alert"],setup(S,{emit:h}){const v=h,l=c(""),i=()=>{l.value.trim()&&(v("send-message",l.value),l.value="")},_=()=>{v("sos-alert")},o=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),i())};return(t,a)=>(r(),d("div",_e,[s(n(I),{value:l.value,"onUpdate:value":a[0]||(a[0]=m=>l.value=m),placeholder:"我要求助报警",class:"w-full",type:"textarea",autosize:{minRows:1,maxRows:3},onKeydown:o},null,8,["value"]),s(n(z),{class:"!my-4"}),e("div",me,[e("div",pe,[e("button",null,[s(n(f),{icon:"ri:add-circle-line",class:"text-[1.25rem]"})]),e("button",null,[s(n(f),{icon:"ri:mic-line",class:"text-[1.25rem]"})]),e("button",null,[s(n(f),{icon:"ri:customer-service-2-fill",class:"text-[1.25rem]"})]),e("button",{onClick:_,class:"sos"},"SOS")]),s(n(M),{circle:"",type:"info",onClick:i,color:"#235FC8",class:"!w-8 !h-8"},{default:w(()=>[s(n(f),{icon:"ri:arrow-up-long-line"})]),_:1})])]))}});const ve=k(fe,[["__scopeId","data-v-2fb8c1ff"]]),xe={class:"h-full flex relative overflow-hidden"},he={class:"flex-1 overflow-hidden flex py-8 pr-12"},ye={class:"collapse-area"},ge={class:"flex-1 overflow-hidden flex flex-col"},we={class:"flex-1 overflow-hidden h-full"},be={class:"absolute bottom-8 left-[calc(30px+1.5rem)] right-[calc(40%+3rem)]"},ke={class:"overflow-hidden w-2/5 rounded-[0.5rem] bg-white shadow-[0px_0.125rem_1rem_0.125rem_rgba(77,87,121,0.1)]"},Se={class:"py-3 px-6 flex items-center justify-between text-[1rem] text-[#1D2129]"},Ce={class:"h-full"},Fe=b({__name:"index",setup(S){const h=B(),v=P(),l=c(""),i=c({title:"预警信息",message:`该景区目前人流量已达${Math.floor(Math.random()*9e3)+1e3}人，踩踏事故发生的可能性高`}),_=c([{id:1,name:"疏散路线1",start:"鼓浪屿风景名胜区",end:"鼓浪屿内厝澳码头"}]),o=c({address:"鼓浪屿风景名胜区",type:"踩踏事故"}),t=c([{id:1,type:"user",content:"我在景区遇到了紧急情况，需要帮助！"},{id:2,type:"warning",content:i.value}]),a=()=>{h.success("SOS警报已发送，救援人员将尽快到达")},m=u=>{const x=t.value.length>0?Math.max(...t.value.map(F=>F.id)):0;t.value.push({id:x+1,type:"user",content:u}),setTimeout(()=>{_.value=[{id:1,name:"疏散路线1",start:"鼓浪屿风景名胜区",end:l.value}],i.value.message=`该景区目前人流量已达${Math.floor(Math.random()*9e3)+1e3}人，踩踏事故发生的可能性高`,t.value.push({id:x+2,type:"warning",content:i.value}),D()},500)},E=u=>{m(`我在${u}遇到紧急情况，需要帮助！`),l.value=u},O=u=>{m(u)},g=c(!1),j=()=>{g.value=!g.value,v.setSiderCollapsed(g.value)},C=c(),A=c(),D=()=>{K(()=>{var u,x;if(C.value){const F=((x=(u=A.value)==null?void 0:u.chatAreaRef)==null?void 0:x.offsetHeight)||100;C.value.scrollTo({left:0,top:F,behavior:"smooth"})}})};return(u,x)=>(r(),d("div",xe,[e("div",he,[e("div",ye,[s(n(M),{tertiary:"",size:"small",onClick:j,class:"collapse-area-button"},{icon:w(()=>[s(n(f),{icon:g.value?"ri:menu-unfold-line":"ri:menu-fold-line"},null,8,["icon"])]),_:1})]),e("div",ge,[e("div",we,[s(n(T),{ref_key:"scrollbarRef",ref:C,class:"h-full",trigger:"hover"},{default:w(()=>[s(re,{messages:t.value,warning:i.value,routes:_.value,"accident-report":o.value,onSosClick:a,ref_key:"chatAreaRef",ref:A},null,8,["messages","warning","routes","accident-report"])]),_:1},512)]),e("div",be,[s(ve,{onSendMessage:O,onSosAlert:a})])]),e("div",ke,[e("div",Se,[x[0]||(x[0]=y(" 地图规划 ")),s(n(f),{icon:"ri:expand-diagonal-line",class:"cursor-pointer"})]),e("div",Ce,[s(ue,{onPoiClick:E})])])])]))}});const Ae=k(Fe,[["__scopeId","data-v-11b2a06d"]]);export{Ae as default};
