import{d as k,r as d,o as i,b as r,F as R,q as N,g as e,v as f,x as $,t as g,e as s,a as n,M as p,w as b,O as M,D as S,K as I,aP as z,E as B,au as P,aM as T,z as K}from"./index-1b86b595.js";import{M as V}from"./MapContainer-44c1aed2.js";const L={key:0,class:"flex"},H={class:"flex-1"},Z={class:"bg-white py-[1.625rem] px-4 rounded-[0.5rem] word-break break-all font-medium text-sm text-[#1D2129]"},q={key:0},U={key:1},W={class:"bg-white border border-[#F53F3F] rounded-[0.5rem] py-2 px-[0.875rem] mt-[1.125rem]"},G={class:"flex justify-between items-center mb-[1.125rem]"},J={class:"flex items-center gap-2"},Q={class:"rounded-[0.25rem] w-6 h-6 bg-[#F53F3F] flex items-center justify-center text-white"},X={class:"flex items-center gap-2"},Y={class:"mt-[1.125rem]"},ee={class:"flex-1"},te={class:"text-[0.75rem] text-[#86909C]"},se={class:"text-area text-area_warning mt-[1.125rem]"},ae={class:"flex-1"},ne={key:1,class:"flex items-start justify-end"},oe={class:"flex-1 flex justify-end"},le={class:"py-3 px-4 bg-[#E8F3FF] rounded-[0.5rem] word-break break-all font-medium text-sm text-[#303133]"},ie=k({__name:"SafetyChatArea",props:{messages:{},warning:{},routes:{},accidentReport:{}},emits:["sos-click"],setup(h,{expose:y,emit:v}){const o=v,l=()=>{o("sos-click")},_=d();return y({chatAreaRef:_}),(c,t)=>(i(),r("div",{class:"flex-1 overflow-y-auto pr-5",ref_key:"chatAreaRef",ref:_,style:{"margin-bottom":"90px"}},[(i(!0),r(R,null,N(h.messages,a=>(i(),r("div",{key:a.id,class:"mb-4"},[a.type==="warning"||a.type==="system"?(i(),r("div",L,[t[7]||(t[7]=e("div",{class:"w-10 h-10 rounded-full bg-blue-300 mr-2"},null,-1)),e("div",H,[e("div",Z,[a.type==="system"?(i(),r("div",q,f(a.content),1)):$("",!0),a.type==="warning"?(i(),r("div",U,[t[5]||(t[5]=g(" 根据您发的地理位置 ",-1)),e("div",W,[e("div",G,[e("div",J,[e("div",Q,[s(n(p),{icon:"ri:error-warning-fill",class:"w-4 h-4"})]),g(" "+f(a.content.title),1)]),e("div",X,[t[0]||(t[0]=e("div",{class:"bg-[#FFECE8] bounded-[0.125rem] text-[#F53F3F] px-2 py-[1px]"}," 高风险 ",-1)),s(n(p),{icon:"ri:arrow-right-s-line",class:"w-5 h-5 text-[#4E5969]"})])]),e("div",null,f(a.content.message),1)]),e("div",Y,[t[1]||(t[1]=g(" 为您规划了以下疏散线路 ",-1)),t[2]||(t[2]=e("div",{class:"my-[1.125rem]"}," 根据用户上传的文件及地图显示的地理位置，推荐以下疏散路线。 ",-1)),(i(!0),r(R,null,N(h.routes,m=>(i(),r("div",{key:m.id,class:"text-area text-area_warning mt-2"},[e("div",ee,[e("div",te,f(m.name),1),e("div",null,"起点："+f(m.start)+"→终点："+f(m.end),1)]),s(n(p),{icon:"ri:arrow-right-s-line",class:"w-4 h-4 text-[#4E5969]"})]))),128))]),t[6]||(t[6]=e("div",{class:"mt-[1.125rem]"}," 根据用户描述及地图显示的地理位置，请确认报警信息 ",-1)),e("div",se,[e("div",ae,[t[3]||(t[3]=e("div",{class:"text-[0.75rem] text-[#86909C]"},"一键报警",-1)),e("div",null,"地址："+f(h.accidentReport.address),1),e("div",null,"事故类型："+f(h.accidentReport.type),1)]),s(n(M),{color:"#F53F3F",onClick:l,class:"!leading-[1.375] !py-1 !px-4 !rounded-[0.5rem]"},{default:b(()=>[...t[4]||(t[4]=[g(" SOS  一键报警 ",-1)])]),_:1})])])):$("",!0)])])])):a.type==="user"?(i(),r("div",ne,[e("div",oe,[e("div",le,f(a.content),1)]),t[8]||(t[8]=e("div",{class:"w-10 h-10 rounded-full bg-gray-300 ml-2"},null,-1))])):$("",!0)]))),128))],512))}});const re=S(ie,[["__scopeId","data-v-ed3c59ae"]]),ce={class:"safety-map-container"},de=k({__name:"SafetyMap",emits:["poi-click"],setup(h,{emit:y}){const v=y,o={autoLocate:!0,initialZoom:13},l=d({start:[118.06702,24.444695],end:[118.058808,24.446161]}),_=c=>{console.log("点击的地点信息:",c),l.value.end=[c.longitude,c.latitude];const t=c.name||c.address||"未知地点";v("poi-click",t)};return(c,t)=>(i(),r("div",ce,[s(V,{"auto-locate":o.autoLocate,"initial-zoom":o.initialZoom,onPoiClick:_,"start-point":l.value.start,"end-point":l.value.end,"transport-mode":"walking"},null,8,["auto-locate","initial-zoom","start-point","end-point"])]))}});const ue=S(de,[["__scopeId","data-v-d44db3f5"]]),_e={class:"input-area"},me={class:"flex items-center justify-between"},fe={class:"flex items-center gap-4"},pe=k({__name:"SafetyInputArea",emits:["send-message","sos-alert"],setup(h,{emit:y}){const v=y,o=d(""),l=()=>{o.value.trim()&&(v("send-message",o.value),o.value="")},_=()=>{v("sos-alert")},c=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),l())};return(t,a)=>(i(),r("div",_e,[s(n(I),{value:o.value,"onUpdate:value":a[0]||(a[0]=m=>o.value=m),placeholder:"我要求助报警",class:"w-full",type:"textarea",autosize:{minRows:1,maxRows:3},onKeydown:c},null,8,["value"]),s(n(z),{class:"!my-4"}),e("div",me,[e("div",fe,[e("button",null,[s(n(p),{icon:"ri:add-circle-line",class:"text-[1.25rem]"})]),e("button",null,[s(n(p),{icon:"ri:mic-line",class:"text-[1.25rem]"})]),e("button",null,[s(n(p),{icon:"ri:customer-service-2-fill",class:"text-[1.25rem]"})]),e("button",{onClick:_,class:"sos"},"SOS")]),s(n(M),{circle:"",type:"info",onClick:l,color:"#235FC8",class:"!w-8 !h-8"},{default:b(()=>[s(n(p),{icon:"ri:arrow-up-long-line"})]),_:1})])]))}});const ve=S(pe,[["__scopeId","data-v-2fb8c1ff"]]),xe={class:"h-full flex relative overflow-hidden"},he={class:"flex-1 overflow-hidden flex py-8 pr-12"},ye={class:"collapse-area"},ge={class:"flex-1 overflow-hidden flex flex-col"},we={class:"flex-1 overflow-hidden h-full"},be={class:"absolute bottom-8 left-[calc(30px+1.5rem)] right-[calc(40%+3rem)]"},ke={class:"overflow-hidden w-2/5 rounded-[0.5rem] bg-white shadow-[0px_0.125rem_1rem_0.125rem_rgba(77,87,121,0.1)]"},Se={class:"py-3 px-6 flex items-center justify-between text-[1rem] text-[#1D2129]"},Ce={class:"h-full"},Fe=k({__name:"index",setup(h){const y=B(),v=P(),o=d(""),l=d({title:"预警信息",message:`该景区目前人流量已达${Math.floor(Math.random()*9e3)+1e3}人，踩踏事故发生的可能性高`}),_=d([{id:1,name:"疏散路线1",start:"鼓浪屿风景名胜区",end:"鼓浪屿内厝澳码头"}]),c=d({address:"鼓浪屿风景名胜区",type:"踩踏事故"}),t=d([{id:1,type:"user",content:"我在景区遇到了紧急情况，需要帮助！"},{id:2,type:"warning",content:l.value}]),a=()=>{y.success("SOS警报已发送，救援人员将尽快到达")},m=u=>{const x=t.value.length>0?Math.max(...t.value.map(F=>F.id)):0;t.value.push({id:x+1,type:"user",content:u}),setTimeout(()=>{_.value=[{id:1,name:"疏散路线1",start:"鼓浪屿风景名胜区",end:o.value}],l.value.message=`该景区目前人流量已达${Math.floor(Math.random()*9e3)+1e3}人，踩踏事故发生的可能性高`,t.value.push({id:x+2,type:"warning",content:l.value}),D()},500)},E=u=>{m(`我在${u}遇到紧急情况，需要帮助！`),o.value=u},O=u=>{m(u)},w=d(!1),j=()=>{w.value=!w.value,v.setSiderCollapsed(w.value)},C=d(),A=d(),D=()=>{K(()=>{var u,x;if(C.value){const F=((x=(u=A.value)==null?void 0:u.chatAreaRef)==null?void 0:x.offsetHeight)||100;C.value.scrollTo({left:0,top:F,behavior:"smooth"})}})};return(u,x)=>(i(),r("div",xe,[e("div",he,[e("div",ye,[s(n(M),{tertiary:"",size:"small",onClick:j,class:"collapse-area-button"},{icon:b(()=>[s(n(p),{icon:w.value?"ri:menu-unfold-line":"ri:menu-fold-line"},null,8,["icon"])]),_:1})]),e("div",ge,[e("div",we,[s(n(T),{ref_key:"scrollbarRef",ref:C,class:"h-full",trigger:"hover"},{default:b(()=>[s(re,{messages:t.value,warning:l.value,routes:_.value,"accident-report":c.value,onSosClick:a,ref_key:"chatAreaRef",ref:A},null,8,["messages","warning","routes","accident-report"])]),_:1},512)]),e("div",be,[s(ve,{onSendMessage:O,onSosAlert:a})])]),e("div",ke,[e("div",Se,[x[0]||(x[0]=g(" 地图规划 ",-1)),s(n(p),{icon:"ri:expand-diagonal-line",class:"cursor-pointer"})]),e("div",Ce,[s(ue,{onPoiClick:E})])])])]))}});const Ae=S(Fe,[["__scopeId","data-v-11b2a06d"]]);export{Ae as default};
