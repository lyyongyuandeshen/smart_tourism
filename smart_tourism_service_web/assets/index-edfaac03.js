import{b$ as re,aa as o,aS as Oe,U as F,V as v,W as L,cl as le,X as E,aj as Ie,d as X,aT as Y,c4 as ie,cm as we,c7 as Se,cn as se,r as G,c as T,aU as je,br as ze,aV as M,ay as $e,O as Z,co as Ee,ar as Ne,cp as Ae,bG as Me,bM as He,ad as Ve,cq as qe,cr as Ge,a1 as Xe,a2 as xe,cs as Ke,a4 as We,a5 as x,a6 as Ze,a7 as Je,b8 as Qe,ct as Ye,F as Re,bL as de,z as et,ag as ue,E as ce,au as tt,bQ as nt,H as rt,o as ne,b as fe,g as U,v as W,e as j,w as H,t as he,a as P,K as it,q as ot,M as oe,aw as at,P as lt,J as st,aB as dt,R as ge,az as ut,av as pe,x as ct,aO as ft}from"./index-9ac666b4.js";import{N as ht}from"./Progress-d9ba84cb.js";const gt=re("attach",()=>o("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},o("g",{fill:"currentColor","fill-rule":"nonzero"},o("path",{d:"M3.25735931,8.70710678 L7.85355339,4.1109127 C8.82986412,3.13460197 10.4127766,3.13460197 11.3890873,4.1109127 C12.365398,5.08722343 12.365398,6.67013588 11.3890873,7.64644661 L6.08578644,12.9497475 C5.69526215,13.3402718 5.06209717,13.3402718 4.67157288,12.9497475 C4.28104858,12.5592232 4.28104858,11.9260582 4.67157288,11.5355339 L9.97487373,6.23223305 C10.1701359,6.0369709 10.1701359,5.72038841 9.97487373,5.52512627 C9.77961159,5.32986412 9.4630291,5.32986412 9.26776695,5.52512627 L3.96446609,10.8284271 C3.18341751,11.6094757 3.18341751,12.8758057 3.96446609,13.6568542 C4.74551468,14.4379028 6.01184464,14.4379028 6.79289322,13.6568542 L12.0961941,8.35355339 C13.4630291,6.98671837 13.4630291,4.77064094 12.0961941,3.40380592 C10.7293591,2.0369709 8.51328163,2.0369709 7.14644661,3.40380592 L2.55025253,8 C2.35499039,8.19526215 2.35499039,8.51184464 2.55025253,8.70710678 C2.74551468,8.90236893 3.06209717,8.90236893 3.25735931,8.70710678 Z"}))))),pt=re("cancel",()=>o("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},o("g",{fill:"currentColor","fill-rule":"nonzero"},o("path",{d:"M2.58859116,2.7156945 L2.64644661,2.64644661 C2.82001296,2.47288026 3.08943736,2.45359511 3.2843055,2.58859116 L3.35355339,2.64644661 L8,7.293 L12.6464466,2.64644661 C12.8417088,2.45118446 13.1582912,2.45118446 13.3535534,2.64644661 C13.5488155,2.84170876 13.5488155,3.15829124 13.3535534,3.35355339 L8.707,8 L13.3535534,12.6464466 C13.5271197,12.820013 13.5464049,13.0894374 13.4114088,13.2843055 L13.3535534,13.3535534 C13.179987,13.5271197 12.9105626,13.5464049 12.7156945,13.4114088 L12.6464466,13.3535534 L8,8.707 L3.35355339,13.3535534 C3.15829124,13.5488155 2.84170876,13.5488155 2.64644661,13.3535534 C2.45118446,13.1582912 2.45118446,12.8417088 2.64644661,12.6464466 L7.293,8 L2.64644661,3.35355339 C2.47288026,3.17998704 2.45359511,2.91056264 2.58859116,2.7156945 L2.64644661,2.64644661 L2.58859116,2.7156945 Z"}))))),mt=re("retry",()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},o("path",{d:"M320,146s24.36-12-64-12A160,160,0,1,0,416,294",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-miterlimit: 10; stroke-width: 32px;"}),o("polyline",{points:"256 58 336 138 256 218",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}))),vt=re("trash",()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},o("path",{d:"M432,144,403.33,419.74A32,32,0,0,1,371.55,448H140.46a32,32,0,0,1-31.78-28.26L80,144",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}),o("rect",{x:"32",y:"64",width:"448",height:"80",rx:"16",ry:"16",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}),o("line",{x1:"312",y1:"240",x2:"200",y2:"352",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}),o("line",{x1:"312",y1:"352",x2:"200",y2:"240",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}))),J=Oe("n-upload"),yt=F([v("upload","width: 100%;",[L("dragger-inside",[v("upload-trigger",`
 display: block;
 `)]),L("drag-over",[v("upload-dragger",`
 border: var(--n-dragger-border-hover);
 `)])]),v("upload-dragger",`
 cursor: pointer;
 box-sizing: border-box;
 width: 100%;
 text-align: center;
 border-radius: var(--n-border-radius);
 padding: 24px;
 opacity: 1;
 transition:
 opacity .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 background-color: var(--n-dragger-color);
 border: var(--n-dragger-border);
 `,[F("&:hover",`
 border: var(--n-dragger-border-hover);
 `),L("disabled",`
 cursor: not-allowed;
 `)]),v("upload-trigger",`
 display: inline-block;
 box-sizing: border-box;
 opacity: 1;
 transition: opacity .3s var(--n-bezier);
 `,[F("+",[v("upload-file-list","margin-top: 8px;")]),L("disabled",`
 opacity: var(--n-item-disabled-opacity);
 cursor: not-allowed;
 `),L("image-card",`
 width: 96px;
 height: 96px;
 `,[v("base-icon",`
 font-size: 24px;
 `),v("upload-dragger",`
 padding: 0;
 height: 100%;
 width: 100%;
 display: flex;
 align-items: center;
 justify-content: center;
 `)])]),v("upload-file-list",`
 line-height: var(--n-line-height);
 opacity: 1;
 transition: opacity .3s var(--n-bezier);
 `,[F("a, img","outline: none;"),L("disabled",`
 opacity: var(--n-item-disabled-opacity);
 cursor: not-allowed;
 `,[v("upload-file","cursor: not-allowed;")]),L("grid",`
 display: grid;
 grid-template-columns: repeat(auto-fill, 96px);
 grid-gap: 8px;
 margin-top: 0;
 `),v("upload-file",`
 display: block;
 box-sizing: border-box;
 cursor: default;
 padding: 0px 12px 0 6px;
 transition: background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 `,[le(),v("progress",[le({foldPadding:!0})]),F("&:hover",`
 background-color: var(--n-item-color-hover);
 `,[v("upload-file-info",[E("action",`
 opacity: 1;
 `)])]),L("image-type",`
 border-radius: var(--n-border-radius);
 text-decoration: underline;
 text-decoration-color: #0000;
 `,[v("upload-file-info",`
 padding-top: 0px;
 padding-bottom: 0px;
 width: 100%;
 height: 100%;
 display: flex;
 justify-content: space-between;
 align-items: center;
 padding: 6px 0;
 `,[v("progress",`
 padding: 2px 0;
 margin-bottom: 0;
 `),E("name",`
 padding: 0 8px;
 `),E("thumbnail",`
 width: 32px;
 height: 32px;
 font-size: 28px;
 display: flex;
 justify-content: center;
 align-items: center;
 `,[F("img",`
 width: 100%;
 `)])])]),L("text-type",[v("progress",`
 box-sizing: border-box;
 padding-bottom: 6px;
 margin-bottom: 6px;
 `)]),L("image-card-type",`
 position: relative;
 width: 96px;
 height: 96px;
 border: var(--n-item-border-image-card);
 border-radius: var(--n-border-radius);
 padding: 0;
 display: flex;
 align-items: center;
 justify-content: center;
 transition: border-color .3s var(--n-bezier), background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 overflow: hidden;
 `,[v("progress",`
 position: absolute;
 left: 8px;
 bottom: 8px;
 right: 8px;
 width: unset;
 `),v("upload-file-info",`
 padding: 0;
 width: 100%;
 height: 100%;
 `,[E("thumbnail",`
 width: 100%;
 height: 100%;
 display: flex;
 flex-direction: column;
 align-items: center;
 justify-content: center;
 font-size: 36px;
 `,[F("img",`
 width: 100%;
 `)])]),F("&::before",`
 position: absolute;
 z-index: 1;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
 opacity: 0;
 transition: opacity .2s var(--n-bezier);
 content: "";
 `),F("&:hover",[F("&::before","opacity: 1;"),v("upload-file-info",[E("thumbnail","opacity: .12;")])])]),L("error-status",[F("&:hover",`
 background-color: var(--n-item-color-hover-error);
 `),v("upload-file-info",[E("name","color: var(--n-item-text-color-error);"),E("thumbnail","color: var(--n-item-text-color-error);")]),L("image-card-type",`
 border: var(--n-item-border-image-card-error);
 `)]),L("with-url",`
 cursor: pointer;
 `,[v("upload-file-info",[E("name",`
 color: var(--n-item-text-color-success);
 text-decoration-color: var(--n-item-text-color-success);
 `,[F("a",`
 text-decoration: underline;
 `)])])]),v("upload-file-info",`
 position: relative;
 padding-top: 6px;
 padding-bottom: 6px;
 display: flex;
 flex-wrap: nowrap;
 `,[E("thumbnail",`
 font-size: 18px;
 opacity: 1;
 transition: opacity .2s var(--n-bezier);
 color: var(--n-item-icon-color);
 `,[v("base-icon",`
 margin-right: 2px;
 vertical-align: middle;
 transition: color .3s var(--n-bezier);
 `)]),E("action",`
 padding-top: inherit;
 padding-bottom: inherit;
 position: absolute;
 right: 0;
 top: 0;
 bottom: 0;
 width: 80px;
 display: flex;
 align-items: center;
 transition: opacity .2s var(--n-bezier);
 justify-content: flex-end;
 opacity: 0;
 `,[v("button",[F("&:not(:last-child)",{marginRight:"4px"}),v("base-icon",[F("svg",[Ie()])])]),L("image-type",`
 position: relative;
 max-width: 80px;
 width: auto;
 `),L("image-card-type",`
 z-index: 2;
 position: absolute;
 width: 100%;
 height: 100%;
 left: 0;
 right: 0;
 bottom: 0;
 top: 0;
 display: flex;
 justify-content: center;
 align-items: center;
 `)]),E("name",`
 color: var(--n-item-text-color);
 flex: 1;
 display: flex;
 justify-content: center;
 text-overflow: ellipsis;
 overflow: hidden;
 flex-direction: column;
 text-decoration-color: #0000;
 font-size: var(--n-font-size);
 transition:
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier); 
 `,[F("a",`
 color: inherit;
 text-decoration: underline;
 `)])])])]),v("upload-file-input",`
 display: none;
 width: 0;
 height: 0;
 opacity: 0;
 `)]),Ce="__UPLOAD_DRAGGER__",bt=X({name:"UploadDragger",[Ce]:!0,setup(e,{slots:t}){const n=Y(J,null);return n||ie("upload-dragger","`n-upload-dragger` must be placed inside `n-upload`."),()=>{const{mergedClsPrefixRef:{value:r},mergedDisabledRef:{value:d},maxReachedRef:{value:a}}=n;return o("div",{class:[`${r}-upload-dragger`,(d||a)&&`${r}-upload-dragger--disabled`]},t)}}}),wt=o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28"},o("g",{fill:"none"},o("path",{d:"M21.75 3A3.25 3.25 0 0 1 25 6.25v15.5A3.25 3.25 0 0 1 21.75 25H6.25A3.25 3.25 0 0 1 3 21.75V6.25A3.25 3.25 0 0 1 6.25 3h15.5zm.583 20.4l-7.807-7.68a.75.75 0 0 0-.968-.07l-.084.07l-7.808 7.68c.183.065.38.1.584.1h15.5c.204 0 .4-.035.583-.1l-7.807-7.68l7.807 7.68zM21.75 4.5H6.25A1.75 1.75 0 0 0 4.5 6.25v15.5c0 .208.036.408.103.593l7.82-7.692a2.25 2.25 0 0 1 3.026-.117l.129.117l7.82 7.692c.066-.185.102-.385.102-.593V6.25a1.75 1.75 0 0 0-1.75-1.75zm-3.25 3a2.5 2.5 0 1 1 0 5a2.5 2.5 0 0 1 0-5zm0 1.5a1 1 0 1 0 0 2a1 1 0 0 0 0-2z",fill:"currentColor"}))),xt=o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28"},o("g",{fill:"none"},o("path",{d:"M6.4 2A2.4 2.4 0 0 0 4 4.4v19.2A2.4 2.4 0 0 0 6.4 26h15.2a2.4 2.4 0 0 0 2.4-2.4V11.578c0-.729-.29-1.428-.805-1.944l-6.931-6.931A2.4 2.4 0 0 0 14.567 2H6.4zm-.9 2.4a.9.9 0 0 1 .9-.9H14V10a2 2 0 0 0 2 2h6.5v11.6a.9.9 0 0 1-.9.9H6.4a.9.9 0 0 1-.9-.9V4.4zm16.44 6.1H16a.5.5 0 0 1-.5-.5V4.06l6.44 6.44z",fill:"currentColor"}))),Rt=X({name:"UploadProgress",props:{show:Boolean,percentage:{type:Number,required:!0},status:{type:String,required:!0}},setup(){return{mergedTheme:Y(J).mergedThemeRef}},render(){return o(we,null,{default:()=>this.show?o(ht,{type:"line",showIndicator:!1,percentage:this.percentage,status:this.status,height:2,theme:this.mergedTheme.peers.Progress,themeOverrides:this.mergedTheme.peerOverrides.Progress}):null})}});var ae=globalThis&&globalThis.__awaiter||function(e,t,n,r){function d(a){return a instanceof n?a:new n(function(u){u(a)})}return new(n||(n=Promise))(function(a,u){function f(i){try{s(r.next(i))}catch(g){u(g)}}function l(i){try{s(r.throw(i))}catch(g){u(g)}}function s(i){i.done?a(i.value):d(i.value).then(f,l)}s((r=r.apply(e,t||[])).next())})};function Te(e){return e.includes("image/")}function me(e=""){const t=e.split("/"),r=t[t.length-1].split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(r)||[""])[0]}const ve=/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico)$/i,ke=e=>{if(e.type)return Te(e.type);const t=me(e.name||"");if(ve.test(t))return!0;const n=e.thumbnailUrl||e.url||"",r=me(n);return!!(/^data:image\//.test(n)||ve.test(r))};function Ct(e){return ae(this,void 0,void 0,function*(){return yield new Promise(t=>{if(!e.type||!Te(e.type)){t("");return}t(window.URL.createObjectURL(e))})})}const Tt=Se&&window.FileReader&&window.File;function kt(e){return e.isDirectory}function _t(e){return e.isFile}function Bt(e,t){return ae(this,void 0,void 0,function*(){const n=[];function r(d){return ae(this,void 0,void 0,function*(){for(const a of d)if(a){if(t&&kt(a)){const u=a.createReader();let f=[],l;try{do l=yield new Promise((s,i)=>{u.readEntries(s,i)}),f=f.concat(l);while(l.length>0)}catch(s){se("upload","error happens when handling directory upload",s)}yield r(f)}else if(_t(a))try{const u=yield new Promise((f,l)=>{a.file(f,l)});n.push({file:u,entry:a,source:"dnd"})}catch(u){se("upload","error happens when handling file upload",u)}}})}return yield r(e),n})}function Q(e){const{id:t,name:n,percentage:r,status:d,url:a,file:u,thumbnailUrl:f,type:l,fullPath:s,batchId:i}=e;return{id:t,name:n,percentage:r??null,status:d,url:a??null,file:u??null,thumbnailUrl:f??null,type:l??null,fullPath:s??null,batchId:i??null}}function Ut(e,t,n){return e=e.toLowerCase(),t=t.toLocaleLowerCase(),n=n.toLocaleLowerCase(),n.split(",").map(d=>d.trim()).filter(Boolean).some(d=>{if(d.startsWith(".")){if(e.endsWith(d))return!0}else if(d.includes("/")){const[a,u]=t.split("/"),[f,l]=d.split("/");if((f==="*"||a&&f&&f===a)&&(l==="*"||u&&l&&l===u))return!0}else return!0;return!1})}var ye=globalThis&&globalThis.__awaiter||function(e,t,n,r){function d(a){return a instanceof n?a:new n(function(u){u(a)})}return new(n||(n=Promise))(function(a,u){function f(i){try{s(r.next(i))}catch(g){u(g)}}function l(i){try{s(r.throw(i))}catch(g){u(g)}}function s(i){i.done?a(i.value):d(i.value).then(f,l)}s((r=r.apply(e,t||[])).next())})};const te={paddingMedium:"0 3px",heightMedium:"24px",iconSizeMedium:"18px"},Ft=X({name:"UploadFile",props:{clsPrefix:{type:String,required:!0},file:{type:Object,required:!0},listType:{type:String,required:!0},index:{type:Number,required:!0}},setup(e){const t=Y(J),n=G(null),r=G(""),d=T(()=>{const{file:h}=e;return h.status==="finished"?"success":h.status==="error"?"error":"info"}),a=T(()=>{const{file:h}=e;if(h.status==="error")return"error"}),u=T(()=>{const{file:h}=e;return h.status==="uploading"}),f=T(()=>{if(!t.showCancelButtonRef.value)return!1;const{file:h}=e;return["uploading","pending","error"].includes(h.status)}),l=T(()=>{if(!t.showRemoveButtonRef.value)return!1;const{file:h}=e;return["finished"].includes(h.status)}),s=T(()=>{if(!t.showDownloadButtonRef.value)return!1;const{file:h}=e;return["finished"].includes(h.status)}),i=T(()=>{if(!t.showRetryButtonRef.value)return!1;const{file:h}=e;return["error"].includes(h.status)}),g=je(()=>r.value||e.file.thumbnailUrl||e.file.url),k=T(()=>{if(!t.showPreviewButtonRef.value)return!1;const{file:{status:h},listType:m}=e;return["finished"].includes(h)&&g.value&&m==="image-card"});function V(){return ye(this,void 0,void 0,function*(){const h=t.onRetryRef.value;h&&(yield h({file:e.file}))===!1||t.submit(e.file.id)})}function O(h){h.preventDefault();const{file:m}=e;["finished","pending","error"].includes(m.status)?w(m):["uploading"].includes(m.status)?b(m):Me("upload","The button clicked type is unknown.")}function z(h){h.preventDefault(),y(e.file)}function w(h){const{xhrMap:m,doChange:p,onRemoveRef:{value:ee},mergedFileListRef:{value:c}}=t;Promise.resolve(ee?ee({file:Object.assign({},h),fileList:c,index:e.index}):!0).then(R=>{if(R===!1)return;const _=Object.assign({},h,{status:"removed"});m.delete(h.id),p(_,void 0,{remove:!0})})}function y(h){const{onDownloadRef:{value:m}}=t;Promise.resolve(m?m(Object.assign({},h)):!0).then(p=>{p!==!1&&He(h.url,h.name)})}function b(h){const{xhrMap:m}=t,p=m.get(h.id);p==null||p.abort(),w(Object.assign({},h))}function q(h){const{onPreviewRef:{value:m}}=t;if(m)m(e.file,{event:h});else if(e.listType==="image-card"){const{value:p}=n;if(!p)return;p.click()}}const B=()=>ye(this,void 0,void 0,function*(){const{listType:h}=e;h!=="image"&&h!=="image-card"||t.shouldUseThumbnailUrlRef.value(e.file)&&(r.value=yield t.getFileThumbnailUrlResolver(e.file))});return ze(()=>{B()}),{mergedTheme:t.mergedThemeRef,progressStatus:d,buttonType:a,showProgress:u,disabled:t.mergedDisabledRef,showCancelButton:f,showRemoveButton:l,showDownloadButton:s,showRetryButton:i,showPreviewButton:k,mergedThumbnailUrl:g,shouldUseThumbnailUrl:t.shouldUseThumbnailUrlRef,renderIcon:t.renderIconRef,imageRef:n,handleRemoveOrCancelClick:O,handleDownloadClick:z,handleRetryClick:V,handlePreviewClick:q}},render(){const{clsPrefix:e,mergedTheme:t,listType:n,file:r,renderIcon:d}=this;let a;const u=n==="image";u||n==="image-card"?a=!this.shouldUseThumbnailUrl(r)||!this.mergedThumbnailUrl?o("span",{class:`${e}-upload-file-info__thumbnail`},d?d(r):ke(r)?o(M,{clsPrefix:e},{default:wt}):o(M,{clsPrefix:e},{default:xt})):o("a",{rel:"noopener noreferer",target:"_blank",href:r.url||void 0,class:`${e}-upload-file-info__thumbnail`,onClick:this.handlePreviewClick},n==="image-card"?o($e,{src:this.mergedThumbnailUrl||void 0,previewSrc:r.url||void 0,alt:r.name,ref:"imageRef"}):o("img",{src:this.mergedThumbnailUrl||void 0,alt:r.name})):a=o("span",{class:`${e}-upload-file-info__thumbnail`},d?d(r):o(M,{clsPrefix:e},{default:()=>o(gt,null)}));const l=o(Rt,{show:this.showProgress,percentage:r.percentage||0,status:this.progressStatus}),s=n==="text"||n==="image";return o("div",{class:[`${e}-upload-file`,`${e}-upload-file--${this.progressStatus}-status`,r.url&&r.status!=="error"&&n!=="image-card"&&`${e}-upload-file--with-url`,`${e}-upload-file--${n}-type`]},o("div",{class:`${e}-upload-file-info`},a,o("div",{class:`${e}-upload-file-info__name`},s&&(r.url&&r.status!=="error"?o("a",{rel:"noopener noreferer",target:"_blank",href:r.url||void 0,onClick:this.handlePreviewClick},r.name):o("span",{onClick:this.handlePreviewClick},r.name)),u&&l),o("div",{class:[`${e}-upload-file-info__action`,`${e}-upload-file-info__action--${n}-type`]},this.showPreviewButton?o(Z,{key:"preview",quaternary:!0,type:this.buttonType,onClick:this.handlePreviewClick,theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,builtinThemeOverrides:te},{icon:()=>o(M,{clsPrefix:e},{default:()=>o(Ee,null)})}):null,(this.showRemoveButton||this.showCancelButton)&&!this.disabled&&o(Z,{key:"cancelOrTrash",theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,quaternary:!0,builtinThemeOverrides:te,type:this.buttonType,onClick:this.handleRemoveOrCancelClick},{icon:()=>o(Ne,null,{default:()=>this.showRemoveButton?o(M,{clsPrefix:e,key:"trash"},{default:()=>o(vt,null)}):o(M,{clsPrefix:e,key:"cancel"},{default:()=>o(pt,null)})})}),this.showRetryButton&&!this.disabled&&o(Z,{key:"retry",quaternary:!0,type:this.buttonType,onClick:this.handleRetryClick,theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,builtinThemeOverrides:te},{icon:()=>o(M,{clsPrefix:e},{default:()=>o(mt,null)})}),this.showDownloadButton?o(Z,{key:"download",quaternary:!0,type:this.buttonType,onClick:this.handleDownloadClick,theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,builtinThemeOverrides:te},{icon:()=>o(M,{clsPrefix:e},{default:()=>o(Ae,null)})}):null)),!u&&l)}}),_e=X({name:"UploadTrigger",props:{abstract:Boolean},slots:Object,setup(e,{slots:t}){const n=Y(J,null);n||ie("upload-trigger","`n-upload-trigger` must be placed inside `n-upload`.");const{mergedClsPrefixRef:r,mergedDisabledRef:d,maxReachedRef:a,listTypeRef:u,dragOverRef:f,openOpenFileDialog:l,draggerInsideRef:s,handleFileAddition:i,mergedDirectoryDndRef:g,triggerClassRef:k,triggerStyleRef:V}=n,O=T(()=>u.value==="image-card");function z(){d.value||a.value||l()}function w(B){B.preventDefault(),f.value=!0}function y(B){B.preventDefault(),f.value=!0}function b(B){B.preventDefault(),f.value=!1}function q(B){var h;if(B.preventDefault(),!s.value||d.value||a.value){f.value=!1;return}const m=(h=B.dataTransfer)===null||h===void 0?void 0:h.items;m!=null&&m.length?Bt(Array.from(m).map(p=>p.webkitGetAsEntry()),g.value).then(p=>{i(p)}).finally(()=>{f.value=!1}):f.value=!1}return()=>{var B;const{value:h}=r;return e.abstract?(B=t.default)===null||B===void 0?void 0:B.call(t,{handleClick:z,handleDrop:q,handleDragOver:w,handleDragEnter:y,handleDragLeave:b}):o("div",{class:[`${h}-upload-trigger`,(d.value||a.value)&&`${h}-upload-trigger--disabled`,O.value&&`${h}-upload-trigger--image-card`,k.value],style:V.value,onClick:z,onDrop:q,onDragover:w,onDragenter:y,onDragleave:b},O.value?o(bt,null,{default:()=>Ve(t.default,()=>[o(M,{clsPrefix:h},{default:()=>o(qe,null)})])}):t)}}}),Lt=X({name:"UploadFileList",setup(e,{slots:t}){const n=Y(J,null);n||ie("upload-file-list","`n-upload-file-list` must be placed inside `n-upload`.");const{abstractRef:r,mergedClsPrefixRef:d,listTypeRef:a,mergedFileListRef:u,fileListClassRef:f,fileListStyleRef:l,cssVarsRef:s,themeClassRef:i,maxReachedRef:g,showTriggerRef:k,imageGroupPropsRef:V}=n,O=T(()=>a.value==="image-card"),z=()=>u.value.map((y,b)=>o(Ft,{clsPrefix:d.value,key:y.id,file:y,index:b,listType:a.value})),w=()=>O.value?o(Ge,Object.assign({},V.value),{default:z}):o(we,{group:!0},{default:z});return()=>{const{value:y}=d,{value:b}=r;return o("div",{class:[`${y}-upload-file-list`,O.value&&`${y}-upload-file-list--grid`,b?i==null?void 0:i.value:void 0,f.value],style:[b&&s?s.value:"",l.value]},w(),k.value&&!g.value&&O.value&&o(_e,null,t))}}});var be=globalThis&&globalThis.__awaiter||function(e,t,n,r){function d(a){return a instanceof n?a:new n(function(u){u(a)})}return new(n||(n=Promise))(function(a,u){function f(i){try{s(r.next(i))}catch(g){u(g)}}function l(i){try{s(r.throw(i))}catch(g){u(g)}}function s(i){i.done?a(i.value):d(i.value).then(f,l)}s((r=r.apply(e,t||[])).next())})};function Pt(e,t,n){const{doChange:r,xhrMap:d}=e;let a=0;function u(l){var s;let i=Object.assign({},t,{status:"error",percentage:a});d.delete(t.id),i=Q(((s=e.onError)===null||s===void 0?void 0:s.call(e,{file:i,event:l}))||i),r(i,l)}function f(l){var s;if(e.isErrorState){if(e.isErrorState(n)){u(l);return}}else if(n.status<200||n.status>=300){u(l);return}let i=Object.assign({},t,{status:"finished",percentage:a});d.delete(t.id),i=Q(((s=e.onFinish)===null||s===void 0?void 0:s.call(e,{file:i,event:l}))||i),r(i,l)}return{handleXHRLoad:f,handleXHRError:u,handleXHRAbort(l){const s=Object.assign({},t,{status:"removed",file:null,percentage:a});d.delete(t.id),r(s,l)},handleXHRProgress(l){const s=Object.assign({},t,{status:"uploading"});if(l.lengthComputable){const i=Math.ceil(l.loaded/l.total*100);s.percentage=i,a=i}r(s,l)}}}function Dt(e){const{inst:t,file:n,data:r,headers:d,withCredentials:a,action:u,customRequest:f}=e,{doChange:l}=e.inst;let s=0;f({file:n,data:r,headers:d,withCredentials:a,action:u,onProgress(i){const g=Object.assign({},n,{status:"uploading"}),k=i.percent;g.percentage=k,s=k,l(g)},onFinish(){var i;let g=Object.assign({},n,{status:"finished",percentage:s});g=Q(((i=t.onFinish)===null||i===void 0?void 0:i.call(t,{file:g}))||g),l(g)},onError(){var i;let g=Object.assign({},n,{status:"error",percentage:s});g=Q(((i=t.onError)===null||i===void 0?void 0:i.call(t,{file:g}))||g),l(g)}})}function Ot(e,t,n){const r=Pt(e,t,n);n.onabort=r.handleXHRAbort,n.onerror=r.handleXHRError,n.onload=r.handleXHRLoad,n.upload&&(n.upload.onprogress=r.handleXHRProgress)}function Be(e,t){return typeof e=="function"?e({file:t}):e||{}}function It(e,t,n){const r=Be(t,n);r&&Object.keys(r).forEach(d=>{e.setRequestHeader(d,r[d])})}function St(e,t,n){const r=Be(t,n);r&&Object.keys(r).forEach(d=>{e.append(d,r[d])})}function jt(e,t,n,{method:r,action:d,withCredentials:a,responseType:u,headers:f,data:l}){const s=new XMLHttpRequest;s.responseType=u,e.xhrMap.set(n.id,s),s.withCredentials=a;const i=new FormData;if(St(i,l,n),n.file!==null&&i.append(t,n.file),Ot(e,n,s),d!==void 0){s.open(r.toUpperCase(),d),It(s,f,n),s.send(i);const g=Object.assign({},n,{status:"uploading"});e.doChange(g)}}const zt=Object.assign(Object.assign({},xe.props),{name:{type:String,default:"file"},accept:String,action:String,customRequest:Function,directory:Boolean,directoryDnd:{type:Boolean,default:void 0},method:{type:String,default:"POST"},multiple:Boolean,showFileList:{type:Boolean,default:!0},data:[Object,Function],headers:[Object,Function],withCredentials:Boolean,responseType:{type:String,default:""},disabled:{type:Boolean,default:void 0},onChange:Function,onRemove:Function,onFinish:Function,onError:Function,onRetry:Function,onBeforeUpload:Function,isErrorState:Function,onDownload:Function,defaultUpload:{type:Boolean,default:!0},fileList:Array,"onUpdate:fileList":[Function,Array],onUpdateFileList:[Function,Array],fileListClass:String,fileListStyle:[String,Object],defaultFileList:{type:Array,default:()=>[]},showCancelButton:{type:Boolean,default:!0},showRemoveButton:{type:Boolean,default:!0},showDownloadButton:Boolean,showRetryButton:{type:Boolean,default:!0},showPreviewButton:{type:Boolean,default:!0},listType:{type:String,default:"text"},onPreview:Function,shouldUseThumbnailUrl:{type:Function,default:e=>Tt?ke(e):!1},createThumbnailUrl:Function,abstract:Boolean,max:Number,showTrigger:{type:Boolean,default:!0},imageGroupProps:Object,inputProps:Object,triggerClass:String,triggerStyle:[String,Object],renderIcon:Function}),$t=X({name:"Upload",props:zt,setup(e){e.abstract&&e.listType==="image-card"&&ie("upload","when the list-type is image-card, abstract is not supported.");const{mergedClsPrefixRef:t,inlineThemeDisabled:n}=Xe(e),r=xe("Upload","-upload",yt,Ke,e,t),d=We(e),a=G(e.defaultFileList),u=x(e,"fileList"),f=G(null),l={value:!1},s=G(!1),i=new Map,g=Ze(u,a),k=T(()=>g.value.map(Q)),V=T(()=>{const{max:c}=e;return c!==void 0?k.value.length>=c:!1});function O(){var c;(c=f.value)===null||c===void 0||c.click()}function z(c){const R=c.target;q(R.files?Array.from(R.files).map(_=>({file:_,entry:null,source:"input"})):null,c),R.value=""}function w(c){const{"onUpdate:fileList":R,onUpdateFileList:_}=e;R&&ue(R,c),_&&ue(_,c),a.value=c}const y=T(()=>e.multiple||e.directory),b=(c,R,_={append:!1,remove:!1})=>{const{append:N,remove:S}=_,I=Array.from(k.value),D=I.findIndex(C=>C.id===c.id);if(N||S||~D){N?I.push(c):S?I.splice(D,1):I.splice(D,1,c);const{onChange:C}=e;C&&C({file:c,fileList:I,event:R}),w(I)}};function q(c,R){if(!c||c.length===0)return;const{onBeforeUpload:_}=e;c=y.value?c:[c[0]];const{max:N,accept:S}=e;c=c.filter(({file:D,source:C})=>C==="dnd"&&(S!=null&&S.trim())?Ut(D.name,D.type,S):!0),N&&(c=c.slice(0,N-k.value.length));const I=de();Promise.all(c.map(D=>be(this,[D],void 0,function*({file:C,entry:A}){var $;const K={id:de(),batchId:I,name:C.name,status:"pending",percentage:0,file:C,url:null,type:C.type,thumbnailUrl:null,fullPath:($=A==null?void 0:A.fullPath)!==null&&$!==void 0?$:`/${C.webkitRelativePath||C.name}`};return!_||(yield _({file:K,fileList:k.value}))!==!1?K:null}))).then(D=>be(this,void 0,void 0,function*(){let C=Promise.resolve();D.forEach(A=>{C=C.then(et).then(()=>{A&&b(A,R,{append:!0})})}),yield C})).then(()=>{e.defaultUpload&&B()})}function B(c){const{method:R,action:_,withCredentials:N,headers:S,data:I,name:D}=e,C=c!==void 0?k.value.filter($=>$.id===c):k.value,A=c!==void 0;C.forEach($=>{const{status:K}=$;(K==="pending"||K==="error"&&A)&&(e.customRequest?Dt({inst:{doChange:b,xhrMap:i,onFinish:e.onFinish,onError:e.onError},file:$,action:_,withCredentials:N,headers:S,data:I,customRequest:e.customRequest}):jt({doChange:b,xhrMap:i,onFinish:e.onFinish,onError:e.onError,isErrorState:e.isErrorState},D,$,{method:R,action:_,withCredentials:N,responseType:e.responseType,headers:S,data:I}))})}function h(c){var R;if(c.thumbnailUrl)return c.thumbnailUrl;const{createThumbnailUrl:_}=e;return _?(R=_(c.file,c))!==null&&R!==void 0?R:c.url||"":c.url?c.url:c.file?Ct(c.file):""}const m=T(()=>{const{common:{cubicBezierEaseInOut:c},self:{draggerColor:R,draggerBorder:_,draggerBorderHover:N,itemColorHover:S,itemColorHoverError:I,itemTextColorError:D,itemTextColorSuccess:C,itemTextColor:A,itemIconColor:$,itemDisabledOpacity:K,lineHeight:Ue,borderRadius:Fe,fontSize:Le,itemBorderImageCardError:Pe,itemBorderImageCard:De}}=r.value;return{"--n-bezier":c,"--n-border-radius":Fe,"--n-dragger-border":_,"--n-dragger-border-hover":N,"--n-dragger-color":R,"--n-font-size":Le,"--n-item-color-hover":S,"--n-item-color-hover-error":I,"--n-item-disabled-opacity":K,"--n-item-icon-color":$,"--n-item-text-color":A,"--n-item-text-color-error":D,"--n-item-text-color-success":C,"--n-line-height":Ue,"--n-item-border-image-card-error":Pe,"--n-item-border-image-card":De}}),p=n?Je("upload",void 0,m,e):void 0;Qe(J,{mergedClsPrefixRef:t,mergedThemeRef:r,showCancelButtonRef:x(e,"showCancelButton"),showDownloadButtonRef:x(e,"showDownloadButton"),showRemoveButtonRef:x(e,"showRemoveButton"),showRetryButtonRef:x(e,"showRetryButton"),onRemoveRef:x(e,"onRemove"),onDownloadRef:x(e,"onDownload"),mergedFileListRef:k,triggerClassRef:x(e,"triggerClass"),triggerStyleRef:x(e,"triggerStyle"),shouldUseThumbnailUrlRef:x(e,"shouldUseThumbnailUrl"),renderIconRef:x(e,"renderIcon"),xhrMap:i,submit:B,doChange:b,showPreviewButtonRef:x(e,"showPreviewButton"),onPreviewRef:x(e,"onPreview"),getFileThumbnailUrlResolver:h,listTypeRef:x(e,"listType"),dragOverRef:s,openOpenFileDialog:O,draggerInsideRef:l,handleFileAddition:q,mergedDisabledRef:d.mergedDisabledRef,maxReachedRef:V,fileListClassRef:x(e,"fileListClass"),fileListStyleRef:x(e,"fileListStyle"),abstractRef:x(e,"abstract"),acceptRef:x(e,"accept"),cssVarsRef:n?void 0:m,themeClassRef:p==null?void 0:p.themeClass,onRender:p==null?void 0:p.onRender,showTriggerRef:x(e,"showTrigger"),imageGroupPropsRef:x(e,"imageGroupProps"),mergedDirectoryDndRef:T(()=>{var c;return(c=e.directoryDnd)!==null&&c!==void 0?c:e.directory}),onRetryRef:x(e,"onRetry")});const ee={clear:()=>{a.value=[]},submit:B,openOpenFileDialog:O};return Object.assign({mergedClsPrefix:t,draggerInsideRef:l,inputElRef:f,mergedTheme:r,dragOver:s,mergedMultiple:y,cssVars:n?void 0:m,themeClass:p==null?void 0:p.themeClass,onRender:p==null?void 0:p.onRender,handleFileInputChange:z},ee)},render(){var e,t;const{draggerInsideRef:n,mergedClsPrefix:r,$slots:d,directory:a,onRender:u}=this;if(d.default&&!this.abstract){const l=d.default()[0];!((e=l==null?void 0:l.type)===null||e===void 0)&&e[Ce]&&(n.value=!0)}const f=o("input",Object.assign({},this.inputProps,{ref:"inputElRef",type:"file",class:`${r}-upload-file-input`,accept:this.accept,multiple:this.mergedMultiple,onChange:this.handleFileInputChange,webkitdirectory:a||void 0,directory:a||void 0}));return this.abstract?o(Re,null,(t=d.default)===null||t===void 0?void 0:t.call(d),o(Ye,{to:"body"},f)):(u==null||u(),o("div",{class:[`${r}-upload`,n.value&&`${r}-upload--dragger-inside`,this.dragOver&&`${r}-upload--drag-over`,this.themeClass],style:this.cssVars},f,this.showTrigger&&this.listType!=="image-card"&&o(_e,null,d),this.showFileList&&o(Lt,null,d)))}}),Et={class:"p-4 space-y-5 min-h-[200px]"},Nt={class:"space-y-6"},At={class:"flex items-center space-x-4"},Mt={class:"flex-shrink-0 w-[100px]"},Ht={class:"flex items-center space-x-4"},Vt={class:"flex-shrink-0 w-[100px]"},qt={class:"w-[200px]"},Gt={class:"flex items-center space-x-4"},Xt={class:"flex-shrink-0 w-[100px]"},Kt={class:"flex flex-wrap items-center gap-4"},Wt={class:"flex items-center space-x-4"},Zt={class:"flex-shrink-0 w-[100px]"},Jt={class:"flex flex-wrap items-center gap-4"},Qt=X({__name:"General",setup(e){const t=ce(),n=tt(),r=nt(),d=ce(),a=T(()=>n.theme),u=T(()=>r.userInfo),f=G(u.value.name??""),l=T({get(){return n.language},set(w){n.setLanguage(w)}}),s=[{label:"Auto",key:"auto",icon:"ri:contrast-line"},{label:"Light",key:"light",icon:"ri:sun-foggy-line"},{label:"Dark",key:"dark",icon:"ri:moon-foggy-line"}],i=[{label:"简体中文",key:"zh-CN",value:"zh-CN"},{label:"English",key:"en-US",value:"en-US"}];function g(w){r.updateUserInfo(w),d.success(lt("common.success"))}let k=G([{id:"avatar",name:"头像预览",status:"finished",url:"https://ruoyi-ai-1254149996.cos.ap-guangzhou.myqcloud.com/2025/05/24/727370b029b648ea968977085da2b20f.jpg"}]);const O={Authorization:`Bearer ${rt()}`};function z({event:w}){const y=(w==null?void 0:w.target).response;k.value[0].url=y,t.success("上传成功！")}return(w,y)=>(ne(),fe("div",Et,[U("div",Nt,[U("div",At,[U("span",Mt,W(w.$t("setting.avatarLink")),1),j(P($t),{action:"/api/system/user/edit/avatar",max:1,"list-type":"image-card","default-file-list":P(k),headers:O,onFinish:z},{default:H(()=>y[3]||(y[3]=[he(" 点击上传 ")])),_:1},8,["default-file-list"])]),U("div",Ht,[U("span",Vt,W(w.$t("setting.name")),1),U("div",qt,[j(P(it),{value:f.value,"onUpdate:value":y[0]||(y[0]=b=>f.value=b),placeholder:""},null,8,["value"])]),j(P(Z),{size:"tiny",text:"",type:"primary",onClick:y[1]||(y[1]=b=>g({name:f.value}))},{default:H(()=>[he(W(w.$t("common.save")),1)]),_:1})]),U("div",Gt,[U("span",Xt,W(w.$t("setting.theme")),1),U("div",Kt,[(ne(),fe(Re,null,ot(s,b=>j(P(Z),{key:b.key,size:"small",type:b.key===a.value?"primary":void 0,onClick:q=>P(n).setTheme(b.key)},{icon:H(()=>[j(P(oe),{icon:b.icon},null,8,["icon"])]),_:2},1032,["type","onClick"])),64))])]),U("div",Wt,[U("span",Zt,W(w.$t("setting.language")),1),U("div",Jt,[j(P(at),{style:{width:"140px"},value:l.value,options:i,onUpdateValue:y[2]||(y[2]=b=>P(n).setLanguage(b))},null,8,["value"])])])])]))}}),Yt={class:"ml-2"},en={class:"min-h-[100px]"},tn={class:"ml-2"},nn={class:"min-h-[100px]"},an=X({__name:"index",props:{visible:{type:Boolean}},emits:["update:visible"],setup(e,{emit:t}){const n=e,r=t,d=st(),a=T(()=>!!d.isChatGPTAPI),u=G("General"),f=T({get(){return n.visible},set(l){r("update:visible",l)}});return(l,s)=>{const i=dt("aiModel");return ne(),ge(P(ft),{show:f.value,"onUpdate:show":s[1]||(s[1]=g=>f.value=g),"auto-focus":!1,preset:"card",style:{width:"100%","max-width":"1100px"}},{default:H(()=>[U("div",null,[j(P(ut),{value:u.value,"onUpdate:value":s[0]||(s[0]=g=>u.value=g),type:"line",animated:""},{default:H(()=>[j(P(pe),{name:"General",tab:"General"},{tab:H(()=>[j(P(oe),{class:"text-lg",icon:"ri:file-user-line"}),U("span",Yt,W(l.$t("setting.personal")),1)]),default:H(()=>[U("div",en,[j(Qt)])]),_:1}),a.value?(ne(),ge(P(pe),{key:0,name:"Advanced",tab:"Advanced"},{tab:H(()=>[j(P(oe),{class:"text-lg",icon:"ri:equalizer-line"}),U("span",tn,W(l.$t("setting.model")),1)]),default:H(()=>[U("div",nn,[j(i)])]),_:1})):ct("",!0)]),_:1},8,["value"])])]),_:1},8,["show"])}}});export{an as default};
